<!DOCTYPE html>
<html>
<head>
    

    

    



    <meta charset="utf-8">
    
    
    
    <title>Coursera ML(7)-Programming Exercise 3 | 李飞阳 | PM、Coder、Data mining</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#0288D1">
    
    
    <meta name="keywords" content="Machine Learning,读书笔记,Python">
    <meta name="description" content="machine-learning-ex3.zip 下载链接，第四周的课程相对来说比较简单，大致介绍了神经网络相关内容。">
<meta property="og:type" content="article">
<meta property="og:title" content="Coursera ML(7)-Programming Exercise 3">
<meta property="og:url" content="http://feiyang.li/2017/05/02/Coursera-ML-7-Programming-Exercise-3/index.html">
<meta property="og:site_name" content="李飞阳">
<meta property="og:description" content="machine-learning-ex3.zip 下载链接，第四周的课程相对来说比较简单，大致介绍了神经网络相关内容。">
<meta property="og:image" content="http://cdn.mmmxcc.cn/blog/20170502/171813517.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
">
<meta property="og:image" content="http://cdn.mmmxcc.cn/blog/20170416/135847233.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
">
<meta property="og:updated_time" content="2017-05-02T10:04:58.026Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Coursera ML(7)-Programming Exercise 3">
<meta name="twitter:description" content="machine-learning-ex3.zip 下载链接，第四周的课程相对来说比较简单，大致介绍了神经网络相关内容。">
<meta name="twitter:image" content="http://cdn.mmmxcc.cn/blog/20170502/171813517.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
">
    
        <link rel="alternate" type="application/atom+xml" title="李飞阳" href="/atom.xml">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="/css/style.css?v=1.6.7">
    <script>window.lazyScripts=[]</script>
</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/logo.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">Wing Lee</h5>
          <a href="mailto:mmmwhy@qq.com" title="mmmwhy@qq.com" class="mail">mmmwhy@qq.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories/Coursera-ML"  >
                <i class="icon icon-lg icon-paperclip"></i>
                分类
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/mmmwhy" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/2016/01/18/resume/"  >
                <i class="icon icon-lg icon-cog"></i>
                关于
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/link.html"  >
                <i class="icon icon-lg icon-link"></i>
                链接
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://ss.feiyang.li/auth/login" target="_blank" >
                <i class="icon icon-lg icon-rocket"></i>
                肥羊免费SS
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">Coursera ML(7)-Programming Exercise 3</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="输入感兴趣的关键字">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">Coursera ML(7)-Programming Exercise 3</h1>
        <h5 class="subtitle">
            
                <time datetime="2017-05-02T10:01:38.000Z" itemprop="datePublished" class="page-time">
  2017-05-02
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Coursera-ML/">Coursera ML</a></li></ul>

            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Programming-Exercise-3-Multi-class-Classification-and-Neural-Networks"><span class="post-toc-number">1.</span> <span class="post-toc-text">Programming Exercise 3 - Multi-class Classification and Neural Networks</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#题目介绍"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">题目介绍</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Code"><span class="post-toc-number">1.2.</span> <span class="post-toc-text">Code</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Load-MATLAB-datafiles"><span class="post-toc-number">1.2.1.</span> <span class="post-toc-text">Load MATLAB datafiles</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Multiclass-Classification"><span class="post-toc-number">1.3.</span> <span class="post-toc-text">Multiclass Classification</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Logistic-regression-hypothesis"><span class="post-toc-number">1.3.1.</span> <span class="post-toc-text">Logistic regression hypothesis</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Regularized-Cost-Function"><span class="post-toc-number">1.3.2.</span> <span class="post-toc-text">Regularized Cost Function</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Vectorized-Cost-Function"><span class="post-toc-number">1.3.3.</span> <span class="post-toc-text">Vectorized Cost Function</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#One-vs-all"><span class="post-toc-number">2.</span> <span class="post-toc-text">One-vs-all</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#One-vs-all-Classification"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">One-vs-all Classification</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#One-vs-all-Prediction"><span class="post-toc-number">2.2.</span> <span class="post-toc-text">One-vs-all Prediction</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Multiclass-Logistic-Regression-with-scikit-learn"><span class="post-toc-number">2.3.</span> <span class="post-toc-text">Multiclass Logistic Regression with scikit-learn</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Neural-Networks"><span class="post-toc-number">3.</span> <span class="post-toc-text">Neural Networks</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Summary"><span class="post-toc-number">4.</span> <span class="post-toc-text">Summary</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#展示图片"><span class="post-toc-number">4.1.</span> <span class="post-toc-text">展示图片</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#reshape内-1的用法"><span class="post-toc-number">4.2.</span> <span class="post-toc-text">reshape内-1的用法</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#LogisticRegression"><span class="post-toc-number">4.3.</span> <span class="post-toc-text">LogisticRegression</span></a></li></ol></li></ol>
        </nav>
    </aside>
    
<article id="post-Coursera-ML-7-Programming-Exercise-3"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">Coursera ML(7)-Programming Exercise 3</h1>
        <div class="post-meta">
            <time class="post-time" title="2017-05-02 18:01:38" datetime="2017-05-02T10:01:38.000Z"  itemprop="datePublished">2017-05-02</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Coursera-ML/">Coursera ML</a></li></ul>



            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


            

        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <script src="/assets/js/DPlayer.min.js"> </script><script src="/assets/js/APlayer.min.js"> </script><blockquote>
<p>machine-learning-ex3.zip <a href="http://home.ustc.edu.cn/~mmmwhy/machine-learning-ex3.zip" target="_blank" rel="external">下载链接</a>，第四周的课程相对来说比较简单，大致介绍了神经网络相关内容。</p>
</blockquote>
<hr>
<a id="more"></a>
<p>注意，官方用的是matlab，这里我用的全部是python，代码是不一样的，更不能当做作业提交。</p>
<hr>
<h1 id="Programming-Exercise-3-Multi-class-Classification-and-Neural-Networks"><a href="#Programming-Exercise-3-Multi-class-Classification-and-Neural-Networks" class="headerlink" title="Programming Exercise 3 - Multi-class Classification and Neural Networks"></a>Programming Exercise 3 - Multi-class Classification and Neural Networks</h1><h2 id="题目介绍"><a href="#题目介绍" class="headerlink" title="题目介绍"></a>题目介绍</h2><p>For this exercise, you will use logistic regression and neural networks to recognize handwritten digits (from 0 to 9). </p>
<p><strong>ex3data1.mat</strong>提供了一个训练集，X包含5000个长度为400的向量，每个向量可以展示为一个20*20的图像。Y内为图像所对应的数字。</p>
<h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># %load ../../standard_import.txt</span></div><div class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</div><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"><span class="keyword">import</span> matplotlib <span class="keyword">as</span> mpl</div><div class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</div><div class="line"></div><div class="line"><span class="comment"># load MATLAB files</span></div><div class="line"><span class="keyword">from</span> scipy.io <span class="keyword">import</span> loadmat</div><div class="line"><span class="keyword">from</span> scipy.optimize <span class="keyword">import</span> minimize</div><div class="line"></div><div class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LogisticRegression</div><div class="line"></div><div class="line">pd.set_option(<span class="string">'display.notebook_repr_html'</span>, <span class="keyword">False</span>)</div><div class="line">pd.set_option(<span class="string">'display.max_columns'</span>, <span class="keyword">None</span>)</div><div class="line">pd.set_option(<span class="string">'display.max_rows'</span>, <span class="number">150</span>)</div><div class="line">pd.set_option(<span class="string">'display.max_seq_items'</span>, <span class="keyword">None</span>)</div><div class="line"> </div><div class="line"><span class="comment">#%config InlineBackend.figure_formats = &#123;'pdf',&#125;</span></div><div class="line">%matplotlib inline</div><div class="line"></div><div class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</div><div class="line">sns.set_context(<span class="string">'notebook'</span>)</div><div class="line">sns.set_style(<span class="string">'white'</span>)</div></pre></td></tr></table></figure>
<h3 id="Load-MATLAB-datafiles"><a href="#Load-MATLAB-datafiles" class="headerlink" title="Load MATLAB datafiles"></a>Load MATLAB datafiles</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">data = loadmat(<span class="string">'data/ex3data1.mat'</span>)</div><div class="line">data.keys()</div></pre></td></tr></table></figure>
<pre><code>dict_keys([&apos;__header__&apos;, &apos;__version__&apos;, &apos;__globals__&apos;, &apos;X&apos;, &apos;y&apos;])
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">weights = loadmat(<span class="string">'data/ex3weights.mat'</span>)</div><div class="line">weights.keys()</div></pre></td></tr></table></figure>
<pre><code>dict_keys([&apos;__header__&apos;, &apos;__version__&apos;, &apos;__globals__&apos;, &apos;Theta1&apos;, &apos;Theta2&apos;])
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">y = data[<span class="string">'y'</span>]</div><div class="line"><span class="comment"># Add constant for intercept</span></div><div class="line">X = np.c_[np.ones((data[<span class="string">'X'</span>].shape[<span class="number">0</span>],<span class="number">1</span>)), data[<span class="string">'X'</span>]]</div><div class="line"></div><div class="line">print(<span class="string">'X: &#123;&#125; (with intercept)'</span>.format(X.shape))</div><div class="line">print(<span class="string">'y: &#123;&#125;'</span>.format(y.shape))</div></pre></td></tr></table></figure>
<pre><code>X: (5000, 401) (with intercept)
y: (5000, 1)
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">theta1, theta2 = weights[<span class="string">'Theta1'</span>], weights[<span class="string">'Theta2'</span>]</div><div class="line"></div><div class="line">print(<span class="string">'theta1: &#123;&#125;'</span>.format(theta1.shape))</div><div class="line">print(<span class="string">'theta2: &#123;&#125;'</span>.format(theta2.shape))</div></pre></td></tr></table></figure>
<pre><code>theta1: (25, 401)
theta2: (10, 26)
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">sample = np.random.choice(X.shape[<span class="number">0</span>], <span class="number">20</span>)</div><div class="line">plt.imshow(X[sample,<span class="number">1</span>:].reshape(<span class="number">-1</span>,<span class="number">20</span>).T)</div><div class="line">plt.axis(<span class="string">'off'</span>);</div></pre></td></tr></table></figure>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170502/171813517.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<h2 id="Multiclass-Classification"><a href="#Multiclass-Classification" class="headerlink" title="Multiclass Classification"></a>Multiclass Classification</h2><h3 id="Logistic-regression-hypothesis"><a href="#Logistic-regression-hypothesis" class="headerlink" title="Logistic regression hypothesis"></a>Logistic regression hypothesis</h3> $$ h_{\theta}(x) = g(\theta^{T}x)$$ 
 $$ g(z)=\frac{1}{1+e^{−z}} $$ 
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sigmoid</span><span class="params">(z)</span>:</span></div><div class="line">    <span class="keyword">return</span>(<span class="number">1</span> / (<span class="number">1</span> + np.exp(-z)))</div></pre></td></tr></table></figure>
<h3 id="Regularized-Cost-Function"><a href="#Regularized-Cost-Function" class="headerlink" title="Regularized Cost Function"></a>Regularized Cost Function</h3> $$ J(\theta) = \frac{1}{m}\sum_{i=1}^{m}\big[-y^{(i)}\, log\,( h_\theta\,(x^{(i)}))-(1-y^{(i)})\,log\,(1-h_\theta(x^{(i)}))\big] + \frac{\lambda}{2m}\sum_{j=1}^{n}\theta_{j}^{2}$$ 
<h3 id="Vectorized-Cost-Function"><a href="#Vectorized-Cost-Function" class="headerlink" title="Vectorized Cost Function"></a>Vectorized Cost Function</h3> $$ J(\theta) = \frac{1}{m}\big((\,log\,(g(X\theta))^Ty+(\,log\,(1-g(X\theta))^T(1-y)\big) + \frac{\lambda}{2m}\sum_{j=1}^{n}\theta_{j}^{2}$$ 
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">lrcostFunctionReg</span><span class="params">(theta, reg, X, y)</span>:</span></div><div class="line">    m = y.size</div><div class="line">    h = sigmoid(X.dot(theta))</div><div class="line">    </div><div class="line">    J = <span class="number">-1</span>*(<span class="number">1</span>/m)*(np.log(h).T.dot(y)+np.log(<span class="number">1</span>-h).T.dot(<span class="number">1</span>-y)) + (reg/(<span class="number">2</span>*m))*np.sum(np.square(theta[<span class="number">1</span>:]))</div><div class="line">    </div><div class="line">    <span class="keyword">if</span> np.isnan(J[<span class="number">0</span>]):</div><div class="line">        <span class="keyword">return</span>(np.inf)</div><div class="line">    <span class="keyword">return</span>(J[<span class="number">0</span>])</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">lrgradientReg</span><span class="params">(theta, reg, X,y)</span>:</span></div><div class="line">    m = y.size</div><div class="line">    h = sigmoid(X.dot(theta.reshape(<span class="number">-1</span>,<span class="number">1</span>)))</div><div class="line">      </div><div class="line">    grad = (<span class="number">1</span>/m)*X.T.dot(h-y) + (reg/m)*np.r_[[[<span class="number">0</span>]],theta[<span class="number">1</span>:].reshape(<span class="number">-1</span>,<span class="number">1</span>)]</div><div class="line">        </div><div class="line">    <span class="keyword">return</span>(grad.flatten())</div></pre></td></tr></table></figure>
<h1 id="One-vs-all"><a href="#One-vs-all" class="headerlink" title="One-vs-all"></a>One-vs-all</h1><h2 id="One-vs-all-Classification"><a href="#One-vs-all-Classification" class="headerlink" title="One-vs-all Classification"></a>One-vs-all Classification</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">oneVsAll</span><span class="params">(features, classes, n_labels, reg)</span>:</span></div><div class="line">    initial_theta = np.zeros((X.shape[<span class="number">1</span>],<span class="number">1</span>))  <span class="comment"># 401x1</span></div><div class="line">    all_theta = np.zeros((n_labels, X.shape[<span class="number">1</span>])) <span class="comment">#10x401</span></div><div class="line"></div><div class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> np.arange(<span class="number">1</span>, n_labels+<span class="number">1</span>):</div><div class="line">        res = minimize(lrcostFunctionReg, initial_theta, args=(reg, features, (classes == c)*<span class="number">1</span>), method=<span class="keyword">None</span>,</div><div class="line">                       jac=lrgradientReg, options=&#123;<span class="string">'maxiter'</span>:<span class="number">50</span>&#125;)</div><div class="line">        all_theta[c<span class="number">-1</span>] = res.x</div><div class="line">    <span class="keyword">return</span>(all_theta)</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">theta = oneVsAll(X, y, <span class="number">10</span>, <span class="number">0.1</span>)</div></pre></td></tr></table></figure>
<h2 id="One-vs-all-Prediction"><a href="#One-vs-all-Prediction" class="headerlink" title="One-vs-all Prediction"></a>One-vs-all Prediction</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">predictOneVsAll</span><span class="params">(all_theta, features)</span>:</span></div><div class="line">    probs = sigmoid(X.dot(all_theta.T))</div><div class="line">        </div><div class="line">    <span class="comment"># Adding one because Python uses zero based indexing for the 10 columns (0-9),</span></div><div class="line">    <span class="comment"># while the 10 classes are numbered from 1 to 10.</span></div><div class="line">    <span class="keyword">return</span>(np.argmax(probs, axis=<span class="number">1</span>)+<span class="number">1</span>)</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">pred = predictOneVsAll(theta, X)</div><div class="line">print(<span class="string">'Training set accuracy: &#123;&#125; %'</span>.format(np.mean(pred == y.ravel())*<span class="number">100</span>))</div></pre></td></tr></table></figure>
<pre><code>Training set accuracy: 93.24 %
</code></pre><h2 id="Multiclass-Logistic-Regression-with-scikit-learn"><a href="#Multiclass-Logistic-Regression-with-scikit-learn" class="headerlink" title="Multiclass Logistic Regression with scikit-learn"></a>Multiclass Logistic Regression with scikit-learn</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">clf = LogisticRegression(C=<span class="number">10</span>, penalty=<span class="string">'l2'</span>, solver=<span class="string">'liblinear'</span>)</div><div class="line"><span class="comment"># Scikit-learn fits intercept automatically, so we exclude first column with 'ones' from X when fitting.</span></div><div class="line">clf.fit(X[:,<span class="number">1</span>:],y.ravel())</div></pre></td></tr></table></figure>
<pre><code>LogisticRegression(C=10, class_weight=None, dual=False, fit_intercept=True,
          intercept_scaling=1, max_iter=100, multi_class=&apos;ovr&apos;, n_jobs=1,
          penalty=&apos;l2&apos;, random_state=None, solver=&apos;liblinear&apos;, tol=0.0001,
          verbose=0, warm_start=False)
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">pred2 = clf.predict(X[:,<span class="number">1</span>:])</div><div class="line">print(<span class="string">'Training set accuracy: &#123;&#125; %'</span>.format(np.mean(pred2 == y.ravel())*<span class="number">100</span>))</div></pre></td></tr></table></figure>
<pre><code>Training set accuracy: 96.5 %
</code></pre><h1 id="Neural-Networks"><a href="#Neural-Networks" class="headerlink" title="Neural Networks"></a>Neural Networks</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">predict</span><span class="params">(theta_1, theta_2, features)</span>:</span></div><div class="line">    z2 = theta_1.dot(features.T)</div><div class="line">    a2 = np.c_[np.ones((data[<span class="string">'X'</span>].shape[<span class="number">0</span>],<span class="number">1</span>)), sigmoid(z2).T]</div><div class="line">    </div><div class="line">    z3 = a2.dot(theta_2.T)</div><div class="line">    a3 = sigmoid(z3)</div><div class="line">        </div><div class="line">    <span class="keyword">return</span>(np.argmax(a3, axis=<span class="number">1</span>)+<span class="number">1</span>)</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">pred = predict(theta1, theta2, X)</div><div class="line">print(<span class="string">'Training set accuracy: &#123;&#125; %'</span>.format(np.mean(pred == y.ravel())*<span class="number">100</span>))</div></pre></td></tr></table></figure>
<pre><code>Training set accuracy: 97.52 %
</code></pre><h1 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h1><h2 id="展示图片"><a href="#展示图片" class="headerlink" title="展示图片"></a>展示图片</h2><p>因为给的数据是矩阵的形式，所以需要分为单个向量，重新设置形状。然后展示出来，跟<a href="http://feiyang.li/2017/03/17/python-mnist/index.html">手写字体识别</a>是很像。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">%matplotlib inline</div><div class="line"><span class="keyword">import</span> scipy.io <span class="keyword">as</span> sio </div><div class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</div><div class="line">matfn=<span class="string">'C:/Users/wing/Documents/MATLAB/ex3/ex3data1.mat'</span>  </div><div class="line">data=sio.loadmat(matfn)  </div><div class="line">im = data[<span class="string">'X'</span>][<span class="number">0</span>]</div><div class="line">im = im.reshape(<span class="number">20</span>,<span class="number">20</span>)</div><div class="line">plt.imshow(im , cmap=<span class="string">'gray'</span>)</div></pre></td></tr></table></figure>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170416/135847233.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="mark" title="">
                </div>
                <div class="image-caption">mark</div>
            </figure>
<p>如果想要一次展示多个图像呢，写个循环就可以了。不过太多的话，可能就看不清了。。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">im = []</div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">500</span>):</div><div class="line">    plt.subplot(<span class="number">10</span>, <span class="number">50</span>, i + <span class="number">1</span>)</div><div class="line">    temp = data[<span class="string">'X'</span>][i]</div><div class="line">    im.append(temp.reshape(<span class="number">20</span>,<span class="number">20</span>))</div><div class="line">    plt.imshow(im[i], cmap=<span class="string">'gray'</span>)</div><div class="line">plt.show()</div></pre></td></tr></table></figure></p>
<h2 id="reshape内-1的用法"><a href="#reshape内-1的用法" class="headerlink" title="reshape内-1的用法"></a><strong>reshape</strong>内-1的用法</h2><p>官方文档：numpy.reshape - NumPy v1.11 Manual</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>a = np.array([[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>], [<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>]])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>np.reshape(a, (<span class="number">3</span>,<span class="number">-1</span>))  <span class="comment"># the unspecified value is inferred to be 2</span></div><div class="line">array([[<span class="number">1</span>, <span class="number">2</span>],</div><div class="line">       [<span class="number">3</span>, <span class="number">4</span>],</div><div class="line">       [<span class="number">5</span>, <span class="number">6</span>]])</div></pre></td></tr></table></figure>
<p>-1表示我懒得计算该填什么数字，由python通过a和其他的值推测出来。</p>
<h2 id="LogisticRegression"><a href="#LogisticRegression" class="headerlink" title="LogisticRegression"></a>LogisticRegression</h2><p><code>from sklearn.linear_model import LogisticRegression</code></p>
<p><a href="http://www.cnblogs.com/xupeizhi/archive/2013/07/05/3174703.html" target="_blank" rel="external">http://www.cnblogs.com/xupeizhi/archive/2013/07/05/3174703.html</a><br><a href="http://scikit-learn.org/stable/index.html" target="_blank" rel="external">http://scikit-learn.org/stable/index.html</a></p>

        </div>

        <blockquote class="post-copyright">
    <div class="content">
        
<span class="post-time">
    最后更新时间：<time datetime="2017-05-02T10:04:58.026Z" itemprop="dateUpdated">2017-05-02 18:04:58</time>
</span><br>


        
    </div>
    <footer>
        <a href="http://feiyang.li">
            <img src="/img/logo.jpg" alt="Wing Lee">
            Wing Lee
        </a>
    </footer>
</blockquote>

        
<div class="page-reward">
    <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">赏</a>
</div>



        <div class="post-footer">
            
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Machine-Learning/">Machine Learning</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Python/">Python</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/读书笔记/">读书笔记</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://feiyang.li/2017/05/02/Coursera-ML-7-Programming-Exercise-3/&title=《Coursera ML(7)-Programming Exercise 3》 — 李飞阳&pic=http://feiyang.li/img/logo.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://feiyang.li/2017/05/02/Coursera-ML-7-Programming-Exercise-3/&title=《Coursera ML(7)-Programming Exercise 3》 — 李飞阳&source=
machine-learning-ex3.zip 下载链接，第四周的课程相对来说比较简单，大致介绍了神经网络相关内容。

" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://feiyang.li/2017/05/02/Coursera-ML-7-Programming-Exercise-3/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Coursera ML(7)-Programming Exercise 3》 — 李飞阳&url=http://feiyang.li/2017/05/02/Coursera-ML-7-Programming-Exercise-3/&via=http://feiyang.li" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://feiyang.li/2017/05/02/Coursera-ML-7-Programming-Exercise-3/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/2017/05/03/ss-panel/index.html" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">可能是最简单的ss-panel安装教程</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/2017/04/15/Coursera-ML-6-Neural-Networks-Representation/index.html" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">Coursera ML(6)-Neural Networks Representation</h4>
      </a>
    </div>
  
</nav>



    










    <div id="cloud-tie-wrapper" class="comments cloud-tie-wrapper"></div>
    <script>
    var cloudTieConfig = {
        url: 'http://feiyang.li/2017/05/02/Coursera-ML-7-Programming-Exercise-3/index.html',
        sourceId: 'Coursera-ML-7-Programming-Exercise-3',
        productKey: '9d56d2fd321c48c7a0b079b76f0795cf',
        target: 'cloud-tie-wrapper',
        pcFiles: [
            '/css/cloudTie/pc.css?v=1.6.7',
            '/js/cloudTie/pc.min.js?v=1.6.7',
        ],
        mobileFiles: [
            '/css/cloudTie/mobile.css?v=1.6.7',
            '/js/cloudTie/mobile.min.js?v=1.6.7'
        ]
    };
    </script>
    <script src="/js/cloudTie/loader.min.js?v=1.6.7"></script>







</article>

<div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        谢谢大爷~
        <i class="icon icon-quote-right"></i>
    </h3>
    <ul class="reward-items">
        
        <li>
            <img src="/img/wechat.jpg" title="微信打赏二维码" alt="微信打赏二维码">
            <p>微信</p>
        </li>
        

        
        <li>
            <img src="/img/alipay.jpg" title="支付宝打赏二维码" alt="支付宝打赏二维码">
            <p>支付宝</p>
        </li>
        
    </ul>
</div>



</div>

    </main>
    <footer class="footer">
    <div class="bottom">
        <p>
            <span><a href="http://www.beian.gov.cn/" target="_blank">陕ICP备17001447号</a></span>
            <span><a href="http://feiyang.li/sitemap.xml" target="_blank">网站地图</a></span>
        </p>
    </div>
</footer>

    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://feiyang.li/2017/05/02/Coursera-ML-7-Programming-Exercise-3/&title=《Coursera ML(7)-Programming Exercise 3》 — 李飞阳&pic=http://feiyang.li/img/logo.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://feiyang.li/2017/05/02/Coursera-ML-7-Programming-Exercise-3/&title=《Coursera ML(7)-Programming Exercise 3》 — 李飞阳&source=
machine-learning-ex3.zip 下载链接，第四周的课程相对来说比较简单，大致介绍了神经网络相关内容。

" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://feiyang.li/2017/05/02/Coursera-ML-7-Programming-Exercise-3/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Coursera ML(7)-Programming Exercise 3》 — 李飞阳&url=http://feiyang.li/2017/05/02/Coursera-ML-7-Programming-Exercise-3/&via=http://feiyang.li" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://feiyang.li/2017/05/02/Coursera-ML-7-Programming-Exercise-3/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAN4AAADeCAAAAAB3DOFrAAACsElEQVR42u3a0WoCQQwFUP//py30qdCu3iQTq3D2SURn56wwiUlut/i6f1+/3/l5/f7k1evHd3l83TYuPDw8vNbWHy+X3yxZIXlkycOKdoWHh4e3xnscDJLb5BtNHsdkNTw8PLz34eWLzj+ZJ+54eHh4789LgkEvkODh4eF9Fi8pRiTfqm63V/5YqbXg4eHhLXSR3uf1Yn8PDw8Pb9yqnzS08tJGL2V/sk88PDy8BV5SdMjDQy/Jng8fPLkLHh4e3gIvXzQvAVSLBXn5ozp2gIeHh3eWlw8E5GMEvTS6l5Q/seDh4eEt8KoH7rytNR/2qg4Z4OHh4W3w8sO3GiQmgwJ5MCiEKzw8PLwxb57yVlc4VcCNfgw8PDy8ZV7+/z1vm1XT317j7XLneHh4eGu8pImVJ9aTtHhSzP3j7nh4eHhrvDwLzbde3WIvNY9GB/Dw8PCO8nqlgbPH914IwcPDw9vg5c3+5PCdbLQafpJSCB4eHt5reL3SbTXA5GXc0aPBw8PDW+MlB30vae6NFFTbcpev8fDw8BZ41XZ+nny/pnZSGFnAw8PDO8SrpraTkm4+jFVNzS9XwMPDw1vgVRtU1UAyGVOovn/5+PDw8PDWePOCbHLLydGfDF09aYPh4eHhjXl5i2tSqO1tt1rOiH43PDw8vDEvKb/2WlCTz1cZyR8APDw8vFO8alqcFy9OlTOSNDqKe3h4eHiHeEnpIaFWE99q+p6XSPKxAzw8PLwe7168egd0Eh7mxZFoMgIPDw9vzOsFid7mJo+mV/jAw8PD2+Plzar8CfUaV/PiBR4eHt4refmhPyndTtpgo5IEHh4e3sfyTpUbCqEFDw8P7195+XFcTaOr7a6VwICHh4d3qMNePY7nsHy1pFSBh4eHt8E7NYBVDRWTleeFZjw8PLwW7wuDKNB1YG+jwQAAAABJRU5ErkJggg==" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: true };



</script>

<script src="/js/main.min.js?v=1.6.7"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="/js/search.min.js?v=1.6.7" async></script>






<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>



<script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = '死鬼去哪里了！';
            clearTimeout(titleTime);
        } else {
            document.title = '(つェ⊂)咦!又好了!';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script>



</body>
</html>
