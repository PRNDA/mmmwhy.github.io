<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>李飞阳</title>
  <subtitle>PM、Coder、Data mining</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://feiyang.li/"/>
  <updated>2017-05-20T11:36:51.524Z</updated>
  <id>http://feiyang.li/</id>
  
  <author>
    <name>Wing Lee</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Django 笔记之二 视图与网址</title>
    <link href="http://feiyang.li/2017/05/20/django2/index.html"/>
    <id>http://feiyang.li/2017/05/20/django2/index.html</id>
    <published>2017-05-20T08:06:53.000Z</published>
    <updated>2017-05-20T11:36:51.524Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/DPlayer.min.js"> </script><script src="/assets/js/APlayer.min.js"> </script><blockquote>
<p><a href="http://feiyang.li/2017/05/20/django1/index.html">上节</a>已经提到新建app，这节稍微深入一些</p>
</blockquote>
<hr>
<a id="more"></a>
<h1 id="新建app"><a href="#新建app" class="headerlink" title="新建app"></a>新建app</h1><h2 id="基本步骤"><a href="#基本步骤" class="headerlink" title="基本步骤"></a>基本步骤</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python manage.py startapp learn # learn 是一个app的名称</div></pre></td></tr></table></figure>
<p>之后大概是这个样子，也许你们会发现我用的其实是<strong>世界上最好的python IDE</strong>~<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div></pre></td><td class="code"><pre><div class="line">E:.</div><div class="line">│  db.sqlite3</div><div class="line">│  manage.py</div><div class="line">│  Python</div><div class="line">│</div><div class="line">├─.idea</div><div class="line">│  │  blog.iml</div><div class="line">│  │  misc.xml</div><div class="line">│  │  modules.xml</div><div class="line">│  │  workspace.xml</div><div class="line">│  │</div><div class="line">│  └─inspectionProfiles</div><div class="line">│          profiles_settings.xml</div><div class="line">│</div><div class="line">├─blog</div><div class="line">│  │  settings.py</div><div class="line">│  │  settings.pyc</div><div class="line">│  │  urls.py</div><div class="line">│  │  urls.pyc</div><div class="line">│  │  wsgi.py</div><div class="line">│  │  wsgi.pyc</div><div class="line">│  │  __init__.py</div><div class="line">│  │  __init__.pyc</div><div class="line">│  │</div><div class="line">│  └─__pycache__</div><div class="line">│          settings.cpython-35.pyc</div><div class="line">│          urls.cpython-35.pyc</div><div class="line">│          wsgi.cpython-35.pyc</div><div class="line">│          __init__.cpython-35.pyc</div><div class="line">│</div><div class="line">└─my_blog</div><div class="line">    │  admin.py</div><div class="line">    │  admin.pyc</div><div class="line">    │  apps.py</div><div class="line">    │  models.py</div><div class="line">    │  models.pyc</div><div class="line">    │  tests.py</div><div class="line">    │  views.py</div><div class="line">    │  views.pyc</div><div class="line">    │  __init__.py</div><div class="line">    │  __init__.pyc</div><div class="line">    │</div><div class="line">    ├─migrations</div><div class="line">    │  │  __init__.py</div><div class="line">    │  │  __init__.pyc</div><div class="line">    │  │</div><div class="line">    │  └─__pycache__</div><div class="line">    │          __init__.cpython-35.pyc</div><div class="line">    │</div><div class="line">    └─__pycache__</div><div class="line">            admin.cpython-35.pyc</div><div class="line">            models.cpython-35.pyc</div><div class="line">            views.cpython-35.pyc</div><div class="line">            __init__.cpython-35.pyc</div></pre></td></tr></table></figure></p>
<h2 id="声明my-blog"><a href="#声明my-blog" class="headerlink" title="声明my_blog"></a>声明<strong>my_blog</strong></h2><p>我们需要在<strong>settings.py</strong>中去声明一下<strong>my_blog</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">INSTALLED_APPS = [</div><div class="line">    <span class="string">'django.contrib.admin'</span>,</div><div class="line">    <span class="string">'django.contrib.auth'</span>,</div><div class="line">    <span class="string">'django.contrib.contenttypes'</span>,</div><div class="line">    <span class="string">'django.contrib.sessions'</span>,</div><div class="line">    <span class="string">'django.contrib.messages'</span>,</div><div class="line">    <span class="string">'django.contrib.staticfiles'</span>,</div><div class="line">    <span class="string">'my_blog'</span>,</div><div class="line">]</div></pre></td></tr></table></figure>
<p>新建的 app 如果不加到 INSTALL_APPS 中的话, django 就不能自动找到app中的模板文件(app-name/templates/下的文件)和静态文件(app-name/static/中的文件) 。</p>
<h2 id="定义视图内容"><a href="#定义视图内容" class="headerlink" title="定义视图内容"></a>定义视图内容</h2><p>将views.py修改为我们希望展示的内容：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#coding: utf-8</span></div><div class="line"><span class="keyword">from</span> django.http <span class="keyword">import</span> HttpResponse</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">(request)</span>:</span></div><div class="line">    <span class="keyword">return</span> HttpResponse(<span class="string">u'你好哇，李肥羊，希望你可以瘦下来！'</span>)</div></pre></td></tr></table></figure></p>
<p>使用<code>python manage.py runserver</code>，启动django服务</p>
<ul>
<li><p>第一行是声明编码为utf-8, 因为我们在代码中用到了中文,如果不声明就报错.</p>
</li>
<li><p>第二行引入HttpResponse，它是用来向网页返回内容的，就像Python中的 print 一样，只不过 HttpResponse 是把内容显示到网页上。</p>
</li>
</ul>
<p>我们定义了一个index()函数，第一个参数必须是 request，与网页发来的请求有关，request 变量里面包含get或post的内容，用户浏览器，系统等信息在里面（后面会讲，先了解一下就可以）。</p>
<p>函数返回了一个 HttpResponse 对象，可以经过一些处理，最终显示几个字到网页上。<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170520/103039383.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure></p>
<p>如果你前端技术非常好的话，可以直接把整个页面return回去。。。</p>
<p>那问题来了，我们访问什么网址才能看到刚才写的这个函数呢？怎么让网址和函数关联起来呢？</p>
<h2 id="定义视图函数相关的URL-网址"><a href="#定义视图函数相关的URL-网址" class="headerlink" title="定义视图函数相关的URL(网址)"></a>定义视图函数相关的URL(网址)</h2><p>即规定 访问什么网址对应什么内容，我们打开 urls.py 这个文件, 修改其中的代码:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> django.conf.urls <span class="keyword">import</span> url</div><div class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> admin</div><div class="line"><span class="keyword">from</span> my_blog <span class="keyword">import</span> views <span class="keyword">as</span> my_blog_view</div><div class="line">urlpatterns = [</div><div class="line">    url(<span class="string">r'^admin/'</span>, admin.site.urls),</div><div class="line">    url(<span class="string">r'^$'</span>, my_blog_view.index),</div><div class="line">]</div></pre></td></tr></table></figure></p>
<p>先从<strong>my_blog</strong>导入<strong>views</strong>进入<strong>urls.py</strong>，然后用正则表达式，设定对应规则。如果忘了正则表达式怎么使用，也许这个<a href="http://feiyang.li/2017/02/10/Python_lambda/index.html">网页</a>会对你有帮助.</p>
<h1 id="通过链接做加减法"><a href="#通过链接做加减法" class="headerlink" title="通过链接做加减法"></a>通过链接做加减法</h1><p>跟之前的步骤一样，先修改<strong>view.py</strong>文件</p>
<h2 id="修改view-py"><a href="#修改view-py" class="headerlink" title="修改view.py"></a>修改view.py</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">def add(request):</div><div class="line">    a = request.GET[&apos;a&apos;]</div><div class="line">    b = request.GET[&apos;b&apos;]</div><div class="line">    c = int(a)+int(b)</div><div class="line">    return HttpResponse(str(c))</div><div class="line"></div><div class="line">def sub(request):</div><div class="line">    a = request.GET[&apos;a&apos;]</div><div class="line">    b = request.GET[&apos;b&apos;]</div><div class="line">    c = int(a)-int(b)</div><div class="line">    return HttpResponse(str(c))</div><div class="line">def add2(request, a, b):</div><div class="line">    c = int(a) + int(b)</div><div class="line">    return HttpResponse(str(c))</div></pre></td></tr></table></figure>
<h2 id="修改urls-py"><a href="#修改urls-py" class="headerlink" title="修改urls.py"></a>修改urls.py</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">url(r&apos;^add/$&apos;, my_blog_view.add, name=&apos;add&apos;),  # 注意修改了这一行</div><div class="line">url(r&apos;^sub/$&apos;, my_blog_view.add, name=&apos;sub&apos;),  # 注意修改了这一行</div><div class="line">url(r&apos;^add/(\d+)/(\d+)/$&apos;, my_blog_view.add2, name=&apos;add2&apos;),</div></pre></td></tr></table></figure>
<h2 id="运行检查"><a href="#运行检查" class="headerlink" title="运行检查"></a>运行检查</h2><p>输入<a href="http://127.0.0.1:8000/add/?a=4&amp;b=5或者http://127.0.0.1:8000/add/?a=4&amp;b=5" target="_blank" rel="external">http://127.0.0.1:8000/add/?a=4&amp;b=5或者http://127.0.0.1:8000/add/?a=4&amp;b=5</a><br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170520/151648247.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure><br>就可以获得答案</p>
<h1 id="URL-name返回整个页面"><a href="#URL-name返回整个页面" class="headerlink" title="URL name返回整个页面"></a>URL name返回整个页面</h1><h2 id="urls-py"><a href="#urls-py" class="headerlink" title="urls.py"></a>urls.py</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">url(r&apos;^add/$&apos;, calc_views.add, name=&apos;add&apos;)</div></pre></td></tr></table></figure>
<p> 这里的 name=’add’ 是用来干什么的呢，简单说，name 可以用于在 templates, models, views ……中得到对应的网址，相当于“给网址取了个名字”，只要这个名字不变，网址变了也能通过名字获取到。</p>
<h2 id="views-py"><a href="#views-py" class="headerlink" title="views.py"></a>views.py</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">from django.http import HttpResponse</div><div class="line">from django.shortcuts import render</div><div class="line"> </div><div class="line"> </div><div class="line">def index(request):</div><div class="line">    return render(request, &apos;home.html&apos;)</div></pre></td></tr></table></figure>
<h2 id="templates"><a href="#templates" class="headerlink" title="templates"></a>templates</h2><p>我们在 my_blog 这个 app 中新建一个 templates 文件夹，在templates中新建一个 home.html<br>文件 my_blog/templates/home.html 中写入以下内容（保存时用 utf8 编码）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&lt;!DOCTYPE html&gt;</div><div class="line">&lt;html lang=&quot;en&quot;&gt;</div><div class="line">&lt;head&gt;</div><div class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</div><div class="line">    &lt;title&gt;今天是个好天气&lt;/title&gt;</div><div class="line">&lt;/head&gt;</div><div class="line">&lt;body&gt;</div><div class="line">&lt;a href=&quot;/add/4/5/&quot;&gt;计算 4+5&lt;/a&gt;</div><div class="line">&lt;/body&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure></p>
<h2 id="运行结果"><a href="#运行结果" class="headerlink" title="运行结果"></a>运行结果</h2><p>运行开发服务器，我们访问 <a href="http://127.0.0.1:8000/" target="_blank" rel="external">http://127.0.0.1:8000/</a> 可以看到<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170520/153435675.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure><br>点击<strong>计算4+5</strong>，可以看到答案。</p>
<h2 id="如何用-Python-代码获取对应的网址"><a href="#如何用-Python-代码获取对应的网址" class="headerlink" title="如何用 Python 代码获取对应的网址"></a>如何用 Python 代码获取对应的网址</h2><p>···<br><a href="/add/4/5/">计算 4+5</a><br>···<br>如果这样写“死网址”，之后上线后，如果想要改变链接结构，将会很麻烦。如果有些地方没有修改过来，就不能使用了、<br>使用<code>python manage.py shell</code>，进入<code>django shell</code>调试页面.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> django.core.urlresolvers <span class="keyword">import</span> reverse  <span class="comment"># django 1.4.x - django 1.10.x</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> django.urls <span class="keyword">import</span> reverse  <span class="comment"># django 1.10.x 新的，更加规范了</span></div><div class="line"> </div><div class="line"><span class="meta">&gt;&gt;&gt; </span>reverse(<span class="string">'add2'</span>, args=(<span class="number">4</span>,<span class="number">5</span>))</div><div class="line"><span class="string">u'/add/4/5/'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>reverse(<span class="string">'add2'</span>, args=(<span class="number">444</span>,<span class="number">555</span>))</div><div class="line"><span class="string">u'/add/444/555/'</span></div></pre></td></tr></table></figure></p>
<p><strong>reverse 接收 url 中的 name 作为第一个参数</strong>，我们在代码中就可以通过 reverse() 来获取对应的网址。也就是输入name返回<strong>对应网址</strong>。</p>
<p>例如：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;a href=&quot;&#123;% url &apos;add2&apos; 4 5 %&#125;&quot;&gt; 计算 4+5&lt;/a&gt;</div></pre></td></tr></table></figure></p>
<p>上面的代码渲染成最终的页面是</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;a href=&quot;/add/4/5/&quot;&gt;计算 4+5&lt;/a&gt;</div></pre></td></tr></table></figure>
 |这样就可以通过 {% url 'add2' 4 5 %} 获取到对应的网址 /add/4/5/ |<br><br>这样，即使我们在<strong>urls.py</strong>中修改了网址链接，<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">url(r&apos;^new_add/(\d+)/(\d+)/$&apos;, my_blog_view.add2, name=&apos;add2&apos;),</div></pre></td></tr></table></figure>
<p>注意看重点 add 变成了 new_add，但是后面的 name=’add2’ 没改，这时  |`{% url 'add2' 4 5 %}` | 就会渲染对应的网址成<code>/new_add/4/5/</code></p>
<p>用在 views.py 或 models.py 等地方的 reverse函数，同样会根据 name 对应的url获取到新的网址。</p>
<p>想要改网址的时候，修改 urls.py 中的正则表达式部分（url 参数第一部分），name 不变的前提下，其它地方都不需要修改。</p>
<h2 id="链接跳转"><a href="#链接跳转" class="headerlink" title="链接跳转"></a>链接跳转</h2><h3 id="views-py-写一个跳转的函数"><a href="#views-py-写一个跳转的函数" class="headerlink" title="views.py 写一个跳转的函数"></a>views.py 写一个跳转的函数</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">from django.http import HttpResponseRedirect</div><div class="line">from django.urls import reverse  # new in django 1.10.x</div><div class="line"> </div><div class="line">def old_add2_redirect(request, a, b):</div><div class="line">    return HttpResponseRedirect(</div><div class="line">        reverse(&apos;add2&apos;, args=(a, b))</div><div class="line">    )</div></pre></td></tr></table></figure>
<h3 id="urls-py-1"><a href="#urls-py-1" class="headerlink" title="urls.py"></a>urls.py</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">url(r&apos;^add/(\d+)/(\d+)/$&apos;, my_blog_view.old_add2_redirect),</div><div class="line">url(r&apos;^new_add/(\d+)/(\d+)/$&apos;, my_blog_view.add2, name=&apos;add2&apos;),</div></pre></td></tr></table></figure>
<p>即可完成跳转</p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;http://feiyang.li/2017/05/20/django1/index.html&quot;&gt;上节&lt;/a&gt;已经提到新建app，这节稍微深入一些&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
    
    </summary>
    
      <category term="Django" scheme="http://feiyang.li/categories/Django/"/>
    
    
      <category term="教程" scheme="http://feiyang.li/tags/%E6%95%99%E7%A8%8B/"/>
    
      <category term="Django" scheme="http://feiyang.li/tags/Django/"/>
    
  </entry>
  
  <entry>
    <title>Django 笔记之一 基本命令</title>
    <link href="http://feiyang.li/2017/05/20/django1/index.html"/>
    <id>http://feiyang.li/2017/05/20/django1/index.html</id>
    <published>2017-05-20T01:20:41.000Z</published>
    <updated>2017-05-20T11:36:45.507Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/DPlayer.min.js"> </script><script src="/assets/js/APlayer.min.js"> </script><p>本节主要是为了让您了解一些django最基本的命令，请尝试着记住它们，并且多多练习下，打开 Linux 或 MacOS 的 Terminal （终端）直接在 终端中输入这些命令（不是 python 的 shell中）</p>
<hr>
<a id="more"></a>
<p>如果是 windows 用 cmd（开始 搜索 cmd 或者 快捷键 win + R，输入 cmd) 直接在 cmd 上操作。</p>
<h1 id="新建一个-django-project"><a href="#新建一个-django-project" class="headerlink" title="新建一个 django project"></a>新建一个 django project</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">django-admin.py startproject my_blog</div></pre></td></tr></table></figure>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170520/085723517.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<p>特别是在 windows 上，如果报错，尝试用 django-admin 代替 django-admin.py 试试<br>注意 project_name 是自己的项目名称，需要为合法的 Python 包名，如不能为 1a 或 a-b。</p>
<h1 id="新建-app"><a href="#新建-app" class="headerlink" title="新建 app"></a>新建 app</h1><p>要先进入项目目录下，cd project_name 然后执行下面的命令（下同，已经在项目目录下则不需要 cd project_name）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python manage.py startapp blog</div></pre></td></tr></table></figure></p>
<p>或<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">django-admin.py startapp blog</div></pre></td></tr></table></figure></p>
<p>效果太概是这个样子的<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">.</div><div class="line">├── my_blog</div><div class="line">│   ├── admin.py</div><div class="line">│   ├── __init__.py</div><div class="line">│   ├── migrations</div><div class="line">│   │   └── __init__.py</div><div class="line">│   ├── models.py</div><div class="line">│   ├── tests.py</div><div class="line">│   └── views.py</div><div class="line">├── blog</div><div class="line">│   ├── __init__.py</div><div class="line">│   ├── __pycache__</div><div class="line">│   │   ├── __init__.cpython-34.pyc</div><div class="line">│   │   └── settings.cpython-34.pyc</div><div class="line">│   ├── settings.py</div><div class="line">│   ├── urls.py</div><div class="line">│   └── wsgi.py</div><div class="line">└── manage.py</div></pre></td></tr></table></figure></p>
<p>一般一个项目有多个app, 当然通用的app也可以在多个项目中使用。</p>
<p>与项目名类似 app name 也需要为合法的 Python 包名，如 blog，news, aboutus 等都是合法的 app 名称。</p>
<h1 id="同步更改数据库表或字段"><a href="#同步更改数据库表或字段" class="headerlink" title="同步更改数据库表或字段"></a>同步更改数据库表或字段</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Django 1.7.1及以上 用以下命令</div><div class="line"># 1. 创建更改的文件</div><div class="line">python manage.py makemigrations</div><div class="line"># 2. 将生成的py文件应用到数据库</div><div class="line">python manage.py migrate</div></pre></td></tr></table></figure>
<p>这种方法可以在SQL等数据库中创建与models.py代码对应的表，不需要自己手动执行SQL。</p>
<p>备注：对已有的 models 进行修改，Django 1.7之前的版本的Django都是无法自动更改表结构的，不过有第三方工具 south,详见 Django 数据库迁移 一节。</p>
<h1 id="使用开发服务器"><a href="#使用开发服务器" class="headerlink" title="使用开发服务器"></a>使用开发服务器</h1><p>开发服务器，即开发时使用，一般修改代码后会自动重启，方便调试和开发，但是由于性能问题，建议只用来测试，不要用在生产环境。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">python manage.py runserver</div><div class="line"> </div><div class="line"># 当提示端口被占用的时候，可以用其它端口：</div><div class="line">python manage.py runserver 8001</div><div class="line">python manage.py runserver 9999</div><div class="line">（当然也可以kill掉占用端口的进程，具体后面有讲，此处想知道的同学可查下 lsof 命令用法）</div><div class="line"> </div><div class="line"># 监听机器所有可用 ip （电脑可能有多个内网ip或多个外网ip）</div><div class="line">python manage.py runserver 0.0.0.0:8000</div><div class="line"># 如果是外网或者局域网电脑上可以用其它电脑查看开发服务器</div><div class="line"># 访问对应的 ip加端口，比如 http://172.16.20.2:8000</div></pre></td></tr></table></figure>
<h1 id="清空数据库"><a href="#清空数据库" class="headerlink" title="清空数据库"></a>清空数据库</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python manage.py flush</div></pre></td></tr></table></figure>
<p>此命令会询问是 yes 还是 no, 选择 yes 会把数据全部清空掉，只留下空表。</p>
<h1 id="创建超级管理员"><a href="#创建超级管理员" class="headerlink" title="创建超级管理员"></a>创建超级管理员</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">python manage.py createsuperuser</div><div class="line"># 按照提示输入用户名和对应的密码就好了邮箱可以留空，用户名和密码必填</div><div class="line"> </div><div class="line"># 修改 用户密码可以用：</div><div class="line">python manage.py changepassword username</div></pre></td></tr></table></figure>
<h1 id="导出数据-导入数据"><a href="#导出数据-导入数据" class="headerlink" title="导出数据 导入数据"></a>导出数据 导入数据</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">python manage.py dumpdata appname &gt; appname.json</div><div class="line">python manage.py loaddata appname.json</div></pre></td></tr></table></figure>
<p>关于数据操作 详见：数据导入数据迁移，现在了解有这个用法就可以了。</p>
<h1 id="Django-项目环境终端"><a href="#Django-项目环境终端" class="headerlink" title="Django 项目环境终端"></a>Django 项目环境终端</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">python manage.py shell</div><div class="line">如果你安装了 bpython 或 ipython 会自动用它们的界面，推荐安装 bpython。</div></pre></td></tr></table></figure>
<p>这个命令和 直接运行 python 或 bpython 进入 shell 的区别是：你可以在这个 shell 里面调用当前项目的 models.py 中的 API，对于操作数据，还有一些小测试非常方便。</p>
<h1 id="数据库命令行"><a href="#数据库命令行" class="headerlink" title="数据库命令行"></a>数据库命令行</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python manage.py dbshell</div></pre></td></tr></table></figure>
<p>Django 会自动进入在settings.py中设置的数据库，如果是 MySQL 或 postgreSQL,会要求输入数据库用户密码。</p>
<p>在这个终端可以执行数据库的SQL语句。如果您对SQL比较熟悉，可能喜欢这种方式。</p>
<h1 id="更多命令"><a href="#更多命令" class="headerlink" title="更多命令"></a>更多命令</h1><p>终端上输入 python manage.py 可以看到详细的列表，在忘记子名称的时候特别有用。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;本节主要是为了让您了解一些django最基本的命令，请尝试着记住它们，并且多多练习下，打开 Linux 或 MacOS 的 Terminal （终端）直接在 终端中输入这些命令（不是 python 的 shell中）&lt;/p&gt;
&lt;hr&gt;
    
    </summary>
    
      <category term="Django" scheme="http://feiyang.li/categories/Django/"/>
    
    
      <category term="教程" scheme="http://feiyang.li/tags/%E6%95%99%E7%A8%8B/"/>
    
      <category term="Django" scheme="http://feiyang.li/tags/Django/"/>
    
  </entry>
  
  <entry>
    <title>Machine Learning System Design</title>
    <link href="http://feiyang.li/2017/05/19/Machine-Learning-System-Design/index.html"/>
    <id>http://feiyang.li/2017/05/19/Machine-Learning-System-Design/index.html</id>
    <published>2017-05-19T10:53:03.000Z</published>
    <updated>2017-05-19T10:54:26.531Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><script src="/assets/js/DPlayer.min.js"> </script><blockquote>
<p>机器学习系统设计</p>
</blockquote>
<hr>
<a id="more"></a>
<h1 id="查准率-Precision-和查全率-Recall"><a href="#查准率-Precision-和查全率-Recall" class="headerlink" title="查准率(Precision)和查全率(Recall)"></a>查准率(Precision)和查全率(Recall)</h1><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170519/112809620.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<p>分为四种情况：</p>
<ul>
<li>正确肯定（True Positive<strong>TP</strong>）：预测为真，实际为真。</li>
<li>正确否定（True Negative <strong>TN</strong>）：预测为假，实际为假。</li>
<li>错误肯定（False Positive<strong>FP</strong>）：预测为真，实际为假。</li>
<li>错误否定（False Negative<strong>FN</strong>）：预测为假，实际为真。<h2 id="查准率"><a href="#查准率" class="headerlink" title="查准率"></a>查准率</h2>$$Precison=\dfrac{TP}{TP+FP}$$<br>在所有我们<strong>预测有恶性肿瘤的病人</strong>中，实际上有恶性肿瘤的病人百分比，越高越好。<h2 id="查全率"><a href="#查全率" class="headerlink" title="查全率"></a>查全率</h2>$$Recall=\dfrac{TP}{TP+FN}$$<br>在所有我们<strong>实际上有病的病人</strong>中，预测成功有恶性肿瘤的病人百分比，越高越好。</li>
</ul>
<h1 id="F1值"><a href="#F1值" class="headerlink" title="F1值"></a>F1值</h1><p>$$F_1=\dfrac{PR}{P+R}$$</p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;机器学习系统设计&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
    
    </summary>
    
      <category term="Coursera ML" scheme="http://feiyang.li/categories/Coursera-ML/"/>
    
    
      <category term="Machine Learning" scheme="http://feiyang.li/tags/Machine-Learning/"/>
    
      <category term="读书笔记" scheme="http://feiyang.li/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>coursera</title>
    <link href="http://feiyang.li/2017/05/18/coursera/index.html"/>
    <id>http://feiyang.li/2017/05/18/coursera/index.html</id>
    <published>2017-05-18T02:14:53.000Z</published>
    <updated>2017-05-18T02:17:37.001Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><script src="/assets/js/DPlayer.min.js"> </script><blockquote>
<p>关于coursera无法播放，原因其实很简单，就是视频所在服务器被GFW墙了。</p>
</blockquote>
<hr>
<a id="more"></a>
<p>有的时候，我真的会觉得，墙是不是太密了，使得我们不得不选择越过它。</p>
<p>常见的方法是，我们使用一个在墙外的服务器，他可以帮助我们将coursera的流量通过服务器重新转发，然后再原路返回，避过GFW。</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170518/101006060.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="mark" title="">
                </div>
                <div class="image-caption">mark</div>
            </figure>
<p>因此，首先要获得服务器端口以及相应的密码，这样服务器才可以帮你转发流量。我自己因为也在coursera看视频，所以自己搭建了一个服务器，分享给大家。<a href="https://ss.feiyang.li/" target="_blank" rel="external">https://ss.feiyang.li/</a></p>
<p>这里我分别举例展示如何快速观看coursera视频。</p>
<p>–</p>
<h1 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h1><h2 id="ss"><a href="#ss" class="headerlink" title="ss"></a>ss</h2><p><a href="http://home.ustc.edu.cn/~mmmwhy/Shadowsocks.exe" target="_blank" rel="external">http://home.ustc.edu.cn/~mmmwhy/Shadowsocks.exe</a></p>
<ul>
<li>在任务栏找到 Shadowsocks 图标</li>
<li>在 服务器 -&gt; 编辑服务器-&gt; 输入在网站内获得的服务器信息</li>
<li>选择 启用系统代理 来启用系统代理。请禁用浏览器里的代理插件，或把它们设置为使用系统代理。<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170515/104128278.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<h2 id="ssr"><a href="#ssr" class="headerlink" title="ssr"></a>ssr</h2><a href="http://home.ustc.edu.cn/~mmmwhy/ShadowsocksR-dotnet4.0.exe" target="_blank" rel="external">http://home.ustc.edu.cn/~mmmwhy/ShadowsocksR-dotnet4.0.exe</a><br>右键 纸飞机 -&gt; 扫描二维码 -&gt;  开启系统代理选择 -&gt;pac模式或者全局模式<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170515/104039212.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
</li>
</ul>
<p>当然直接使用二维码扫描会更方便，如果遇到某个节点不能使用，可以换一个，因为本地运营商可能会把某些ip墙掉。</p>
<h1 id="Mac-OS-X"><a href="#Mac-OS-X" class="headerlink" title="Mac OS X"></a>Mac OS X</h1><p><a href="https://github.com/shadowsocks/ShadowsocksX-NG/releases" target="_blank" rel="external">https://github.com/shadowsocks/ShadowsocksX-NG/releases</a><br>OS X 下设置使用方法<br>Mac 下使用极其方便，因为 GUI 已经集成了系统 Pac，所以无需设置任何科学上网的姿势，直接运行 ShadowsocksX ，然后输入服务商提供给你的账号信息，保存运行后，即可在所有浏览器里直接科学上网，如图：<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170515/105527529.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure><br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170515/105543198.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure></p>
<h1 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h1><p><a href="https://github.com/shadowsocks/shadowsocks-qt5/wiki/Installation" target="_blank" rel="external">https://github.com/shadowsocks/shadowsocks-qt5/wiki/Installation</a></p>
<h1 id="Android"><a href="#Android" class="headerlink" title="Android"></a>Android</h1><p><a href="http://cdn.mmmxcc.cn/ssr_3.0.2.2.apk" target="_blank" rel="external">ssr</a><br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170505/143305745.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure><br>扫描二维码-&gt; 然后点小飞机就可以了</p>
<h1 id="iOS"><a href="#iOS" class="headerlink" title="iOS"></a>iOS</h1><p><a href="https://itunes.apple.com/cn/app/ssrconnect-proxy-utility/id1161221960?mt=8" target="_blank" rel="external">SsrConnect - Proxy Utility</a> 免费<br><a href="https://itunes.apple.com/us/app/alice-network-proxy-utility/id1135320992?mt=8" target="_blank" rel="external">Network Proxy Utility</a> 免费<br><a href="https://itunes.apple.com/cn/app/shadowrocket/id932747118?mt=8" target="_blank" rel="external">Shadowrocket</a> 付费<br><a href="https://itunes.apple.com/app/apple-store/id1070901416?mt=8" target="_blank" rel="external">土豆丝</a> 付费</p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;关于coursera无法播放，原因其实很简单，就是视频所在服务器被GFW墙了。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
    
    </summary>
    
      <category term="shadowsocks" scheme="http://feiyang.li/categories/shadowsocks/"/>
    
    
      <category term="GFW" scheme="http://feiyang.li/tags/GFW/"/>
    
  </entry>
  
  <entry>
    <title>Coursera ML(11)-Programming Exercise 5 机器学习诊断法</title>
    <link href="http://feiyang.li/2017/05/17/Coursera-ML-11-Programming-Exercise-5/index.html"/>
    <id>http://feiyang.li/2017/05/17/Coursera-ML-11-Programming-Exercise-5/index.html</id>
    <published>2017-05-17T05:37:09.000Z</published>
    <updated>2017-05-17T06:22:10.492Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><script src="/assets/js/DPlayer.min.js"> </script><blockquote>
<p>对应 <a href="http://feiyang.li/2017/05/11/Coursera-ML-10-Evaluating-a-Hypothesis/index.html">机器学习诊断法</a></p>
</blockquote>
<hr>
<a id="more"></a>
<h1 id="复习内容"><a href="#复习内容" class="headerlink" title="复习内容"></a>复习内容</h1><h2 id="Regularized-linear-regression-cost-function"><a href="#Regularized-linear-regression-cost-function" class="headerlink" title="Regularized linear regression cost function"></a>Regularized linear regression cost function</h2><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170517/104444345.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<p>对应matlab代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">J = 1/(2*m)*sum((X*theta - y).^2) ;</div><div class="line">regularize =  lambda /(2*m)* (sum(theta.^2)-theta(1).^2);</div><div class="line">J = J + regularize;</div></pre></td></tr></table></figure></p>
<h2 id="Regularized-linear-regression-gradient"><a href="#Regularized-linear-regression-gradient" class="headerlink" title="Regularized linear regression gradient"></a>Regularized linear regression gradient</h2><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170517/105630413.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<p>如果对这里有疑惑，这个部分也有相应的推导过程：<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170325/182301586.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure><br>梯度对应代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">n = size(theta);</div><div class="line">for i=1:n</div><div class="line">    grad(i) = 1/m * sum((X*theta - y).*X(:,i)) + lambda/m *theta(i);</div><div class="line">end</div><div class="line">grad(1) = 1/m * sum((X*theta - y).^X(:,1));</div></pre></td></tr></table></figure></p>
<h2 id="Learning-curves"><a href="#Learning-curves" class="headerlink" title="Learning curves"></a>Learning curves</h2><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170511/101154504.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<h2 id="Polynomial-regression"><a href="#Polynomial-regression" class="headerlink" title="Polynomial regression"></a>Polynomial regression</h2><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170517/132450490.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<h1 id="Programming-Exercise-5-Regularized-Linear-Regression-and-Bias-v-s-Variance"><a href="#Programming-Exercise-5-Regularized-Linear-Regression-and-Bias-v-s-Variance" class="headerlink" title="Programming Exercise 5 - Regularized Linear Regression and Bias v.s. Variance"></a>Programming Exercise 5 - Regularized Linear Regression and Bias v.s. Variance</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># %load ../../../standard_import.txt</span></div><div class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</div><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"><span class="keyword">import</span> matplotlib <span class="keyword">as</span> mpl</div><div class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</div><div class="line"></div><div class="line"><span class="keyword">from</span> scipy.io <span class="keyword">import</span> loadmat</div><div class="line"><span class="keyword">from</span> scipy.optimize <span class="keyword">import</span> minimize</div><div class="line"></div><div class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LinearRegression, Ridge</div><div class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> PolynomialFeatures</div><div class="line"></div><div class="line">pd.set_option(<span class="string">'display.notebook_repr_html'</span>, <span class="keyword">False</span>)</div><div class="line">pd.set_option(<span class="string">'display.max_columns'</span>, <span class="keyword">None</span>)</div><div class="line">pd.set_option(<span class="string">'display.max_rows'</span>, <span class="number">150</span>)</div><div class="line">pd.set_option(<span class="string">'display.max_seq_items'</span>, <span class="keyword">None</span>)</div><div class="line"> </div><div class="line"><span class="comment">#%config InlineBackend.figure_formats = &#123;'pdf',&#125;</span></div><div class="line">%matplotlib inline</div><div class="line"></div><div class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</div><div class="line">sns.set_context(<span class="string">'notebook'</span>)</div><div class="line">sns.set_style(<span class="string">'white'</span>)</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">data = loadmat(<span class="string">'data/ex5data1.mat'</span>)</div><div class="line">data.keys()</div></pre></td></tr></table></figure>
<pre><code>dict_keys([&apos;__header__&apos;, &apos;__version__&apos;, &apos;__globals__&apos;, &apos;X&apos;, &apos;y&apos;, &apos;Xtest&apos;, &apos;ytest&apos;, &apos;Xval&apos;, &apos;yval&apos;])
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">y_train = data[<span class="string">'y'</span>]</div><div class="line">X_train = np.c_[np.ones_like(data[<span class="string">'X'</span>]), data[<span class="string">'X'</span>]]</div><div class="line"></div><div class="line">yval = data[<span class="string">'yval'</span>]</div><div class="line">Xval = np.c_[np.ones_like(data[<span class="string">'Xval'</span>]), data[<span class="string">'Xval'</span>]]</div><div class="line"></div><div class="line"></div><div class="line">print(<span class="string">'X_train:'</span>, X_train.shape)</div><div class="line">print(<span class="string">'y_train:'</span>, y_train.shape)</div><div class="line">print(<span class="string">'Xval:'</span>, Xval.shape)</div><div class="line">print(<span class="string">'yval:'</span>, yval.shape)</div></pre></td></tr></table></figure>
<pre><code>X_train: (12, 2)
y_train: (12, 1)
Xval: (21, 2)
yval: (21, 1)
</code></pre><h2 id="Regularized-Linear-Regression"><a href="#Regularized-Linear-Regression" class="headerlink" title="Regularized Linear Regression"></a>Regularized Linear Regression</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">plt.scatter(X_train[:,<span class="number">1</span>], y_train, s=<span class="number">50</span>, c=<span class="string">'r'</span>, marker=<span class="string">'x'</span>, linewidths=<span class="number">1</span>)</div><div class="line">plt.xlabel(<span class="string">'Change in water level (x)'</span>)</div><div class="line">plt.ylabel(<span class="string">'Water flowing out of the dam (y)'</span>)</div><div class="line">plt.ylim(ymin=<span class="number">0</span>);</div></pre></td></tr></table></figure>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170517/133552305.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<p>###Regularized Cost function</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">linearRegCostFunction</span><span class="params">(theta, X, y, reg)</span>:</span></div><div class="line">    m = y.size</div><div class="line">    </div><div class="line">    h = X.dot(theta)</div><div class="line">    </div><div class="line">    J = (<span class="number">1</span>/(<span class="number">2</span>*m))*np.sum(np.square(h-y)) + (reg/(<span class="number">2</span>*m))*np.sum(np.square(theta[<span class="number">1</span>:]))</div><div class="line">   </div><div class="line">    <span class="keyword">return</span>(J)</div></pre></td></tr></table></figure>
<h3 id="Gradient"><a href="#Gradient" class="headerlink" title="Gradient"></a>Gradient</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">lrgradientReg</span><span class="params">(theta, X, y, reg)</span>:</span></div><div class="line">    m = y.size</div><div class="line">    </div><div class="line">    h = X.dot(theta.reshape(<span class="number">-1</span>,<span class="number">1</span>))</div><div class="line">        </div><div class="line">    grad = (<span class="number">1</span>/m)*(X.T.dot(h-y))+ (reg/m)*np.r_[[[<span class="number">0</span>]],theta[<span class="number">1</span>:].reshape(<span class="number">-1</span>,<span class="number">1</span>)]</div><div class="line">        </div><div class="line">    <span class="keyword">return</span>(grad.flatten())</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">initial_theta = np.ones((X_train.shape[<span class="number">1</span>],<span class="number">1</span>))</div><div class="line">cost = linearRegCostFunction(initial_theta, X_train, y_train, <span class="number">0</span>)</div><div class="line">gradient = lrgradientReg(initial_theta, X_train, y_train, <span class="number">0</span>)</div><div class="line">print(cost)</div><div class="line">print(gradient)</div></pre></td></tr></table></figure>
<pre><code>303.951525554
[ -15.30301567  598.16741084]
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">trainLinearReg</span><span class="params">(X, y, reg)</span>:</span></div><div class="line">    <span class="comment">#initial_theta = np.zeros((X.shape[1],1))</span></div><div class="line">    initial_theta = np.array([[<span class="number">15</span>],[<span class="number">15</span>]])</div><div class="line">    <span class="comment"># For some reason the minimize() function does not converge when using</span></div><div class="line">    <span class="comment"># zeros as initial theta.</span></div><div class="line">        </div><div class="line">    res = minimize(linearRegCostFunction, initial_theta, args=(X,y,reg), method=<span class="keyword">None</span>, jac=lrgradientReg,</div><div class="line">                   options=&#123;<span class="string">'maxiter'</span>:<span class="number">5000</span>&#125;)</div><div class="line">    </div><div class="line">    <span class="keyword">return</span>(res)</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">fit = trainLinearReg(X_train, y_train, <span class="number">0</span>)</div><div class="line">fit</div></pre></td></tr></table></figure>
<pre><code>     fun: 1604.4002999186634
hess_inv: array([[ 1.03142187,  0.00617881],
      [ 0.00617881,  0.001215  ]])
     jac: array([  3.42437190e-12,  -5.70371898e-10])
 message: &apos;Optimization terminated successfully.&apos;
    nfev: 6
     nit: 4
    njev: 6
  status: 0
 success: True
       x: array([ 13.08790351,   0.36777923])
</code></pre><h3 id="Comparison-coefficients-and-cost-obtained-with-LinearRegression-in-Scikit-learn"><a href="#Comparison-coefficients-and-cost-obtained-with-LinearRegression-in-Scikit-learn" class="headerlink" title="Comparison: coefficients and cost obtained with LinearRegression in Scikit-learn"></a>Comparison: coefficients and cost obtained with LinearRegression in Scikit-learn</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">regr = LinearRegression(fit_intercept=<span class="keyword">False</span>)</div><div class="line">regr.fit(X_train, y_train.ravel())</div><div class="line">print(regr.coef_)</div><div class="line">print(linearRegCostFunction(regr.coef_, X_train, y_train, <span class="number">0</span>))</div></pre></td></tr></table></figure>
<pre><code>[ 13.08790351   0.36777923]
1604.40029992
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">plt.plot(np.linspace(<span class="number">-50</span>,<span class="number">40</span>), (fit.x[<span class="number">0</span>]+ (fit.x[<span class="number">1</span>]*np.linspace(<span class="number">-50</span>,<span class="number">40</span>))), label=<span class="string">'Scipy optimize'</span>)</div><div class="line"><span class="comment">#plt.plot(np.linspace(-50,40), (regr.coef_[0]+ (regr.coef_[1]*np.linspace(-50,40))), label='Scikit-learn')</span></div><div class="line">plt.scatter(X_train[:,<span class="number">1</span>], y_train, s=<span class="number">50</span>, c=<span class="string">'r'</span>, marker=<span class="string">'x'</span>, linewidths=<span class="number">1</span>)</div><div class="line">plt.xlabel(<span class="string">'Change in water level (x)'</span>)</div><div class="line">plt.ylabel(<span class="string">'Water flowing out of the dam (y)'</span>)</div><div class="line">plt.ylim(ymin=<span class="number">-5</span>)</div><div class="line">plt.xlim(xmin=<span class="number">-50</span>)</div><div class="line">plt.legend(loc=<span class="number">4</span>);</div></pre></td></tr></table></figure>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170517/133621870.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">learningCurve</span><span class="params">(X, y, Xval, yval, reg)</span>:</span></div><div class="line">    m = y.size</div><div class="line">    </div><div class="line">    error_train = np.zeros((m, <span class="number">1</span>))</div><div class="line">    error_val = np.zeros((m, <span class="number">1</span>))</div><div class="line">    </div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> np.arange(m):</div><div class="line">        res = trainLinearReg(X[:i+<span class="number">1</span>], y[:i+<span class="number">1</span>], reg)</div><div class="line">        error_train[i] = linearRegCostFunction(res.x, X[:i+<span class="number">1</span>], y[:i+<span class="number">1</span>], reg)</div><div class="line">        error_val[i] = linearRegCostFunction(res.x, Xval, yval, reg)</div><div class="line">    </div><div class="line">    <span class="keyword">return</span>(error_train, error_val)</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">t_error, v_error = learningCurve(X_train, y_train, Xval, yval, <span class="number">0</span>)</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">plt.plot(np.arange(<span class="number">1</span>,<span class="number">13</span>), t_error, label=<span class="string">'Training error'</span>)</div><div class="line">plt.plot(np.arange(<span class="number">1</span>,<span class="number">13</span>), v_error, label=<span class="string">'Validation error'</span>)</div><div class="line">plt.title(<span class="string">'Learning curve for linear regression'</span>)</div><div class="line">plt.xlabel(<span class="string">'Number of training examples'</span>)</div><div class="line">plt.ylabel(<span class="string">'Error'</span>)</div><div class="line">plt.legend();</div></pre></td></tr></table></figure>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170517/133630516.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<h3 id="Polynomial-regression-Scikit-learn"><a href="#Polynomial-regression-Scikit-learn" class="headerlink" title="Polynomial regression (Scikit-learn)"></a>Polynomial regression (Scikit-learn)</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">poly = PolynomialFeatures(degree=<span class="number">8</span>)</div><div class="line">X_train_poly = poly.fit_transform(X_train[:,<span class="number">1</span>].reshape(<span class="number">-1</span>,<span class="number">1</span>))</div><div class="line"></div><div class="line">regr2 = LinearRegression()</div><div class="line">regr2.fit(X_train_poly, y_train)</div><div class="line"></div><div class="line">regr3 = Ridge(alpha=<span class="number">20</span>)</div><div class="line">regr3.fit(X_train_poly, y_train)</div><div class="line"></div><div class="line"><span class="comment"># plot range for x</span></div><div class="line">plot_x = np.linspace(<span class="number">-60</span>,<span class="number">45</span>)</div><div class="line"><span class="comment"># using coefficients to calculate y</span></div><div class="line">plot_y = regr2.intercept_+ np.sum(regr2.coef_*poly.fit_transform(plot_x.reshape(<span class="number">-1</span>,<span class="number">1</span>)), axis=<span class="number">1</span>)</div><div class="line">plot_y2 = regr3.intercept_ + np.sum(regr3.coef_*poly.fit_transform(plot_x.reshape(<span class="number">-1</span>,<span class="number">1</span>)), axis=<span class="number">1</span>)</div><div class="line"></div><div class="line">plt.plot(plot_x, plot_y, label=<span class="string">'Scikit-learn LinearRegression'</span>)</div><div class="line">plt.plot(plot_x, plot_y2, label=<span class="string">'Scikit-learn Ridge (alpha=&#123;&#125;)'</span>.format(regr3.alpha))</div><div class="line">plt.scatter(X_train[:,<span class="number">1</span>], y_train, s=<span class="number">50</span>, c=<span class="string">'r'</span>, marker=<span class="string">'x'</span>, linewidths=<span class="number">1</span>)</div><div class="line">plt.xlabel(<span class="string">'Change in water level (x)'</span>)</div><div class="line">plt.ylabel(<span class="string">'Water flowing out of the dam (y)'</span>)</div><div class="line">plt.title(<span class="string">'Polynomial regression degree 8'</span>)</div><div class="line">plt.legend(loc=<span class="number">4</span>);</div></pre></td></tr></table></figure>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170517/133642078.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;对应 &lt;a href=&quot;http://feiyang.li/2017/05/11/Coursera-ML-10-Evaluating-a-Hypothesis/index.html&quot;&gt;机器学习诊断法&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
    
    </summary>
    
      <category term="Coursera ML" scheme="http://feiyang.li/categories/Coursera-ML/"/>
    
    
      <category term="Python" scheme="http://feiyang.li/tags/Python/"/>
    
      <category term="Machine Learning" scheme="http://feiyang.li/tags/Machine-Learning/"/>
    
      <category term="读书笔记" scheme="http://feiyang.li/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>数据库操作</title>
    <link href="http://feiyang.li/2017/05/16/databases/index.html"/>
    <id>http://feiyang.li/2017/05/16/databases/index.html</id>
    <published>2017-05-16T10:38:00.000Z</published>
    <updated>2017-05-16T10:38:57.468Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><script src="/assets/js/DPlayer.min.js"> </script><blockquote>
<p>其实之前学过数据库相关操作，只不过许久不用就忘了。真是年纪大了呀。</p>
</blockquote>
<hr>
<a id="more"></a>
<ul>
<li><p>创建数据库：<code>create database books;</code></p>
</li>
<li><p>使用数据库：<code>use dbname;</code></p>
</li>
</ul>
<ul>
<li>新建数据库表<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">create table tablename(columns);</div><div class="line">create table demo(</div><div class="line">     userid int unsigned not null auto_increment primary key,</div><div class="line">     username char(50) not null,</div><div class="line">     password char(20) not null,</div><div class="line">     age int not null,</div><div class="line">     city char(20) not null     </div><div class="line">);</div></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><p>显示数据库表：<code>show tables;</code></p>
</li>
<li><p>在数据库中插入数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">INSERT INTO `jobcategory` VALUES(11,&quot;丸剂&quot;);</div><div class="line">INSERT INTO wan (JobCategoryID,JobCategoryName) SELECT ID,MingCheng FROM `zysjyj` WHERE MingCheng LIKE  &quot;%丸&quot;;</div></pre></td></tr></table></figure>
</li>
<li><p>查询数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">SELECT ID,MingCheng FROM `zysjyj` WHERE MingCheng LIKE  &quot;%丸&quot;;</div></pre></td></tr></table></figure>
</li>
<li><p>更新数据：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">UPDATE `zysjyj` SET ID=(1100000+ID) WHERE MingCheng LIKE &apos;%丸&apos;;</div></pre></td></tr></table></figure>
</li>
<li><p>删除数据：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">DELETE FROM `nzysys`.`jobintroduction`;</div></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li>表的删除：<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">DROP TABLE table;</div></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><p>数据删除：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">DROP DATABASE database;`</div></pre></td></tr></table></figure>
</li>
<li><p>通过<strong>SELECT</strong>来<strong>INSERT</strong>：<br>先创建新表，然后插入</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">CREATE TABLE wan(JobCategoryID INT(20) NOT NULL AUTO_INCREMENT,PRIMARY KEY (JobCategoryID),parentID INT(20) NOT NULL DEFAULT &apos;10&apos; ,JobCategoryName VARCHAR(128)  NOT NULL);  </div><div class="line"></div><div class="line">INSERT INTO wan (JobCategoryID,JobCategoryName) SELECT ID,MingCheng FROM `zysjyj` WHERE MingCheng LIKE  &quot;%丸&quot;;</div></pre></td></tr></table></figure>
<ul>
<li><p>跨数据库插入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">INSERT `nzysys`.`subjobcategory` SELECT * FROM `chinese-drug`.`wan`;</div></pre></td></tr></table></figure>
</li>
<li><p>用<code>select</code>来<code>create</code>，并指定默认值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">INSERT INTO `nzysys`.`subjobcategory`(JobCategoryID,parentID,JobCategoryName)SELECT ID,10,MingCheng FROM `chinese-drug`.`zysjyj` WHERE MingCheng LIKE &quot;%散&quot;;</div></pre></td></tr></table></figure>
</li>
<li><p>叠加使用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">SELECT ID,MingCheng FROM `chinese-drug`.`zysjyj` WHERE MingCheng LIKE &quot;%散&quot;;</div><div class="line">UPDATE `chinese-drug`.`zysjyj` SET ID=(1000000+ID) WHERE MingCheng LIKE &quot;%散&quot;;</div><div class="line">INSERT INTO `nzysys`.`subjobcategory`(JobCategoryID,parentID,JobCategoryName)SELECT ID,10,MingCheng FROM `chinese-drug`.`zysjyj` WHERE MingCheng LIKE &quot;%散&quot;;</div></pre></td></tr></table></figure>
</li>
<li><p>自增ID归零 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">TRUNCATE TABLE `nzysys`.`jobintroduction`;</div></pre></td></tr></table></figure>
</li>
<li><p>交叉</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">INSERT INTO `nzysys`.`jobintroduction` (jobCategoryID,introductionValue,introductionkey,introductionID) SELECT b.jobCategoryID,a.ChuFang,&apos;组成&apos;,1 FROM `nzysys`.`subjobcategory` AS b,`chinese-drug`.`zysjyj` AS a WHERE a.`ID`=b.`JobCategoryID`;</div></pre></td></tr></table></figure></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;其实之前学过数据库相关操作，只不过许久不用就忘了。真是年纪大了呀。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
    
    </summary>
    
    
      <category term="databases" scheme="http://feiyang.li/tags/databases/"/>
    
  </entry>
  
  <entry>
    <title>免费vps get!</title>
    <link href="http://feiyang.li/2017/05/15/free-vps/index.html"/>
    <id>http://feiyang.li/2017/05/15/free-vps/index.html</id>
    <published>2017-05-15T12:13:05.000Z</published>
    <updated>2017-05-15T12:13:29.549Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><script src="/assets/js/DPlayer.min.js"> </script><blockquote>
<p>早就听说WisHosting 长期免费vps，码农买vps就像女人买衣服一样，虽然没什么用，但是会上瘾。</p>
</blockquote>
<hr>
<a id="more"></a>
<h1 id="要求"><a href="#要求" class="headerlink" title="要求"></a>要求</h1><p><a href="https://www.wishosting.com/plugin/support_manager/knowledgebase/view/14/how-to-get-openvz-mini-for-free/" target="_blank" rel="external">官网链接</a></p>
<p>How to get OpenVZ Mini for free?<br>If you want to grab free VPS (OpenVZ Mini package) free of charge, here is the list of requirements you should meet:<br>1) The domain from <strong>non-free domain zone</strong> (for example .com)<br>2) The link to <a href="https://www.wishosting.com/" target="_blank" rel="external">https://www.wishosting.com/</a> on your domain index page.<br>3) Your website should have some real content (5+ pages) and it should be indexed by search engines.<br>4) The service will be active as long as you keep the backlink on your website.</p>
<p>Please open a support ticket if you meet those requirements or send an e-mail to support@wishosting.com</p>
<h1 id="动手"><a href="#动手" class="headerlink" title="动手"></a>动手</h1><ul>
<li><p>注册并下单，不需要支付</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170515/195827250.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
</li>
<li><p>发工单询问商家，按照沟通步骤来即可</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170515/200957854.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
</li>
</ul>
<hr>
<p>表示已经申请到了，所以，应该不是很难申请的，有兴趣可以去玩一下。</p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;早就听说WisHosting 长期免费vps，码农买vps就像女人买衣服一样，虽然没什么用，但是会上瘾。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
    
    </summary>
    
    
      <category term="vps" scheme="http://feiyang.li/tags/vps/"/>
    
      <category term="free" scheme="http://feiyang.li/tags/free/"/>
    
  </entry>
  
  <entry>
    <title>shadowsocks-manager一键安装脚本</title>
    <link href="http://feiyang.li/2017/05/14/ss-mgr/index.html"/>
    <id>http://feiyang.li/2017/05/14/ss-mgr/index.html</id>
    <published>2017-05-14T03:58:57.000Z</published>
    <updated>2017-05-20T01:23:52.118Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><script src="/assets/js/DPlayer.min.js"> </script><blockquote>
<p>shadowsocks-manager是一个非常帅气的ss多用户管理程序，搭建起来稍微有点麻烦，因此写了本一键脚本。示例网站：<a href="http://gz.feiyang.li/" target="_blank" rel="external">http://gz.feiyang.li/</a></p>
</blockquote>
<hr>
<a id="more"></a>
<p>我看了一下数据，大概70%的人会一次性安装成功，其余人大多卡在npm依赖安装不全的问题上；<br>请注意：<br>1、内存1g以下的vps，极有可能内存过小，导致依赖被kill掉。<br>2、网络问题，请多次安装npm。<br>如果实在解决不了，建议就不要用这个管理界面，这个管理界面的要求的确有点高，请理解。</p>
<h1 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h1><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170513/135344468.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170513/135349156.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170513/135357497.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170513/140400232.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<p>github： <a href="https://github.com/mmmwhy/ss-mgr" target="_blank" rel="external">https://github.com/mmmwhy/ss-mgr</a></p>
<h1 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h1><ul>
<li>非常帅气，各种图表一上，是不是很牛逼的感觉。</li>
<li>支持支付宝付款对账，站长们多出来的vps可以不用再继续吃灰了。</li>
</ul>
<h1 id="要求"><a href="#要求" class="headerlink" title="要求"></a>要求</h1><p>centos7 X64，在腾讯云，digitialocean,interserver,ethernetservers通过测试。<br>其他版本还没有测试，理论上可用。</p>
<h1 id="安装脚本"><a href="#安装脚本" class="headerlink" title="安装脚本"></a>安装脚本</h1><h2 id="安装ss-mgr"><a href="#安装ss-mgr" class="headerlink" title="安装ss-mgr"></a>安装ss-mgr</h2><p>本脚本包括主控端和节点端，安装时，自动添加本vps作为一个节点。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">wget -N --no-check-certificate https://raw.githubusercontent.com/mmmwhy/ss-mgr/master/sm.sh &amp;&amp; chmod +x sm.sh &amp;&amp; bash sm.sh</div></pre></td></tr></table></figure></p>
<p>坐等就可以了，没有什么需要做的东西。<br>打开ip地址，就可以看到ss-mgr了。</p>
<h2 id="增加节点"><a href="#增加节点" class="headerlink" title="增加节点"></a>增加节点</h2><p>本脚本为：已有<strong>vps安装好主控端</strong>，添加新节点时，在<strong>新节点</strong>使用的脚本。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">wget -N --no-check-certificate https://raw.githubusercontent.com/mmmwhy/ss-mgr/master/sm_node.sh &amp;&amp; chmod +x sm_node.sh &amp;&amp; bash sm_node.sh</div></pre></td></tr></table></figure></p>
<ul>
<li>输入密码<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170514/135830856.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure></li>
<li>前端页面填入，刚才的密码，选择加密方式。<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170514/140131877.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
</li>
</ul>
<h1 id="docker方法"><a href="#docker方法" class="headerlink" title="docker方法"></a>docker方法</h1><h1 id="备注"><a href="#备注" class="headerlink" title="备注"></a>备注</h1><ul>
<li>注册的第一个用户就是管理员.</li>
<li>注册第二个账号，可以看到自己的剩余时间，一般来说是8个小时。可以点击续费，选择任意一个额度，支付后，可以看到时间会增长。</li>
<li>默认使用hotmail邮箱，因为邮箱在国外，所以如果服务器在国内的话，可能会timeout。</li>
<li>某些系统内核版本过老，因此可能会出现如下症状，按回车就可以了。<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170513/135239354.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure></li>
<li>被墙掉的资源都换成国内的了。</li>
<li>三条重要命令<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">screen -dmS ss-manager ss-manager -m aes-256-cfb -u --manager-address 127.0.0.1:4000</div><div class="line">cd /root/shadowsocks-manager/</div><div class="line">screen -dmS ss node server.js -c /root/.ssmgr/ss.yml</div><div class="line">screen -dmS webgui node server.js -c /root/.ssmgr/webgui.yml</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="修改页面"><a href="#修改页面" class="headerlink" title="修改页面"></a>修改页面</h2><p>修改过文本后，使用<code>npm run build</code>重新生成页面。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">screen -dmS webgui node server.js -c /root/.ssmgr/webgui.yml</div></pre></td></tr></table></figure></p>
<h2 id="一键BBR脚本"><a href="#一键BBR脚本" class="headerlink" title="一键BBR脚本"></a>一键BBR脚本</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">wget --no-check-certificate https://github.com/teddysun/across/raw/master/bbr.sh</div><div class="line">chmod +x bbr.sh</div><div class="line">./bbr.sh</div></pre></td></tr></table></figure>
<h2 id="增加虚拟内存"><a href="#增加虚拟内存" class="headerlink" title="增加虚拟内存"></a>增加虚拟内存</h2><p><strong>增加swap交换文件</strong></p>
<ul>
<li>使用dd命令创建一个swap交换文件<br><code>dd if=/dev/zero of=/home/swap bs=1024 count=1024000</code><br>这样就建立一个/home/swap的分区文件，大小为1G。</li>
<li>制作为swap格式文件：<br><code>mkswap /home/swap</code></li>
<li>再用swapon命令把这个文件分区挂载swap分区<br><code>/sbin/swapon /home/swap</code><br>我们用free -m命令看一下，发现已经有交换分区了。但是重启系统后，swap分区又变成0了。</li>
<li>为防止重启后swap分区变成0，要修改/etc/fstab文件<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">vi /etc/fstab</div></pre></td></tr></table></figure>
</li>
</ul>
<p>在文件末尾（最后一行）加上<br><code>/home/swap swap swap default 0 0</code><br>这样就算重启系统，swap分区还是有值。</p>
<ul>
<li>查看空间：<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">free -m</div></pre></td></tr></table></figure>
</li>
</ul>
<hr>
<p>因为本工具较难配置，因此如果有问题的话，可以通过tg联系我。<a href="https://t.me/mmmwhy" target="_blank" rel="external">https://t.me/mmmwhy</a></p>
<hr>
<p>参考以下链接：<br><a href="http://blog.csdn.net/lengyue1084/article/details/51405640" target="_blank" rel="external">http://blog.csdn.net/lengyue1084/article/details/51405640</a><br><a href="https://code.momok.xyz/server/deploy-ss-manager.html" target="_blank" rel="external">https://code.momok.xyz/server/deploy-ss-manager.html</a><br><a href="https://github.com/shadowsocks/shadowsocks-manager" target="_blank" rel="external">https://github.com/shadowsocks/shadowsocks-manager</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;shadowsocks-manager是一个非常帅气的ss多用户管理程序，搭建起来稍微有点麻烦，因此写了本一键脚本。示例网站：&lt;a href=&quot;http://gz.feiyang.li/&quot;&gt;http://gz.feiyang.li/&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
    
    </summary>
    
      <category term="shadowsocks" scheme="http://feiyang.li/categories/shadowsocks/"/>
    
    
      <category term="GFW" scheme="http://feiyang.li/tags/GFW/"/>
    
      <category term="Linux" scheme="http://feiyang.li/tags/Linux/"/>
    
      <category term="教程" scheme="http://feiyang.li/tags/%E6%95%99%E7%A8%8B/"/>
    
      <category term="vps" scheme="http://feiyang.li/tags/vps/"/>
    
      <category term="shell" scheme="http://feiyang.li/tags/shell/"/>
    
  </entry>
  
  <entry>
    <title>Coursera ML(10)-机器学习诊断法</title>
    <link href="http://feiyang.li/2017/05/11/Coursera-ML-10-Evaluating-a-Hypothesis/index.html"/>
    <id>http://feiyang.li/2017/05/11/Coursera-ML-10-Evaluating-a-Hypothesis/index.html</id>
    <published>2017-05-11T04:28:16.000Z</published>
    <updated>2017-05-11T04:34:51.020Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><script src="/assets/js/DPlayer.min.js"> </script><blockquote>
<p>假设你在开发一个机器学习系统，或者在改进一个机器学习系统的性能，应如何做？</p>
</blockquote>
<hr>
<a id="more"></a>
<h1 id="目前已有的方法："><a href="#目前已有的方法：" class="headerlink" title="目前已有的方法："></a>目前已有的方法：</h1><ul>
<li>Getting more training examples</li>
<li>Trying smaller sets of features</li>
<li>Trying additional features</li>
<li>Trying polynomial features</li>
<li>Increasing or decreasing λ</li>
</ul>
<p>每种方法都有自己不同的应用场景</p>
<h1 id="Evaluating-a-Hypothesis"><a href="#Evaluating-a-Hypothesis" class="headerlink" title="Evaluating a Hypothesis"></a>Evaluating a Hypothesis</h1><p>根据测试集得到参数，对训练集运用模型。有两种误差计算方法</p>
<ul>
<li><p>For linear regression: </p>
 $$J_{test}(\Theta) = \dfrac{1}{2m_{test}} \sum_{i=1}^{m_{test}}(h_\Theta(x^{(i)}_{test}) - y^{(i)}_{test})^2$$ 
</li>
<li><p>For classification :<br>误分类的比例，对于每一个测试实例，计算：</p>
 $$err(h_\Theta(x),y) = \begin{matrix} 1 & \mbox{if } h_\Theta(x) \geq 0.5\ and\ y = 0\ or\ h_\Theta(x) < 0.5\ and\ y = 1\newline 0 & \mbox otherwise \end{matrix}$$
然后急死俺平均
$$\text{Test Error} = \dfrac{1}{m_{test}} \sum^{m_{test}}_{i=1} err(h_\Theta(x^{(i)}_{test}), y^{(i)}_{test})$$ 
</li>
</ul>
<h1 id="Model-Selection-and-Train-Validation-Test-Sets-交叉验证机"><a href="#Model-Selection-and-Train-Validation-Test-Sets-交叉验证机" class="headerlink" title="Model Selection and Train/Validation/Test Sets(交叉验证机)"></a>Model Selection and Train/Validation/Test Sets(交叉验证机)</h1><p>使用60%的数据作为训练集，20%的数据作为交叉验证集，20%的数据作为测试集<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170511/101002408.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure></p>
<ul>
<li>Optimize the parameters in Θ using the training set for each polynomial degree.</li>
<li>Find the polynomial degree d with the least error using the cross validation set.</li>
<li>Estimate the generalization error using the test set with $J_{test}(\Theta^{(d)})$, (d = theta from polynomial with lower error);<br>简单来讲：<br>训练集训练出 10 个模型 -&gt;10 个模型分别对交叉验证集计算得出交叉验证误差（代价函数的值）-&gt;选取代价函数值最小的模型-&gt;用选出的模型对测试集计算得出推广误差（代价函数的值）<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170511/101154504.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
</li>
</ul>
<h1 id="Diagnosing-Bias-vs-Variance"><a href="#Diagnosing-Bias-vs-Variance" class="headerlink" title="Diagnosing Bias vs. Variance"></a>Diagnosing Bias vs. Variance</h1><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170511/103200427.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="high biais and high variance" title="">
                </div>
                <div class="image-caption">high biais and high variance</div>
            </figure>
<ul>
<li> High bias (underfitting): both $J_{train}(\Theta)$ and $J_{CV}(\Theta)$ will be high. Also, $J_{CV}(\Theta) \approx J_{train}(\Theta)$. </li>
<li> High variance (overfitting): $J_{train}(\Theta)$ will be low and $J_{CV}(\Theta)$ will be much greater than $J_{train}(\Theta)$. 
</li>
</ul>
<p>很多情况下，欠拟合会导致高误差，高方差意味着拟合过度。</p>
<h2 id="Decide-Bias-or-Variance"><a href="#Decide-Bias-or-Variance" class="headerlink" title="Decide Bias or Variance"></a>Decide Bias or Variance</h2><ul>
<li>训练集误差和交叉验证集误差近似时：偏差/欠拟合</li>
<li>交叉训练集误差 &gt;&gt; 训练集误差时：方法/过拟合</li>
</ul>
<h1 id="Regularization-and-Bias-Variance"><a href="#Regularization-and-Bias-Variance" class="headerlink" title="Regularization and Bias/Variance"></a>Regularization and Bias/Variance</h1><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170511/110947313.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="mark" title="">
                </div>
                <div class="image-caption">mark</div>
            </figure>
<ul>
<li>Create a list of lambdas (i.e. λ∈{0,0.01,0.02,0.04,0.08,0.16,0.32,0.64,1.28,2.56,5.12,10.24});</li>
<li>Create a set of models with different degrees or any other variants.</li>
<li>Iterate through the $\lambda$s and for each $\lambda$ go through all the models to learn some $\Theta$.</li>
<li>Compute the cross validation error using the learned Θ (computed with λ) on the $J_{CV}(\Theta)$  <strong>without</strong>  regularization or λ = 0.</li>
<li>Select the best combo that produces the lowest error on the cross validation set.</li>
<li>Using the best combo Θ and λ, apply it on $J_{test}(\Theta)$ to see if it has a good generalization of the problem.<br>简单说：<br>训练12个不同归一化的模型-&gt;分别对应交叉验证集计算误差-&gt;选出最小的那个-&gt;使用在测试集上<h2 id="Regularization-相关结论"><a href="#Regularization-相关结论" class="headerlink" title="Regularization 相关结论"></a>Regularization 相关结论</h2><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170511/111820389.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure></li>
<li>当$\lambda$较小时，训练集误差较小（过拟合）而交叉验证集误差较大。</li>
<li>随着$\lambda$增加，训练集误差不断增加（欠拟合），而交叉验证集误差则是先减小后增大。</li>
</ul>
<h1 id="Learning-Curves"><a href="#Learning-Curves" class="headerlink" title="Learning Curves"></a>Learning Curves</h1><ul>
<li>学习曲线是一个很好的工具，我们会经常使用学习曲线来判断某一个学习算法是否处于偏差、方差问题。</li>
<li>学习曲线试讲训练集误差和交叉验证集误差作为训练集<strong>实例数量（m）</strong>的函数绘制的图表。</li>
</ul>
<h2 id="Experiencing-high-bias"><a href="#Experiencing-high-bias" class="headerlink" title="Experiencing high bias:"></a>Experiencing high bias:</h2><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170511/113614575.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<ul>
<li> **Low training set size**: causes $J_{train}(\Theta)$ to be low and $J_{CV}(\Theta)$ to be high. </li>
<li> **Large training set size**: causes both $J_{train}(\Theta)$ and $J_{CV}(\Theta)$ to be high with $J_{train}(\Theta)$≈$J_{CV}(\Theta)$ 
因此在高偏差（<strong>欠拟合</strong>）的情况下，增加训练集数量并不是一个好办法。此时，我们应当增加features。<h2 id="Experiencing-high-variance"><a href="#Experiencing-high-variance" class="headerlink" title="Experiencing high variance:"></a>Experiencing high variance:</h2><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170511/113828788.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure></li>
<li> **Low training set size**: $J_{train}(\Theta)$ will be low and $J_{CV}(\Theta)$ will be high. </li>
<li> **Large training set size**: $J_{train}(\Theta)$ increases with training set size and $J_{CV}(\Theta)$ continues to decrease without leveling off. Also, $J_{train}(\Theta)$ &lt; $J_{CV}(\Theta)$ but the difference between them remains significant. 
对比之下，如果在高方差（<strong>过拟合</strong>）的情况下，增加训练集数量可以明显降低误差，提高算法效果。</li>
</ul>
<h1 id="决定下一步做什么"><a href="#决定下一步做什么" class="headerlink" title="决定下一步做什么"></a>决定下一步做什么</h1><ul>
<li>获得更多的训练实例——解决高方差<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170511/103200427.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="high biais and high variance" title="">
                </div>
                <div class="image-caption">high biais and high variance</div>
            </figure></li>
<li>尝试减少特征的数量——解决高方差</li>
<li>尝试获得更多的特征——解决高偏差</li>
<li>尝试增加多项式特征——解决高偏差<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170511/111820389.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure> </li>
<li>尝试减少归一化程度 λ—&gt;提高拟合准确度—&gt;解决高偏差</li>
<li>尝试增加归一化程度 λ—&gt;防止过拟合—&gt;解决高方差</li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;假设你在开发一个机器学习系统，或者在改进一个机器学习系统的性能，应如何做？&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
    
    </summary>
    
      <category term="Coursera ML" scheme="http://feiyang.li/categories/Coursera-ML/"/>
    
    
      <category term="Machine Learning" scheme="http://feiyang.li/tags/Machine-Learning/"/>
    
      <category term="读书笔记" scheme="http://feiyang.li/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>Coursera ML(9)-Programming Exercise 4</title>
    <link href="http://feiyang.li/2017/05/10/Coursera-ML-9-Programming-Exercise-4/index.html"/>
    <id>http://feiyang.li/2017/05/10/Coursera-ML-9-Programming-Exercise-4/index.html</id>
    <published>2017-05-10T10:01:38.000Z</published>
    <updated>2017-05-11T01:21:35.719Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><script src="/assets/js/DPlayer.min.js"> </script><blockquote>
<p>对应反向传播算法内容</p>
</blockquote>
<hr>
<a id="more"></a>
<h1 id="Programming-Exercise-4-Neural-Networks-Learning"><a href="#Programming-Exercise-4-Neural-Networks-Learning" class="headerlink" title="Programming Exercise 4 - Neural Networks Learning"></a>Programming Exercise 4 - Neural Networks Learning</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># %load ../../../standard_import.txt</span></div><div class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</div><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"><span class="keyword">import</span> matplotlib <span class="keyword">as</span> mpl</div><div class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</div><div class="line"></div><div class="line"><span class="comment"># load MATLAB files</span></div><div class="line"><span class="keyword">from</span> scipy.io <span class="keyword">import</span> loadmat</div><div class="line"></div><div class="line">pd.set_option(<span class="string">'display.notebook_repr_html'</span>, <span class="keyword">False</span>)</div><div class="line">pd.set_option(<span class="string">'display.max_columns'</span>, <span class="keyword">None</span>)</div><div class="line">pd.set_option(<span class="string">'display.max_rows'</span>, <span class="number">150</span>)</div><div class="line">pd.set_option(<span class="string">'display.max_seq_items'</span>, <span class="keyword">None</span>)</div><div class="line"> </div><div class="line"><span class="comment">#%config InlineBackend.figure_formats = &#123;'pdf',&#125;</span></div><div class="line">%matplotlib inline</div><div class="line"></div><div class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</div><div class="line">sns.set_context(<span class="string">'notebook'</span>)</div><div class="line">sns.set_style(<span class="string">'darkgrid'</span>)</div></pre></td></tr></table></figure>
<h2 id="Load-MATLAB-datafiles"><a href="#Load-MATLAB-datafiles" class="headerlink" title="Load MATLAB datafiles"></a>Load MATLAB datafiles</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">data = loadmat(<span class="string">'data/ex4data1.mat'</span>)</div><div class="line">data.keys()</div></pre></td></tr></table></figure>
<pre><code>dict_keys([&apos;__header__&apos;, &apos;__version__&apos;, &apos;__globals__&apos;, &apos;X&apos;, &apos;y&apos;])
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">y = data[<span class="string">'y'</span>]</div><div class="line"><span class="comment"># Add intercept</span></div><div class="line">X = np.c_[np.ones((data[<span class="string">'X'</span>].shape[<span class="number">0</span>],<span class="number">1</span>)), data[<span class="string">'X'</span>]]</div><div class="line"></div><div class="line">print(<span class="string">'X:'</span>,X.shape, <span class="string">'(with intercept)'</span>)</div><div class="line">print(<span class="string">'y:'</span>,y.shape)</div></pre></td></tr></table></figure>
<pre><code>X: (5000, 401) (with intercept)
y: (5000, 1)
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">weights = loadmat(<span class="string">'data/ex3weights.mat'</span>)</div><div class="line">weights.keys()</div></pre></td></tr></table></figure>
<pre><code>dict_keys([&apos;__header__&apos;, &apos;__version__&apos;, &apos;__globals__&apos;, &apos;Theta1&apos;, &apos;Theta2&apos;])
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">theta1, theta2 = weights[<span class="string">'Theta1'</span>], weights[<span class="string">'Theta2'</span>]</div><div class="line">print(<span class="string">'theta1 :'</span>, theta1.shape)</div><div class="line">print(<span class="string">'theta2 :'</span>, theta2.shape)</div><div class="line">params = np.r_[theta1.ravel(), theta2.ravel()]</div><div class="line">print(<span class="string">'params :'</span>, params.shape)</div></pre></td></tr></table></figure>
<pre><code>theta1 : (25, 401)
theta2 : (10, 26)
params : (10285,)
</code></pre><h2 id="Neural-Network"><a href="#Neural-Network" class="headerlink" title="Neural Network"></a>Neural Network</h2><p>Input layer size = 400 (20x20 pixels) <br><br>Hidden layer size = 25 <br><br>Number of labels = 10</p>
<h1 id="Neural-Networks-Feed-Forward-and-Cost-Function"><a href="#Neural-Networks-Feed-Forward-and-Cost-Function" class="headerlink" title="Neural Networks - Feed Forward and Cost Function"></a>Neural Networks - Feed Forward and Cost Function</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sigmoid</span><span class="params">(z)</span>:</span></div><div class="line">    <span class="keyword">return</span>(<span class="number">1</span> / (<span class="number">1</span> + np.exp(-z)))</div></pre></td></tr></table></figure>
<h2 id="Sigmoid-gradient"><a href="#Sigmoid-gradient" class="headerlink" title="Sigmoid gradient"></a>Sigmoid gradient</h2> $$ g'(z) = g(z)(1 - g(z))$$ 
<p>where  $$ g(z) = \frac{1}{1+e^{-z}}$$ </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sigmoidGradient</span><span class="params">(z)</span>:</span></div><div class="line">    <span class="keyword">return</span>(sigmoid(z)*(<span class="number">1</span>-sigmoid(z)))</div></pre></td></tr></table></figure>
<h2 id="Cost-Function"><a href="#Cost-Function" class="headerlink" title="Cost Function"></a>Cost Function</h2> $$ J(\theta) = \frac{1}{m}\sum_{i=1}^{m}\sum_{k=1}^{K}\big[-y^{(i)}_{k}\, log\,(( h_\theta\,(x^{(i)}))_k)-(1-y^{(i)}_k)\,log\,(1-h_\theta(x^{(i)}))_k)\big]$$ 
<h2 id="Regularized-Cost-Function"><a href="#Regularized-Cost-Function" class="headerlink" title="Regularized Cost Function"></a>Regularized Cost Function</h2> $$ J(\theta) = \frac{1}{m}\sum_{i=1}^{m}\sum_{k=1}^{K}\bigg[-y^{(i)}_{k}\, log\,(( h_\theta\,(x^{(i)}))_k)-(1-y^{(i)}_k)\,log\,(1-h_\theta(x^{(i)}))_k)\bigg] + \frac{\lambda}{2m}\bigg[\sum_{j=1}^{25}\sum_{k=1}^{400}(\Theta_{j,k}^{(1)})^2+\sum_{j=1}^{10}\sum_{k=1}^{25}(\Theta_{j,k}^{(2)})^2\bigg]$$ 
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">nnCostFunction</span><span class="params">(nn_params, input_layer_size, hidden_layer_size, num_labels, features, classes, reg)</span>:</span></div><div class="line">    </div><div class="line">    <span class="comment"># When comparing to Octave code note that Python uses zero-indexed arrays.</span></div><div class="line">    <span class="comment"># But because Numpy indexing does not include the right side, the code is the same anyway.</span></div><div class="line">    theta1 = nn_params[<span class="number">0</span>:(hidden_layer_size*(input_layer_size+<span class="number">1</span>))].reshape(hidden_layer_size,(input_layer_size+<span class="number">1</span>))</div><div class="line">    theta2 = nn_params[(hidden_layer_size*(input_layer_size+<span class="number">1</span>)):].reshape(num_labels,(hidden_layer_size+<span class="number">1</span>))</div><div class="line"></div><div class="line">    m = features.shape[<span class="number">0</span>]</div><div class="line">    y_matrix = pd.get_dummies(classes.ravel()).as_matrix() </div><div class="line">    </div><div class="line">    <span class="comment"># Cost</span></div><div class="line">    a1 = features <span class="comment"># 5000x401</span></div><div class="line">        </div><div class="line">    z2 = theta1.dot(a1.T) <span class="comment"># 25x401 * 401x5000 = 25x5000 </span></div><div class="line">    a2 = np.c_[np.ones((features.shape[<span class="number">0</span>],<span class="number">1</span>)),sigmoid(z2.T)] <span class="comment"># 5000x26 </span></div><div class="line">    </div><div class="line">    z3 = theta2.dot(a2.T) <span class="comment"># 10x26 * 26x5000 = 10x5000 </span></div><div class="line">    a3 = sigmoid(z3) <span class="comment"># 10x5000</span></div><div class="line">    </div><div class="line">    J = <span class="number">-1</span>*(<span class="number">1</span>/m)*np.sum((np.log(a3.T)*(y_matrix)+np.log(<span class="number">1</span>-a3).T*(<span class="number">1</span>-y_matrix))) + \</div><div class="line">        (reg/(<span class="number">2</span>*m))*(np.sum(np.square(theta1[:,<span class="number">1</span>:])) + np.sum(np.square(theta2[:,<span class="number">1</span>:])))</div><div class="line"></div><div class="line">    <span class="comment"># Gradients</span></div><div class="line">    d3 = a3.T - y_matrix <span class="comment"># 5000x10</span></div><div class="line">    d2 = theta2[:,<span class="number">1</span>:].T.dot(d3.T)*sigmoidGradient(z2) <span class="comment"># 25x10 *10x5000 * 25x5000 = 25x5000</span></div><div class="line">    </div><div class="line">    delta1 = d2.dot(a1) <span class="comment"># 25x5000 * 5000x401 = 25x401</span></div><div class="line">    delta2 = d3.T.dot(a2) <span class="comment"># 10x5000 *5000x26 = 10x26</span></div><div class="line">    </div><div class="line">    theta1_ = np.c_[np.ones((theta1.shape[<span class="number">0</span>],<span class="number">1</span>)),theta1[:,<span class="number">1</span>:]]</div><div class="line">    theta2_ = np.c_[np.ones((theta2.shape[<span class="number">0</span>],<span class="number">1</span>)),theta2[:,<span class="number">1</span>:]]</div><div class="line">    </div><div class="line">    theta1_grad = delta1/m + (theta1_*reg)/m</div><div class="line">    theta2_grad = delta2/m + (theta2_*reg)/m</div><div class="line">    </div><div class="line">    <span class="keyword">return</span>(J, theta1_grad, theta2_grad)</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Regularization parameter = 0</span></div><div class="line">nnCostFunction(params, <span class="number">400</span>, <span class="number">25</span>, <span class="number">10</span>, X, y, <span class="number">0</span>)[<span class="number">0</span>]</div></pre></td></tr></table></figure>
<pre><code>0.28762916516131892
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Regularization parameter = 1</span></div><div class="line">nnCostFunction(params, <span class="number">400</span>, <span class="number">25</span>, <span class="number">10</span>, X, y, <span class="number">1</span>)[<span class="number">0</span>]</div></pre></td></tr></table></figure>
<pre><code>0.38376985909092365
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[sigmoidGradient(z) <span class="keyword">for</span> z <span class="keyword">in</span> [<span class="number">-1</span>, <span class="number">-0.5</span>, <span class="number">0</span>, <span class="number">0.5</span>, <span class="number">1</span>]]</div></pre></td></tr></table></figure>
<pre><code>[0.19661193324148185,
 0.23500371220159449,
 0.25,
 0.23500371220159449,
 0.19661193324148185]
</code></pre>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;对应反向传播算法内容&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
    
    </summary>
    
      <category term="Coursera ML" scheme="http://feiyang.li/categories/Coursera-ML/"/>
    
    
      <category term="Python" scheme="http://feiyang.li/tags/Python/"/>
    
      <category term="Machine Learning" scheme="http://feiyang.li/tags/Machine-Learning/"/>
    
      <category term="读书笔记" scheme="http://feiyang.li/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>ss-panel 一键安装脚本（前端后端全自动一键安装脚本）</title>
    <link href="http://feiyang.li/2017/05/09/ss-shell/index.html"/>
    <id>http://feiyang.li/2017/05/09/ss-shell/index.html</id>
    <published>2017-05-09T13:58:57.000Z</published>
    <updated>2017-05-20T06:36:01.641Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><script src="/assets/js/DPlayer.min.js"> </script><blockquote>
<p>上周接触了ss-panel，发现搭建起来异常的麻烦，对新手来说，到处都是坑，因此搭建了本ss-panel一键安装脚本</p>
</blockquote>
<hr>
<a id="more"></a>
<h1 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h1><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170509/191015542.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170509/191042466.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170509/191103228.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<p><strong>Github：<a href="https://github.com/mmmwhy/ss-panel-and-ss-py-mu" target="_blank" rel="external">https://github.com/mmmwhy/ss-panel-and-ss-py-mu</a></strong></p>
<p><strong>示例网站：<a href="https://ss.feiyang.li/" target="_blank" rel="external">https://ss.feiyang.li/</a></strong></p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170509/215724204.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<h1 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h1><ul>
<li>前端使用最新<a href="https://github.com/orvice/ss-panel" target="_blank" rel="external">ss-panel v3</a>，稳定性和可管理行都有明显提高。</li>
<li>后端使用<a href="https://github.com/fsgmhoward/shadowsocks-py-mu" target="_blank" rel="external">shadowsocks-py-mu</a>，多用户版本，与前端完美对接。</li>
<li>过程全自动，所以可能碰到的坑都提前做好处理。</li>
<li>被墙掉的资源都换成了墙内资源，不会出现被卡死的情况了。</li>
</ul>
<h1 id="系统要求"><a href="#系统要求" class="headerlink" title="系统要求"></a>系统要求</h1><p>建议CentOS7 X64，我用的是这个版本，目前在腾讯云，digitalocean，interserver上通过测试。<br>理论上：CentOS 6+ / Debian 7+ / Ubuntu 14.04 +  都可以，</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170510/094150095.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<h1 id="一键安装脚本"><a href="#一键安装脚本" class="headerlink" title="一键安装脚本"></a>一键安装脚本</h1><ul>
<li>登陆后运行：<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">screen -S ss</div></pre></td></tr></table></figure>
</li>
</ul>
<p>如果提示screen: command not found 命令不存在可以执行：<code>yum install screen</code> 或 <code>apt-get install screen</code>安装（如果网络掉线，可以重新连接，再执行 <code>screen -r ss</code> 就会看到你的ss-panel安装进程。）</p>
<ul>
<li>安装脚本<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">wget -N --no-check-certificate https://raw.githubusercontent.com/mmmwhy/ss-panel-and-ss-py-mu/master/ss-panel_node.sh &amp;&amp; chmod +x ss-panel_node.sh &amp;&amp; bash ss-panel_node.sh</div></pre></td></tr></table></figure>
</li>
</ul>
<p>运行脚本后会出现脚本操作菜单，</p>
<h2 id="ss-panel和ss-node同时安装"><a href="#ss-panel和ss-node同时安装" class="headerlink" title="ss-panel和ss-node同时安装"></a>ss-panel和ss-node同时安装</h2><p>选择并输入 1 </p>
<p><img src="http://cdn.mmmxcc.cn/blog/20170509/214909086.png" alt=""></p>
<p>因为ss-panel依赖于mysql,php,nginx，使用lnmp一键安装包，点击任意键开始安装。<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170510/102436162.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure></p>
<p>LNMP包编译时间较长，可以喝杯茶吃个饭。大约30分钟左右，安装结束，提示登陆IP即可查看网站</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170510/102100972.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170510/101919599.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<p><strong>默认账户：ss@feiyang.li</strong></p>
<p><strong>默认密码：feiyang</strong></p>
<p>进入ss-panel页面后，记得在<strong>管理面板-&gt;节点管理-&gt;添加节点-&gt;输入节点信息</strong></p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170510/085511290.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<p>之后回到用户面板，就可以使用了。</p>
<h2 id="仅安装ss-panel"><a href="#仅安装ss-panel" class="headerlink" title="仅安装ss-panel"></a>仅安装ss-panel</h2><p>选择并输入 2<br>出现的结果与1相同，只不过您vps上没有同时安装<a href="https://github.com/fsgmhoward/shadowsocks-py-mu" target="_blank" rel="external">ss-py-mu</a></p>
<h2 id="仅安装ss-node"><a href="#仅安装ss-node" class="headerlink" title="仅安装ss-node"></a>仅安装ss-node</h2><p>选择并输入 3，用于新建节点。<br>先在网页增加节点信息，特别要记住这里的node_id，长这个样子的<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170509/221038086.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="mark" title="">
                </div>
                <div class="image-caption">mark</div>
            </figure></p>
<p>输入相关信息，ip地址和域名（ss-panel的）都可以，但是需要加上<strong>http:// 或者 https://</strong> ，注意区分自己域名有没有ssl。否则可能出现用户使用记录无法推送的问题。</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170509/221216262.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<h1 id="其他补充内容"><a href="#其他补充内容" class="headerlink" title="其他补充内容"></a>其他补充内容</h1><ul>
<li>LNMP环境编译时间较长</li>
<li>php依赖安装会花费较长时间，特别是在国内</li>
</ul>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170510/101054745.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="本页面停留时间较长" title="">
                </div>
                <div class="image-caption">本页面停留时间较长</div>
            </figure>
<ul>
<li>mailgun账号需要自己申请，我那个只是举个例子。</li>
<li>基于<a href="https://lnmp.org/" target="_blank" rel="external">lnmp1.3稳定版</a>制作，兼容性非常好。</li>
<li><a href="http://feiyang.li/2017/05/03/ss-panel/index.html#常见错误">常见错误</a>在这里查看</li>
<li>如果想设置更多的信息，请查看<a href="http://feiyang.li/2017/05/05/ss-panel-full/index.html">安装教程全文</a>，本脚本和该教程内容完全一致。</li>
<li>关于<a href="http://feiyang.li/2017/05/05/ss-panel-full/index.html#谷歌BBR加速">Google的bbr加速</a>，与本脚本可以通用，但是因为效果不明显(可能因为我们实验室网太烂了吧)，所以我没有加入。</li>
<li>有人问到，vps重启后，节点就不能连接了。有两个方法：<ul>
<li>使用crontab</li>
<li>开机之后，输入<code>supervisord</code>，打开守护进程就好了。</li>
</ul>
</li>
</ul>
<hr>
<p>第一次写脚本，还请多多指教~</p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;上周接触了ss-panel，发现搭建起来异常的麻烦，对新手来说，到处都是坑，因此搭建了本ss-panel一键安装脚本&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
    
    </summary>
    
      <category term="shadowsocks" scheme="http://feiyang.li/categories/shadowsocks/"/>
    
    
      <category term="GFW" scheme="http://feiyang.li/tags/GFW/"/>
    
      <category term="Linux" scheme="http://feiyang.li/tags/Linux/"/>
    
      <category term="教程" scheme="http://feiyang.li/tags/%E6%95%99%E7%A8%8B/"/>
    
      <category term="vps" scheme="http://feiyang.li/tags/vps/"/>
    
      <category term="shell" scheme="http://feiyang.li/tags/shell/"/>
    
  </entry>
  
  <entry>
    <title>Coursera ML(8)-Neural Networks: Learning</title>
    <link href="http://feiyang.li/2017/05/06/Coursera-ML-8-Neural-Networks-Learning/index.html"/>
    <id>http://feiyang.li/2017/05/06/Coursera-ML-8-Neural-Networks-Learning/index.html</id>
    <published>2017-05-06T13:52:23.000Z</published>
    <updated>2017-05-10T11:56:05.596Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><script src="/assets/js/DPlayer.min.js"> </script><blockquote>
<p>本节笔记对应第五周Coursera课程 <a href="https://www.coursera.org/learn/machine-learning/home/week/5" target="_blank" rel="external">Neural Networks: Learning</a></p>
</blockquote>
<hr>
<a id="more"></a>
<h1 id="Cost-Fuction"><a href="#Cost-Fuction" class="headerlink" title="Cost Fuction"></a>Cost Fuction</h1><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170504/221046501.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<ul>
<li>cost function  $$\begin{gather*} J(\Theta) = - \frac{1}{m} \sum_{i=1}^m \sum_{k=1}^K \left[y^{(i)}_k \log ((h_\Theta (x^{(i)}))_k) + (1 - y^{(i)}_k)\log (1 - (h_\Theta(x^{(i)}))_k)\right] \end{gather*}$$ 
我们使用循环，对每一行特征都预测K个不同的结果，然后利用循环在K个预测中选择可能性最高的一个，将其与y中的实际数据进行对比。</li>
</ul>
<ul>
<li>Similarly, the regularization term just sum up the square of all the parameters from all the layers: $$\frac{\lambda}{2m}\sum_{l=1}^{L-1} \sum_{i=1}^{s_l} \sum_{j=1}^{s_{l+1}} ( \Theta_{j,i}^{(l)})^2$$ 
正则化的这一项，是在排除了每一层$\theta_0$后，每一层的$\Theta$矩阵的和。</li>
<li>最里层的循环$j$循环所有的行(由$s_{l+1}$层的激活单元数决定)。</li>
<li>循环$i$则循环所有的列，由该层(s_l层)的激活单元数决定。</li>
</ul>
<p>Note:<br>这个看起来很复杂的代价函数与之前代价函数思想是一样的，我们希望通过代价函数来观察算法预测的结果与真实情况的误差有多大。不同的是，对于每一行特征，我们都会给出<strong>K个预测</strong>。</p>
<h1 id="Backpropagation-Algorithm"><a href="#Backpropagation-Algorithm" class="headerlink" title="Backpropagation Algorithm"></a>Backpropagation Algorithm</h1><p><del>这一块我也看的不是很懂，先不做笔记。之后如果有新的感悟，再记回来。</del></p>
<p><del>没有就算了。</del></p>
<p>最终证明还是可以看懂的，csdn这个sb编辑器，害得我记得笔记丢失了一次，好气哦。又得抄大佬的笔记了。</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170508/090514790.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<p>In order to use optimization algorithms like gradient descent, we must calculate the derivative of the cost function. </p>
<ul>
<li>First we should calculate $\delta$ for each layer using backpropagation algorithm.  From $layer_l$ to $layer_{l+1}$ 
we have: $$\delta^{(output)} = a^{(output)} - y\\\delta^{(l)} = [\Theta^{(l)}]^T \delta^{(l+1)} .* g'(z^{(l)})$$  
</li>
</ul>
<p>误差$\delta$表示激活单元的预测值与实际值之间的误差。第二行式子，是在后一层偏差的基础上，增加了本层的偏差。</p>
<p>注意：没有$\delta_1$</p>
<h2 id="一点感悟"><a href="#一点感悟" class="headerlink" title="一点感悟"></a>一点感悟</h2><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170508/104937137.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170508/104732466.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<p>将这两个图，联系在一起，好像对反向传播有了一些理解。其实就是在正向传播的基础上，因为最终的对比结果是在最外层，那么我们从最外层开始，重新纠正一遍计算过程，这样可以减少误差。</p>
<ul>
<li><p>For sigmoid function, $g’(z) = g(z)(1-g(z))$<br>这个比较简单，就不推导了。</p>
</li>
<li><p>Then we have the derivative:</p>
 $$\frac {\partial}{\partial \Theta_{ij}^{(l)}} J(\Theta) = a_j^{(l)} \delta_i^{(l+1)} \\\Delta^{(l)} = \delta^{(l+1)} (a^{(l)})^T$$ 
<p>在Coursera教程中，这个地方被草草带过，相比之下<a href="http://www.ics.uci.edu/~dramanan/teaching/ics273a_winter08/lectures/lecture14.pdf" target="_blank" rel="external">uci</a>的这篇文章介绍的非常详细。</p>
</li>
</ul>
<h2 id="一个推导过程"><a href="#一个推导过程" class="headerlink" title="一个推导过程"></a>一个推导过程</h2><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170508/142800870.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170508/142813675.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170508/142827146.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170508/142832567.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<h2 id="另外一个推导"><a href="#另外一个推导" class="headerlink" title="另外一个推导"></a>另外一个推导</h2><h3 id="BackPropagation算法"><a href="#BackPropagation算法" class="headerlink" title="BackPropagation算法"></a>BackPropagation算法</h3><p>BackPropagation算法是多层神经网络的训练中举足轻重的算法，简单的理解，它就是复合函数的链式法则。由于后面我的网络中会用到对数损失函数，所以在这里我们使用平方损失函数。对于单个样例，其平方损失函数为：<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170508/144354206.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure></p>
<p>对于给定一个包含m个样例的数据集，我们可以定义整体代价函数为：<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170508/144400651.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure><br>和直线的拟合类似，深度学习也有一个目标函数，通过这个目标函数我们可以知道参数为何值时对我们来说才是一组“好”的参数，这个函数就是前边提到的损失函数。训练的过程就是通过每一次迭代对网络中参数进行更新，来使损失函数的值达到最小(下图中α为学习率)。<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170508/144431808.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure></p>
<h3 id="利用BackPropagation算法计算偏导数"><a href="#利用BackPropagation算法计算偏导数" class="headerlink" title="利用BackPropagation算法计算偏导数"></a>利用BackPropagation算法计算偏导数</h3><p>由上一节可知，我们只需求出每一层的 <figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170508/144537773.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="](http://cdn.mmmxcc.cn/blog/20170508/144525573.png) 和![" title="">
                </div>
                <div class="image-caption">](http://cdn.mmmxcc.cn/blog/20170508/144525573.png) 和![</div>
            </figure> 即可完成该层的权值和偏置的更新。<br>BP算法的整体思路如下：对于每个给定的训练样本，首先进行前向计算，计算出网络中每一层的激活值和网络的输出。对于最后一层(输出层)，我们可以直接计算出网络的输出值与已经给出的标签值(label)直接的差距，我们将这个值定义为残差δ。对于输出层之前的隐藏层L，我们将根据L+1层各节点的加权平均值来计算第L层的残差。</p>
<p><strong>插入一些我个人对BP算法的一点比较容易理解的解释(如有错误请指出)：在反向传播过程中，若第x层的a节点通过权值W对x+1层的b节点有贡献，则在反向传播过程中，梯度通过权值W从b节点传播回a节点。不管下面的公式推导，还是后面的卷积神经网络，在反向传播的过程中，都是遵循这样的一个规律。</strong></p>
<p>反向传播的具体步骤如下：</p>
<ul>
<li>根据输入，计算出每一层的激活值。</li>
<li>对于输出层，我们使用如下公式计算每个单元的残差：<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170508/145300526.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure></li>
<li>对于输出层之前的每一层，按照如下公式计算每一层的残差：<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170508/145319283.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure></li>
<li>由残差计算每一层的偏导数：<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170508/145334453.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure></li>
<li>最后，使用偏导数更新权值和偏置。</li>
</ul>
<hr>
<p>其实说到底，这两个推导方法其实是一回事，只不过换了几个字母而已。第二个推导更好一些</p>
<ul>
<li>Instead of calculate the $\Delta$  for all the training data, we could sum up all the inputs independantly, like:<br>From i = 1 to m, do:<br>$$\Delta^{(l)} += \delta^{(l+1)} (a^{(l)})^T $$<br>Then we have: $$ \\\frac {\partial}{\partial \Theta_{ij}^{(l)}} J(\Theta) = \frac {1}{m} \Delta_{ij}^{(l)}$$ 
</li>
</ul>
<p>(This step is the main step for mapreduce, see Large Scale Machine Learning)</p>
<ul>
<li>Then add regularzation term for partial derivative, we have:</li>
</ul>
<p>$ $\frac {\partial}{\partial \Theta_{ij}^{(l)}} J(\Theta) = \frac {1}{m} \Delta_{ij}^{(l)} + \frac {\lambda}{m} \Theta_{ij}^{(l)}$$ </p>
<ul>
<li>Finally, using $J(\Theta)$ and $\frac {\partial}{\partial \Theta_{ij}^{(l)}} J(\Theta)$, we could minimize the cost function using gradient descent as well as other optimization algorithms.</li>
</ul>
<h1 id="Optional-Section-How-Backpropagation-Works"><a href="#Optional-Section-How-Backpropagation-Works" class="headerlink" title="Optional Section: How Backpropagation Works"></a>Optional Section: How Backpropagation Works</h1><p>Using the same model as the last section:<br> $$\begin{align}\frac {\partial J}{\partial \Theta_{ij}^{(1)}} =\frac {\partial J}{\partial a_i^{(2)}}\frac {\partial a_i^{(2)}}{\partial z_i^{(2)}}\frac {\partial z_i^{(2)}}{\partial \Theta_{ij}^{(1)}} \\ =\frac {\partial J}{\partial a_i^{(2)}} g’(z_i^{(2)}) a_i^{(1)}\end{align}$$Then taking the total derivative with respect to $z^{(3)}$, a recursive expression for the derivative is obtained:$$\begin{align}\frac {\partial J}{\partial a_i^{(2)}} =\sum\limits_{m=1}^{s_3}\frac {\partial J}{\partial z_m^{(3)}}\frac {\partial z_m^{(3)}}{\partial a_i^{(2)}} \\ =\sum\limits_{m=1}^{s_3}\frac {\partial J}{\partial a_m^{(3)}}\frac {\partial a_m^{(3)}}{\partial z_m^{(3)}}\frac {\partial z_m^{(3)}}{\partial a_i^{(2)}} \\ =\sum\limits_{m=1}^{s_3}\frac {\partial J}{\partial a_m^{(3)}} g’(z_m^{(3)}) \Theta_{mi}^{(2)}\end{align}$$<br>Let  $\delta_i^{(2)} =\frac {\partial J}{\partial a_i^{2}} g’(z_i^{(2)})$, then from the result of the first formula We have: $\frac {\partial J}{\partial \Theta_{ij}^{1}} =\delta_i^{(2)} a_i^{(1)}$, in which recursively, $\delta_i^{(2)} =(\sum\limits_{m=1}^{s_3}\delta_m^{(3)}\Theta_{mi}^{(2)}) g’(z_i^{(2)})$ </p>
<p>–</p>
<p>Referance:<br><a href="http://www.wikiwand.com/en/Backpropagation#Derivation" target="_blank" rel="external">http://www.wikiwand.com/en/Backpropagation#Derivation</a><br>ttp://blog.csdn.net/l691899397/article/details/52223998<br><a href="http://xxuan.me/2016-02-20-Neural-Networks-Learning.html" target="_blank" rel="external">http://xxuan.me/2016-02-20-Neural-Networks-Learning.html</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;本节笔记对应第五周Coursera课程 &lt;a href=&quot;https://www.coursera.org/learn/machine-learning/home/week/5&quot;&gt;Neural Networks: Learning&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
    
    </summary>
    
      <category term="Coursera ML" scheme="http://feiyang.li/categories/Coursera-ML/"/>
    
    
      <category term="Python" scheme="http://feiyang.li/tags/Python/"/>
    
      <category term="Machine Learning" scheme="http://feiyang.li/tags/Machine-Learning/"/>
    
      <category term="读书笔记" scheme="http://feiyang.li/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>shadowsocks-Clients</title>
    <link href="http://feiyang.li/2017/05/05/ss-client/index.html"/>
    <id>http://feiyang.li/2017/05/05/ss-client/index.html</id>
    <published>2017-05-05T06:23:13.000Z</published>
    <updated>2017-05-20T01:22:29.813Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><script src="/assets/js/DPlayer.min.js"> </script><blockquote>
<p> shadowsocks是目前fq速度最快的工具之一，可以转发udp。可以使用ipv6，对于很多高校学生来说，可以通过此方法节省流量费用。</p>
</blockquote>
<hr>
<a id="more"></a>
<h1 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h1><h2 id="ss"><a href="#ss" class="headerlink" title="ss"></a>ss</h2><p><a href="http://home.ustc.edu.cn/~mmmwhy/Shadowsocks.exe" target="_blank" rel="external">http://home.ustc.edu.cn/~mmmwhy/Shadowsocks.exe</a></p>
<ul>
<li>在任务栏找到 Shadowsocks 图标</li>
<li>在 服务器 菜单添加多个服务器</li>
<li>选择 启用系统代理 来启用系统代理。请禁用浏览器里的代理插件，或把它们设置为使用系统代理。<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170515/104128278.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<h2 id="ssr"><a href="#ssr" class="headerlink" title="ssr"></a>ssr</h2><a href="http://home.ustc.edu.cn/~mmmwhy/ShadowsocksR-dotnet4.0.exe" target="_blank" rel="external">http://home.ustc.edu.cn/~mmmwhy/ShadowsocksR-dotnet4.0.exe</a><br>右键 纸飞机 -&gt; 扫描二维码 -&gt;  开启系统代理选择 -&gt;pac模式或者全局模式<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170515/104039212.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
</li>
</ul>
<p>如果遇到某个节点不能使用，可以换一个，因为本地运营商可能会把某些ip墙掉。</p>
<h1 id="Mac-OS-X"><a href="#Mac-OS-X" class="headerlink" title="Mac OS X"></a>Mac OS X</h1><p><a href="https://github.com/shadowsocks/ShadowsocksX-NG/releases" target="_blank" rel="external">https://github.com/shadowsocks/ShadowsocksX-NG/releases</a><br>OS X 下设置使用方法<br>Mac 下使用极其方便，因为 GUI 已经集成了系统 Pac，所以无需设置任何科学上网的姿势，直接运行 ShadowsocksX ，然后输入服务商提供给你的账号信息，保存运行后，即可在所有浏览器里直接科学上网，如图：<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170515/105527529.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure><br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170515/105543198.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure></p>
<h1 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h1><p><a href="https://github.com/shadowsocks/shadowsocks-qt5/wiki/Installation" target="_blank" rel="external">https://github.com/shadowsocks/shadowsocks-qt5/wiki/Installation</a></p>
<h1 id="Android"><a href="#Android" class="headerlink" title="Android"></a>Android</h1><p><a href="http://cdn.mmmxcc.cn/ssr_3.0.2.2.apk" target="_blank" rel="external">ssr</a><br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170505/143305745.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure><br>扫描二维码-&gt; 然后点小飞机就可以了</p>
<h1 id="iOS"><a href="#iOS" class="headerlink" title="iOS"></a>iOS</h1><p><a href="https://itunes.apple.com/cn/app/ssrconnect-proxy-utility/id1161221960?mt=8" target="_blank" rel="external">SsrConnect - Proxy Utility</a> 免费<br><a href="https://itunes.apple.com/us/app/alice-network-proxy-utility/id1135320992?mt=8" target="_blank" rel="external">Network Proxy Utility</a> 免费<br><a href="https://itunes.apple.com/cn/app/shadowrocket/id932747118?mt=8" target="_blank" rel="external">Shadowrocket</a> 付费<br><a href="https://itunes.apple.com/app/apple-store/id1070901416?mt=8" target="_blank" rel="external">土豆丝</a> 付费</p>
<h1 id="OpenWRT"><a href="#OpenWRT" class="headerlink" title="OpenWRT"></a>OpenWRT</h1><ul>
<li>shadowsocks-libev<br><code>opkg install shadowsocks-libev</code></li>
<li>shadowsocks-libev-polarssl<br><code>opkg install shadowsocks-libev-polarssl</code></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt; shadowsocks是目前fq速度最快的工具之一，可以转发udp。可以使用ipv6，对于很多高校学生来说，可以通过此方法节省流量费用。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
    
    </summary>
    
      <category term="shadowsocks" scheme="http://feiyang.li/categories/shadowsocks/"/>
    
    
      <category term="GFW" scheme="http://feiyang.li/tags/GFW/"/>
    
      <category term="Linux" scheme="http://feiyang.li/tags/Linux/"/>
    
      <category term="教程" scheme="http://feiyang.li/tags/%E6%95%99%E7%A8%8B/"/>
    
      <category term="vps" scheme="http://feiyang.li/tags/vps/"/>
    
  </entry>
  
  <entry>
    <title>ss-panel + ss py mu安装教程</title>
    <link href="http://feiyang.li/2017/05/05/ss-panel-full/index.html"/>
    <id>http://feiyang.li/2017/05/05/ss-panel-full/index.html</id>
    <published>2017-05-05T06:09:39.000Z</published>
    <updated>2017-05-20T01:22:24.348Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><script src="/assets/js/DPlayer.min.js"> </script><blockquote>
<p>系统介绍： 1g内存，单核，也就是传说中的腾讯1元学生机。centos6.8 x32。</p>
</blockquote>
<hr>
<a id="more"></a>
<p>读者建议：如果使用国外vps<a href="http://feiyang.li/2017/05/03/ss-panel/index.html">建议</a>会快速很多。国内vps建议本方法。</p>
<h1 id="lnmp环境配置"><a href="#lnmp环境配置" class="headerlink" title="lnmp环境配置"></a>lnmp环境配置</h1><p>这里使用最新的<a href="https://lnmp.org/install.html" target="_blank" rel="external">lnmp1.4</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">wget -c http://soft.vpser.net/lnmp/lnmp1.4beta.tar.gz &amp;&amp; tar zxf lnmp1.4beta.tar.gz &amp;&amp; cd lnmp1.4 &amp;&amp; ./install.sh lnmp</div></pre></td></tr></table></figure></p>
<p><img src="http://cdn.mmmxcc.cn/blog/20170504/204651581.png" alt=""></p>
<h1 id="安装ss-panel前端"><a href="#安装ss-panel前端" class="headerlink" title="安装ss-panel前端"></a>安装ss-panel前端</h1><h2 id="下载-ss-panel-源码"><a href="#下载-ss-panel-源码" class="headerlink" title="下载 ss-panel 源码"></a>下载 ss-panel 源码</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cd /home/wwwroot/ </div><div class="line">git clone https://github.com/orvice/ss-panel.git</div></pre></td></tr></table></figure>
<p>安装好之后，是这个样子的。</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170504/205330510.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="mark" title="">
                </div>
                <div class="image-caption">mark</div>
            </figure>
<h2 id="配置-ss-panel"><a href="#配置-ss-panel" class="headerlink" title="配置 ss-panel"></a>配置 ss-panel</h2><h3 id="env文件配置"><a href="#env文件配置" class="headerlink" title=".env文件配置"></a>.env文件配置</h3><p>安装依赖文件，并配置.env<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">cd /home/wwwroot/ss-panel/</div><div class="line">curl -sS https://install.phpcomposer.com/installer | php</div><div class="line">chmod +x composer.phar</div><div class="line">php composer.phar install</div></pre></td></tr></table></figure></p>
<ul>
<li>安装依赖那一步时间会久一些，因为一共有75个依赖，而且很多被墙了（因此如果直接用国外vps，真的会好很多），换了国内源会<strong>稍微</strong>好一些。<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170504/215216082.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="漫长的等待" title="">
                </div>
                <div class="image-caption">漫长的等待</div>
            </figure>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">chmod -R 777 storage</div><div class="line">cp .env.example .env</div><div class="line">vi .env</div></pre></td></tr></table></figure>
<ul>
<li>这里主要是修改数据库的内容，还有<strong>muKey</strong>。</li>
</ul>
<h3 id="nginx配置"><a href="#nginx配置" class="headerlink" title="nginx配置"></a>nginx配置</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">lnmp vhost add</div><div class="line"># 写入站点网址</div><div class="line">/home/wwwroot/ss-panel/public</div><div class="line"># 允许重写规则，其余一律是n</div></pre></td></tr></table></figure>
<p><img src="http://cdn.mmmxcc.cn/blog/20170504/210029356.png" alt=""></p>
<p>进入nginx配置文件再修改一下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cd /usr/local/nginx/conf/vhost/</div></pre></td></tr></table></figure></p>
<p>完整配置文件应该是这个样子<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line">server &#123;</div><div class="line"> listen 80;</div><div class="line"> #listen [::]:80;</div><div class="line">server_name ss.feiyang.li n;</div><div class="line">index index.html index.htm index.php default.html default.htm default.php;</div><div class="line">root /home/wwwroot/ss.feiyang.li/public;</div><div class="line"> </div><div class="line">location / &#123;</div><div class="line">                        try_files $uri $uri/ /index.php$is_args$args;</div><div class="line">                &#125;</div><div class="line"></div><div class="line">location ~ [^/]\.php(/|$) &#123;</div><div class="line"> # comment try_files $uri =404; to enable pathinfo</div><div class="line"> try_files $uri =404;</div><div class="line"> fastcgi_pass unix:/tmp/php-cgi.sock;</div><div class="line"> fastcgi_index index.php;</div><div class="line"> include fastcgi.conf;</div><div class="line"> #include pathinfo.conf;</div><div class="line">fastcgi_param PHP_ADMIN_VALUE &quot;open_basedir = /home/wwwroot/:/temp/:/proc&quot;;</div><div class="line">&#125;</div><div class="line"></div><div class="line"> </div><div class="line"> location ~ .*\.(gif|jpg|jpeg|png|bmp|swf)$ &#123;</div><div class="line"> expires 30d;</div><div class="line"> &#125;</div><div class="line"> </div><div class="line"> location ~ .*\.(js|css)?$</div><div class="line"> &#123;</div><div class="line"> expires 12h;</div><div class="line"> &#125;</div><div class="line"> </div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="新建ss数据库"><a href="#新建ss数据库" class="headerlink" title="新建ss数据库"></a>新建ss数据库</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">mysql -uroot -p</div><div class="line"># 输入自己的密码</div><div class="line">create database ss;</div><div class="line">use ss;</div><div class="line">source  /home/wwwroot/ss-panel/db.sql;</div></pre></td></tr></table></figure>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170504/212157512.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<p>现在访问你的站点，就可以看到 ss-panel 啦：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170505/124252257.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<h2 id="添加管理员账户"><a href="#添加管理员账户" class="headerlink" title="添加管理员账户"></a>添加管理员账户</h2><p>文字排序会让强迫症奔溃。。。。。<br><code>php xcat createAdmin</code></p>
<h2 id="邮箱设置"><a href="#邮箱设置" class="headerlink" title="邮箱设置"></a>邮箱设置</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">vi .env</div><div class="line">mailgun_key = &apos;key-0****c09&apos; //上面的KEY</div><div class="line">mailgun_domain = &apos;https://api.mailgun.net/v3/feiyang.li&apos; //你经过验证过的域名</div><div class="line">mailgun_sender = &apos;postmaster@****.net&apos; //postmaster@你经过验证过的域名</div></pre></td></tr></table></figure>
<h2 id="https证书"><a href="#https证书" class="headerlink" title="https证书"></a>https证书</h2><p><code>lnmp ssl add</code><br>/home/wwwroot/ss-panel/1_ss.feiyang.li_bundle.crt<br>/home/wwwroot/ss-panel/2_ss.feiyang.li.key<br>获得绿色小锁~<br><img src="http://cdn.mmmxcc.cn/blog/20170505/124311675.png" alt=""></p>
<h1 id="安装-SS-PY-MU-服务端"><a href="#安装-SS-PY-MU-服务端" class="headerlink" title="安装 SS PY MU 服务端"></a>安装 SS PY MU 服务端</h1><h2 id="安装libsodium支持chacha20"><a href="#安装libsodium支持chacha20" class="headerlink" title="安装libsodium支持chacha20"></a>安装libsodium支持chacha20</h2><p>centos：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">yum -y groupinstall &quot;Development Tools&quot;</div><div class="line">wget https://github.com/jedisct1/libsodium/releases/download/1.0.11/libsodium-1.0.11.tar.gz</div><div class="line">tar xf libsodium-1.0.11.tar.gz &amp;&amp; cd libsodium-1.0.11</div><div class="line">./configure &amp;&amp; make -j2 &amp;&amp; make install</div><div class="line">echo /usr/local/lib &gt; /etc/ld.so.conf.d/usr_local_lib.conf</div><div class="line">ldconfig</div></pre></td></tr></table></figure></p>
<p>ubuntu/debian：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">apt-get install build-essential</div><div class="line">wget https://github.com/jedisct1/libsodium/releases/download/1.0.11/libsodium-1.0.11.tar.gz</div><div class="line">tar xf libsodium-1.0.11.tar.gz &amp;&amp; cd libsodium-1.0.11</div><div class="line">./configure &amp;&amp; make -j2 &amp;&amp; make install</div><div class="line">ldconfig</div></pre></td></tr></table></figure></p>
<h2 id="将代码-clone-到本地："><a href="#将代码-clone-到本地：" class="headerlink" title="将代码 clone 到本地："></a>将代码 clone 到本地：</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">cd ~</div><div class="line">git clone https://github.com/fsgmhoward/shadowsocks-py-mu.git</div><div class="line">cd ~/shadowsocks-py-mu/shadowsocks/</div></pre></td></tr></table></figure>
<p>其中的 shadowsocks 子目录才是我们需要的，外面的是 setup.py 的相关文件。</p>
<h2 id="配置-shadowsocks-manyuser"><a href="#配置-shadowsocks-manyuser" class="headerlink" title="配置 shadowsocks-manyuser"></a>配置 shadowsocks-manyuser</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cp config_example.py config.py</div><div class="line">vi config.py</div></pre></td></tr></table></figure>
<p>修改其中第 15 行和第 29~31 行的内容：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"># 启用 MultiUser API</div><div class="line">API_ENABLED = True</div><div class="line"></div><div class="line"># 就是在你的站点地址后面加个 /mu</div><div class="line">API_URL = &apos;http://ss.feiyang.li/mu&apos;  </div><div class="line"># 还记得上面在 .env 中填写的 muKey 吗？把它填在这里</div><div class="line">API_PASS = &apos;api_key_just_for_test&apos;</div></pre></td></tr></table></figure>
<p>由于我们选择使用 Mu API 来与前端通信，所以我们不需要修改 config.py 中任何关于数据库的配置。</p>
<p><img src="http://cdn.mmmxcc.cn/blog/20170505/134246486.png" alt=""></p>
<p>好了，现在可以试着运行一下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python servers.py</div></pre></td></tr></table></figure></p>
<p>（注意，是 <strong>servers.py</strong> 而不是 server.py）。如果没错的话，应该可以看到这样的输出：</p>
<h2 id="配置-ss-manyuser-守护进程"><a href="#配置-ss-manyuser-守护进程" class="headerlink" title="配置 ss-manyuser 守护进程"></a>配置 ss-manyuser 守护进程</h2><ul>
<li><p>安装 supervisor （用的是上面安装过的 pip）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">yum install python-setuptools</div><div class="line">easy_install supervisor</div></pre></td></tr></table></figure>
</li>
<li><p>创建 supervisor 配置文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">echo_supervisord_conf &gt; /etc/supervisord.conf</div></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><p>运行 supervisor 服务</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">supervisord</div></pre></td></tr></table></figure>
</li>
<li><p>配置 supervisor 以监控 ss-manyuser 运行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">vim /etc/supervisord.conf</div></pre></td></tr></table></figure>
</li>
<li><p>在文件尾部添加如下内容并酌情修改：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">[program:ss-manyuser]</div><div class="line">command = python /root/shadowsocks-py-mu/shadowsocks/servers.py  </div><div class="line">user = root  </div><div class="line">autostart = true  </div><div class="line">autorestart = true</div></pre></td></tr></table></figure>
</li>
</ul>
<p>其中 command 里的目录请自行修改为你的 servers.py所在的绝对路径。</p>
<ul>
<li><p>重启 supervisor 服务以加载配置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">killall -HUP supervisord</div></pre></td></tr></table></figure>
</li>
<li><p>查看 shadowsocks-manyuser 是否已经运行：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">ps -ef | grep servers.py</div><div class="line">root 952 739 0 15:40 ? 00:00:00 python /root/shadowsocks-rm/shadowsocks/servers.py</div></pre></td></tr></table></figure>
</li>
<li><p>可以通过以下命令管理 shadowsock-manyuser 的状态</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">supervisorctl &#123;start|stop|restart&#125; ss-manyuser</div></pre></td></tr></table></figure>
<h1 id="谷歌BBR加速"><a href="#谷歌BBR加速" class="headerlink" title="谷歌BBR加速"></a>谷歌BBR加速</h1><h2 id="OpenVZ-以外的（-KVM-、-Xen-、-VMware-等）"><a href="#OpenVZ-以外的（-KVM-、-Xen-、-VMware-等）" class="headerlink" title="OpenVZ 以外的（ KVM 、 Xen 、 VMware 等）"></a>OpenVZ 以外的（ KVM 、 Xen 、 VMware 等）</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">wget --no-check-certificate https://github.com/teddysun/across/raw/master/bbr.sh</div><div class="line">chmod +x bbr.sh</div><div class="line">./bbr.sh</div></pre></td></tr></table></figure>
<p>详细信息见： <a href="https://www.91yun.org/archives/5174" target="_blank" rel="external">https://www.91yun.org/archives/5174</a></p>
<h2 id="OpenVZ-小鸡"><a href="#OpenVZ-小鸡" class="headerlink" title="OpenVZ 小鸡"></a>OpenVZ 小鸡</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">wget --no-check-certificate https://raw.githubusercontent.com/mmmwhy/LKL_BBR/master/lkl/install.sh &amp;&amp; bash install.sh</div></pre></td></tr></table></figure>
<p>详细内容见：<a href="https://www.91yun.org/archives/6281" target="_blank" rel="external">https://www.91yun.org/archives/6281</a><br>我稍微修改了一下端口范围(9000-19999)，因为之前那个范围是在太奇葩了。</p>
<h1 id="其余常见错误："><a href="#其余常见错误：" class="headerlink" title="其余常见错误："></a>其余常见错误：</h1><p><a href="http://feiyang.li/2017/05/03/ss-panel/index.html#常见错误">http://feiyang.li/2017/05/03/ss-panel/index.html#常见错误</a></p>
<p>与上文一样，本文参考了如下博主文章，在此致谢：<br><a href="https://blessing.studio/build-shadowsocks-sharing-site-with-ss-panel/" target="_blank" rel="external">https://blessing.studio/build-shadowsocks-sharing-site-with-ss-panel/</a><br><a href="http://bitzhi.com/2016/03/install-ss-go-mu-and-ss-panel-v3/" target="_blank" rel="external">http://bitzhi.com/2016/03/install-ss-go-mu-and-ss-panel-v3/</a><br><a href="https://levyhsu.com/?p=98" target="_blank" rel="external">https://levyhsu.com/?p=98</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;系统介绍： 1g内存，单核，也就是传说中的腾讯1元学生机。centos6.8 x32。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
    
    </summary>
    
      <category term="shadowsocks" scheme="http://feiyang.li/categories/shadowsocks/"/>
    
    
      <category term="GFW" scheme="http://feiyang.li/tags/GFW/"/>
    
      <category term="Linux" scheme="http://feiyang.li/tags/Linux/"/>
    
      <category term="教程" scheme="http://feiyang.li/tags/%E6%95%99%E7%A8%8B/"/>
    
      <category term="vps" scheme="http://feiyang.li/tags/vps/"/>
    
  </entry>
  
  <entry>
    <title>可能是最简单的ss-panel安装教程</title>
    <link href="http://feiyang.li/2017/05/03/ss-panel/index.html"/>
    <id>http://feiyang.li/2017/05/03/ss-panel/index.html</id>
    <published>2017-05-03T12:13:08.000Z</published>
    <updated>2017-05-20T02:54:31.807Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><script src="/assets/js/DPlayer.min.js"> </script><blockquote>
<p>因为阿松同学找我要ss账号，因此我大概花了一天时间搞了搞ss-panel，顺便做个记录吧。网上那么多教程有些是写得笼统，有些还是瞎复制的。由此萌生了想要写一篇配置 ss-panel 和 ss-manyuser 的教程，希望能够帮到需要的人。</p>
</blockquote>
<hr>
<a id="more"></a>
<p><strong>好消息！！！ 我已经写好了<a href="http://feiyang.li/2017/05/09/ss-shell/index.html">ss-panel一键脚本</a>，对小白非常友好~</strong></p>
<p>产品要求：fuck the wall、在可用范围内尽量简单一些（因此不考虑ssr，魔改panel也不考虑）读者建议：如果使用国外vps，建议本方法。国内vps<a href="http://feiyang.li/2017/05/05/ss-panel-full/index.html">建议</a></p>
<h1 id="ss-panel前端"><a href="#ss-panel前端" class="headerlink" title="ss-panel前端"></a>ss-panel前端</h1><p>我看官方文档，按部就班的做了一个前端，最后才发现竟然有ss-panel一键脚本，真的是血都要吐出来了。好气哦。这里直接介绍一键脚本方式。</p>
<h2 id="脚本下载以及运行"><a href="#脚本下载以及运行" class="headerlink" title="脚本下载以及运行"></a>脚本下载以及运行</h2><p>首先运行：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">yum -y install screen</div><div class="line">screen -S ssmanyuser</div></pre></td></tr></table></figure></p>
<p>然后执行：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">wget https://cloud.echoteen.com/s/24bSM2Ba48JTHlQ/download -O ss-install.bin</div><div class="line">chmod a+x ss-install.bin</div><div class="line">bash ss-install.bin</div></pre></td></tr></table></figure></p>
<h2 id="安装ss-panel"><a href="#安装ss-panel" class="headerlink" title="安装ss-panel"></a>安装ss-panel</h2><p>选择1，安装ss-panel前端，注意，首先要安装好前端！<br>所以输入1，然后回车！<br>安装好了以后，打开网站配置文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cd /etc/nginx/conf.d</div><div class="line">vim ss-panel.conf</div></pre></td></tr></table></figure>
<p>打开配置文件<br>主要是检查<strong>server_name</strong>和<strong>root</strong><br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170503/202011192.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="mark" title="">
                </div>
                <div class="image-caption">mark</div>
            </figure></p>
<h2 id="数据库配置"><a href="#数据库配置" class="headerlink" title="数据库配置"></a>数据库配置</h2><p><code>mysql_secure_installation</code><br>首先输入上述代码进行数据库初始化<br>配置数据库密码等，这个自行设置！<br>然后就是创建数据库和导入数据库了<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">mysql -uroot -p</div><div class="line"># 输入自己的密码</div><div class="line">create database ss;</div><div class="line">use ss;</div><div class="line">source  /home/www/panel/db.sql</div></pre></td></tr></table></figure></p>
<p>真的，有了这个脚本之后，解决了很多麻烦的问题。</p>
<h2 id="配置配置文件"><a href="#配置配置文件" class="headerlink" title="配置配置文件"></a>配置配置文件</h2><p>配置网页文件（.env），就是站点信息，很简单的<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">vim .env</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div></pre></td><td class="code"><pre><div class="line">//  ss-panel v3 配置</div><div class="line">//</div><div class="line">// !!! 修改此key为随机字符串确保网站安全 !!!</div><div class="line">key = &apos;randomKey&apos;</div><div class="line">env = &apos;prod&apos;  // 正式环境请保持env为prod确保安全</div><div class="line">debug =  &apos;false&apos;  //  正式环境请确保为false</div><div class="line">appName = &apos;ss-panel3&apos;             //站点名称</div><div class="line">baseUrl = &apos;https://www.google.com&apos;            // 站点地址</div><div class="line">timeZone = &apos;PRC&apos;        // RPC 天朝时间  UTC 格林时间</div><div class="line">pwdMethod = &apos;md5&apos;       // 密码加密   可选 md5,sha256</div><div class="line">salt = &apos;&apos;               // 密码加密用，从旧版升级请留空</div><div class="line">theme    = &apos;default&apos;   // 主题</div><div class="line">session = &apos;file&apos; //默认</div><div class="line">cache   = &apos;file&apos; //默认</div><div class="line">tokenDriver = &apos;db&apos; //默认</div><div class="line">// mu key 用于校验ss-go mu的请求,后边会用到</div><div class="line">muKey = &apos;&apos;</div><div class="line">// 邮件</div><div class="line">mailDriver = &apos;mailgun&apos;   // mailgun   #smtp不在支持,仅供测试</div><div class="line"> </div><div class="line">// 注册限制,每天每个ip能注册的次数</div><div class="line">ipDayLimit = &apos;10&apos;</div><div class="line"> </div><div class="line">// 邮箱验证设置</div><div class="line">emailVerifyEnabled = &apos;false&apos; // 是否开启注册时邮箱验证 (true:开启 false:关闭)</div><div class="line">emailVerifyCodeLength = &apos;8&apos;  // 邮箱验证代码长度</div><div class="line">emailVerifyTTL = &apos;30&apos;        // 验证代码有效时间 单位分钟</div><div class="line"> </div><div class="line">// 用户签到设置</div><div class="line">checkinTime = &apos;22&apos;      // 签到间隔时间 单位小时</div><div class="line">checkinMin = &apos;93&apos;       // 签到最少流量 单位MB</div><div class="line">checkinMax = &apos;97&apos;       // 签到最多流量</div><div class="line"> </div><div class="line">//</div><div class="line">defaultTraffic = &apos;1&apos;      // 用户初始流量 单位GB</div><div class="line">// 注册后获得的邀请码数量</div><div class="line">inviteNum = &apos;2&apos;</div><div class="line"> </div><div class="line">// 记录流量日志到dynamodb ,beta,请勿开启</div><div class="line">log_traffic_dynamodb = &apos;false&apos;</div><div class="line"> </div><div class="line"># database 数据库配置</div><div class="line">db_driver = &apos;mysql&apos;</div><div class="line">db_host = &apos;localhost&apos;</div><div class="line">db_port = &apos;3306&apos;</div><div class="line">db_database = &apos;ss&apos;</div><div class="line">db_username = &apos;root&apos;</div><div class="line">db_password = &apos;root&apos;</div><div class="line">db_charset = &apos;utf8&apos;</div><div class="line">db_collation = &apos;utf8_general_ci&apos;</div><div class="line">db_prefix = &apos;&apos;</div><div class="line"> </div><div class="line"># redis</div><div class="line">redis_scheme = &apos;tcp&apos;</div><div class="line">redis_host = &apos;127.0.0.1&apos;</div><div class="line">redis_port = &apos;6379&apos;</div><div class="line">redis_database = &apos;0&apos;</div><div class="line">redis_pass = &apos;&apos;</div><div class="line"> </div><div class="line"># mailgun</div><div class="line">mailgun_key = &apos;&apos;</div><div class="line">mailgun_domain = &apos;&apos;</div><div class="line">mailgun_sender = &apos;&apos;</div><div class="line"> </div><div class="line"># smtp</div><div class="line">smtp_host = &apos;&apos;</div><div class="line">smtp_username = &apos;&apos;</div><div class="line">smtp_port = &apos;&apos;</div><div class="line">smtp_name = &apos;&apos;</div><div class="line">smtp_sender = &apos;&apos;</div><div class="line">smtp_passsword = &apos;&apos;</div><div class="line">smtp_ssl = &apos;true&apos;</div><div class="line"> </div><div class="line"># aws</div><div class="line">aws_access_key_id = &apos;&apos;</div><div class="line">aws_secret_access_key = &apos;&apos;</div><div class="line">aws_region = &apos;ap-northeast-1&apos;</div><div class="line">aws_ses_region = &apos;us-east-1&apos;</div><div class="line">aws_ses_sender = &apos;&apos;</div></pre></td></tr></table></figure>
<h2 id="添加管理员"><a href="#添加管理员" class="headerlink" title="添加管理员"></a>添加管理员</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">php xcat createAdmin</div><div class="line"></div><div class="line">add admin/创建管理员帐号.....  </div><div class="line">Enter your email/输入管理员邮箱: h@prinzeugen.net  </div><div class="line">Enter password for: h@prinzeugen.net /为 h@prinzeugen.net 添加密码 xxx  </div><div class="line">Email: h@prinzeugen.net, Password: xxx  </div><div class="line">Press [Y] to create admin..... 按下[Y]确认来确认创建管理员账户..... y  </div><div class="line">start create admin accountSuccessful/ 添加成功!</div></pre></td></tr></table></figure>
<p>最后登录下网站<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170503/201708892.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure></p>
<hr>
<p>以上内容全部复制自：<a href="https://www.echoteen.com/yijian-sspanel-many-user.html/comment-page-1" target="_blank" rel="external">https://www.echoteen.com/yijian-sspanel-many-user.html/comment-page-1</a></p>
<p>因为ss-panel前端是基于ss原版，而该一键脚本后端基于ssr，因此这里不建议采用该脚本。</p>
<h1 id="部署并配置-shadowsocks-manyuser"><a href="#部署并配置-shadowsocks-manyuser" class="headerlink" title="部署并配置 shadowsocks-manyuser"></a>部署并配置 shadowsocks-manyuser</h1><p>这里使用的是 <a href="https://github.com/mengskysama/shadowsocks/tree/manyuser" target="_blank" rel="external">https://github.com/mengskysama/shadowsocks/tree/manyuser</a> 版ss</p>
<h2 id="安装-shadowsocks-manyuser"><a href="#安装-shadowsocks-manyuser" class="headerlink" title="安装 shadowsocks-manyuser"></a>安装 shadowsocks-manyuser</h2><p>先将代码 clone 到本地：<br><code>git clone https://github.com/fsgmhoward/shadowsocks-py-mu.git</code><br>其中的 shadowsocks 子目录才是我们需要的，注意这个地方和其他版本的不一样，ssr里子文件表示单用户。本版根据server.py还是servers.py来判断是不是多用户版本。</p>
<h2 id="配置-shadowsocks-manyuser"><a href="#配置-shadowsocks-manyuser" class="headerlink" title="配置 shadowsocks-manyuser"></a>配置 shadowsocks-manyuser</h2><p>进入 shadowsocks 目录，将 config_example.py 复制一份到 config.py：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cp config_example.py config.py</div><div class="line">vi config.py</div></pre></td></tr></table></figure>
<p>修改其中第 15 行和第 29~31 行的内容：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"># 启用 MultiUser API</div><div class="line">API_ENABLED = True</div><div class="line"></div><div class="line"># 就是在你的站点地址后面加个 /mu</div><div class="line">API_URL = &apos;http://ss.feiyang.li/mu&apos;  </div><div class="line"># 还记得上面在 .env 中填写的 muKey 吗？把它填在这里</div><div class="line">API_PASS = &apos;api_key_just_for_test&apos;</div></pre></td></tr></table></figure></p>
<p>由于我们选择使用 Mu API 来与前端通信，所以我们不需要修改 config.py 中任何关于数据库的配置。</p>
<p>好了，现在可以试着运行一下 $ python servers.py 了（注意，是 servers.py 而不是 server.py）。如果没错的话，应该可以看到这样的输出：<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170503/201724918.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure></p>
<h1 id="常见错误"><a href="#常见错误" class="headerlink" title="常见错误"></a>常见错误</h1><h2 id="不能上网"><a href="#不能上网" class="headerlink" title="不能上网"></a>不能上网</h2><p>首先国际惯例查看连接：</p>
<p><code>netstat -anp | grep 你的端口</code></p>
<p>正常的话，应该是这样的：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">Active Internet connections (servers and established)  </div><div class="line">Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name  </div><div class="line">tcp        0      0 0.0.0.0:62111            0.0.0.0:*               LISTEN      32083/python  </div><div class="line">tcp        0      0 162.233.122.111:62111    115.233.233.140:47177   TIME_WAIT   -  </div><div class="line">tcp        0      0 162.233.122.111:62111    115.233.233.140:47161   TIME_WAIT   -  </div><div class="line">tcp        0      0 162.233.122.111:62111    115.233.233.140:47160   TIME_WAIT   -  </div><div class="line">tcp        0      0 162.233.122.111:62111    115.233.233.140:47157   TIME_WAIT   -</div></pre></td></tr></table></figure></p>
<p>所以如果你要开放注册，就要这样配置你的 iptables：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"># 注意是半角冒号，意为允许 12450 及以上的端口</div><div class="line"># 也可以指定 12450:15550 这样的范围</div><div class="line">iptables -I INPUT -p tcp -m tcp --dport 12450: -j ACCEPT</div><div class="line">iptables-save</div></pre></td></tr></table></figure></p>
<h2 id="ss-panel-的多节点配置"><a href="#ss-panel-的多节点配置" class="headerlink" title="ss-panel 的多节点配置"></a>ss-panel 的多节点配置</h2><p>其实多节点也没咋玄乎，说白了就是多个后端共用一个前端而已。而且我们的后端是使用 Mu API 来与前端进行交互的，所以多节点的配置就更简单了：只要把所有后端的 config.py 中的 API_URL 和 API_PASS 都改成一样即可（记得 API_ENABLED = True）。</p>
<h2 id="ss服务端安装libsodium支持chacha20"><a href="#ss服务端安装libsodium支持chacha20" class="headerlink" title="ss服务端安装libsodium支持chacha20"></a>ss服务端安装libsodium支持chacha20</h2><p>centos：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">yum -y groupinstall &quot;Development Tools&quot;</div><div class="line">wget https://github.com/jedisct1/libsodium/releases/download/1.0.11/libsodium-1.0.11.tar.gz</div><div class="line">tar xf libsodium-1.0.11.tar.gz &amp;&amp; cd libsodium-1.0.11</div><div class="line">./configure &amp;&amp; make -j2 &amp;&amp; make install</div><div class="line">echo /usr/local/lib &gt; /etc/ld.so.conf.d/usr_local_lib.conf</div><div class="line">ldconfig</div></pre></td></tr></table></figure></p>
<p>ubuntu/debian：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">apt-get install build-essential</div><div class="line">wget https://github.com/jedisct1/libsodium/releases/download/1.0.11/libsodium-1.0.11.tar.gz</div><div class="line">tar xf libsodium-1.0.11.tar.gz &amp;&amp; cd libsodium-1.0.11</div><div class="line">./configure &amp;&amp; make -j2 &amp;&amp; make install</div><div class="line">ldconfig</div></pre></td></tr></table></figure></p>
<hr>
<p>参考链接：<br><a href="https://blessing.studio/build-shadowsocks-sharing-site-with-ss-panel/" target="_blank" rel="external">https://blessing.studio/build-shadowsocks-sharing-site-with-ss-panel/</a><br><a href="https://www.echoteen.com/yijian-sspanel-many-user.html/comment-page-1/#comments" target="_blank" rel="external">https://www.echoteen.com/yijian-sspanel-many-user.html/comment-page-1/#comments</a><br><a href="https://github.com/sendya/shadowsocks-panel/wiki/Shadowsocks-Panel-%E9%9D%A2%E6%9D%BF%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B" target="_blank" rel="external">https://github.com/sendya/shadowsocks-panel/wiki/Shadowsocks-Panel-%E9%9D%A2%E6%9D%BF%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;因为阿松同学找我要ss账号，因此我大概花了一天时间搞了搞ss-panel，顺便做个记录吧。网上那么多教程有些是写得笼统，有些还是瞎复制的。由此萌生了想要写一篇配置 ss-panel 和 ss-manyuser 的教程，希望能够帮到需要的人。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
    
    </summary>
    
      <category term="shadowsocks" scheme="http://feiyang.li/categories/shadowsocks/"/>
    
    
      <category term="GFW" scheme="http://feiyang.li/tags/GFW/"/>
    
      <category term="Linux" scheme="http://feiyang.li/tags/Linux/"/>
    
      <category term="教程" scheme="http://feiyang.li/tags/%E6%95%99%E7%A8%8B/"/>
    
      <category term="vps" scheme="http://feiyang.li/tags/vps/"/>
    
  </entry>
  
  <entry>
    <title>Coursera ML(7)-Programming Exercise 3</title>
    <link href="http://feiyang.li/2017/05/02/Coursera-ML-7-Programming-Exercise-3/index.html"/>
    <id>http://feiyang.li/2017/05/02/Coursera-ML-7-Programming-Exercise-3/index.html</id>
    <published>2017-05-02T10:01:38.000Z</published>
    <updated>2017-05-02T10:04:58.026Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><script src="/assets/js/DPlayer.min.js"> </script><blockquote>
<p>machine-learning-ex3.zip <a href="http://home.ustc.edu.cn/~mmmwhy/machine-learning-ex3.zip" target="_blank" rel="external">下载链接</a>，第四周的课程相对来说比较简单，大致介绍了神经网络相关内容。</p>
</blockquote>
<hr>
<a id="more"></a>
<p>注意，官方用的是matlab，这里我用的全部是python，代码是不一样的，更不能当做作业提交。</p>
<hr>
<h1 id="Programming-Exercise-3-Multi-class-Classification-and-Neural-Networks"><a href="#Programming-Exercise-3-Multi-class-Classification-and-Neural-Networks" class="headerlink" title="Programming Exercise 3 - Multi-class Classification and Neural Networks"></a>Programming Exercise 3 - Multi-class Classification and Neural Networks</h1><h2 id="题目介绍"><a href="#题目介绍" class="headerlink" title="题目介绍"></a>题目介绍</h2><p>For this exercise, you will use logistic regression and neural networks to recognize handwritten digits (from 0 to 9). </p>
<p><strong>ex3data1.mat</strong>提供了一个训练集，X包含5000个长度为400的向量，每个向量可以展示为一个20*20的图像。Y内为图像所对应的数字。</p>
<h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># %load ../../standard_import.txt</span></div><div class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</div><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"><span class="keyword">import</span> matplotlib <span class="keyword">as</span> mpl</div><div class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</div><div class="line"></div><div class="line"><span class="comment"># load MATLAB files</span></div><div class="line"><span class="keyword">from</span> scipy.io <span class="keyword">import</span> loadmat</div><div class="line"><span class="keyword">from</span> scipy.optimize <span class="keyword">import</span> minimize</div><div class="line"></div><div class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LogisticRegression</div><div class="line"></div><div class="line">pd.set_option(<span class="string">'display.notebook_repr_html'</span>, <span class="keyword">False</span>)</div><div class="line">pd.set_option(<span class="string">'display.max_columns'</span>, <span class="keyword">None</span>)</div><div class="line">pd.set_option(<span class="string">'display.max_rows'</span>, <span class="number">150</span>)</div><div class="line">pd.set_option(<span class="string">'display.max_seq_items'</span>, <span class="keyword">None</span>)</div><div class="line"> </div><div class="line"><span class="comment">#%config InlineBackend.figure_formats = &#123;'pdf',&#125;</span></div><div class="line">%matplotlib inline</div><div class="line"></div><div class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</div><div class="line">sns.set_context(<span class="string">'notebook'</span>)</div><div class="line">sns.set_style(<span class="string">'white'</span>)</div></pre></td></tr></table></figure>
<h3 id="Load-MATLAB-datafiles"><a href="#Load-MATLAB-datafiles" class="headerlink" title="Load MATLAB datafiles"></a>Load MATLAB datafiles</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">data = loadmat(<span class="string">'data/ex3data1.mat'</span>)</div><div class="line">data.keys()</div></pre></td></tr></table></figure>
<pre><code>dict_keys([&apos;__header__&apos;, &apos;__version__&apos;, &apos;__globals__&apos;, &apos;X&apos;, &apos;y&apos;])
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">weights = loadmat(<span class="string">'data/ex3weights.mat'</span>)</div><div class="line">weights.keys()</div></pre></td></tr></table></figure>
<pre><code>dict_keys([&apos;__header__&apos;, &apos;__version__&apos;, &apos;__globals__&apos;, &apos;Theta1&apos;, &apos;Theta2&apos;])
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">y = data[<span class="string">'y'</span>]</div><div class="line"><span class="comment"># Add constant for intercept</span></div><div class="line">X = np.c_[np.ones((data[<span class="string">'X'</span>].shape[<span class="number">0</span>],<span class="number">1</span>)), data[<span class="string">'X'</span>]]</div><div class="line"></div><div class="line">print(<span class="string">'X: &#123;&#125; (with intercept)'</span>.format(X.shape))</div><div class="line">print(<span class="string">'y: &#123;&#125;'</span>.format(y.shape))</div></pre></td></tr></table></figure>
<pre><code>X: (5000, 401) (with intercept)
y: (5000, 1)
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">theta1, theta2 = weights[<span class="string">'Theta1'</span>], weights[<span class="string">'Theta2'</span>]</div><div class="line"></div><div class="line">print(<span class="string">'theta1: &#123;&#125;'</span>.format(theta1.shape))</div><div class="line">print(<span class="string">'theta2: &#123;&#125;'</span>.format(theta2.shape))</div></pre></td></tr></table></figure>
<pre><code>theta1: (25, 401)
theta2: (10, 26)
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">sample = np.random.choice(X.shape[<span class="number">0</span>], <span class="number">20</span>)</div><div class="line">plt.imshow(X[sample,<span class="number">1</span>:].reshape(<span class="number">-1</span>,<span class="number">20</span>).T)</div><div class="line">plt.axis(<span class="string">'off'</span>);</div></pre></td></tr></table></figure>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170502/171813517.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<h2 id="Multiclass-Classification"><a href="#Multiclass-Classification" class="headerlink" title="Multiclass Classification"></a>Multiclass Classification</h2><h3 id="Logistic-regression-hypothesis"><a href="#Logistic-regression-hypothesis" class="headerlink" title="Logistic regression hypothesis"></a>Logistic regression hypothesis</h3> $$ h_{\theta}(x) = g(\theta^{T}x)$$ 
 $$ g(z)=\frac{1}{1+e^{−z}} $$ 
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sigmoid</span><span class="params">(z)</span>:</span></div><div class="line">    <span class="keyword">return</span>(<span class="number">1</span> / (<span class="number">1</span> + np.exp(-z)))</div></pre></td></tr></table></figure>
<h3 id="Regularized-Cost-Function"><a href="#Regularized-Cost-Function" class="headerlink" title="Regularized Cost Function"></a>Regularized Cost Function</h3> $$ J(\theta) = \frac{1}{m}\sum_{i=1}^{m}\big[-y^{(i)}\, log\,( h_\theta\,(x^{(i)}))-(1-y^{(i)})\,log\,(1-h_\theta(x^{(i)}))\big] + \frac{\lambda}{2m}\sum_{j=1}^{n}\theta_{j}^{2}$$ 
<h3 id="Vectorized-Cost-Function"><a href="#Vectorized-Cost-Function" class="headerlink" title="Vectorized Cost Function"></a>Vectorized Cost Function</h3> $$ J(\theta) = \frac{1}{m}\big((\,log\,(g(X\theta))^Ty+(\,log\,(1-g(X\theta))^T(1-y)\big) + \frac{\lambda}{2m}\sum_{j=1}^{n}\theta_{j}^{2}$$ 
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">lrcostFunctionReg</span><span class="params">(theta, reg, X, y)</span>:</span></div><div class="line">    m = y.size</div><div class="line">    h = sigmoid(X.dot(theta))</div><div class="line">    </div><div class="line">    J = <span class="number">-1</span>*(<span class="number">1</span>/m)*(np.log(h).T.dot(y)+np.log(<span class="number">1</span>-h).T.dot(<span class="number">1</span>-y)) + (reg/(<span class="number">2</span>*m))*np.sum(np.square(theta[<span class="number">1</span>:]))</div><div class="line">    </div><div class="line">    <span class="keyword">if</span> np.isnan(J[<span class="number">0</span>]):</div><div class="line">        <span class="keyword">return</span>(np.inf)</div><div class="line">    <span class="keyword">return</span>(J[<span class="number">0</span>])</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">lrgradientReg</span><span class="params">(theta, reg, X,y)</span>:</span></div><div class="line">    m = y.size</div><div class="line">    h = sigmoid(X.dot(theta.reshape(<span class="number">-1</span>,<span class="number">1</span>)))</div><div class="line">      </div><div class="line">    grad = (<span class="number">1</span>/m)*X.T.dot(h-y) + (reg/m)*np.r_[[[<span class="number">0</span>]],theta[<span class="number">1</span>:].reshape(<span class="number">-1</span>,<span class="number">1</span>)]</div><div class="line">        </div><div class="line">    <span class="keyword">return</span>(grad.flatten())</div></pre></td></tr></table></figure>
<h1 id="One-vs-all"><a href="#One-vs-all" class="headerlink" title="One-vs-all"></a>One-vs-all</h1><h2 id="One-vs-all-Classification"><a href="#One-vs-all-Classification" class="headerlink" title="One-vs-all Classification"></a>One-vs-all Classification</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">oneVsAll</span><span class="params">(features, classes, n_labels, reg)</span>:</span></div><div class="line">    initial_theta = np.zeros((X.shape[<span class="number">1</span>],<span class="number">1</span>))  <span class="comment"># 401x1</span></div><div class="line">    all_theta = np.zeros((n_labels, X.shape[<span class="number">1</span>])) <span class="comment">#10x401</span></div><div class="line"></div><div class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> np.arange(<span class="number">1</span>, n_labels+<span class="number">1</span>):</div><div class="line">        res = minimize(lrcostFunctionReg, initial_theta, args=(reg, features, (classes == c)*<span class="number">1</span>), method=<span class="keyword">None</span>,</div><div class="line">                       jac=lrgradientReg, options=&#123;<span class="string">'maxiter'</span>:<span class="number">50</span>&#125;)</div><div class="line">        all_theta[c<span class="number">-1</span>] = res.x</div><div class="line">    <span class="keyword">return</span>(all_theta)</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">theta = oneVsAll(X, y, <span class="number">10</span>, <span class="number">0.1</span>)</div></pre></td></tr></table></figure>
<h2 id="One-vs-all-Prediction"><a href="#One-vs-all-Prediction" class="headerlink" title="One-vs-all Prediction"></a>One-vs-all Prediction</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">predictOneVsAll</span><span class="params">(all_theta, features)</span>:</span></div><div class="line">    probs = sigmoid(X.dot(all_theta.T))</div><div class="line">        </div><div class="line">    <span class="comment"># Adding one because Python uses zero based indexing for the 10 columns (0-9),</span></div><div class="line">    <span class="comment"># while the 10 classes are numbered from 1 to 10.</span></div><div class="line">    <span class="keyword">return</span>(np.argmax(probs, axis=<span class="number">1</span>)+<span class="number">1</span>)</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">pred = predictOneVsAll(theta, X)</div><div class="line">print(<span class="string">'Training set accuracy: &#123;&#125; %'</span>.format(np.mean(pred == y.ravel())*<span class="number">100</span>))</div></pre></td></tr></table></figure>
<pre><code>Training set accuracy: 93.24 %
</code></pre><h2 id="Multiclass-Logistic-Regression-with-scikit-learn"><a href="#Multiclass-Logistic-Regression-with-scikit-learn" class="headerlink" title="Multiclass Logistic Regression with scikit-learn"></a>Multiclass Logistic Regression with scikit-learn</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">clf = LogisticRegression(C=<span class="number">10</span>, penalty=<span class="string">'l2'</span>, solver=<span class="string">'liblinear'</span>)</div><div class="line"><span class="comment"># Scikit-learn fits intercept automatically, so we exclude first column with 'ones' from X when fitting.</span></div><div class="line">clf.fit(X[:,<span class="number">1</span>:],y.ravel())</div></pre></td></tr></table></figure>
<pre><code>LogisticRegression(C=10, class_weight=None, dual=False, fit_intercept=True,
          intercept_scaling=1, max_iter=100, multi_class=&apos;ovr&apos;, n_jobs=1,
          penalty=&apos;l2&apos;, random_state=None, solver=&apos;liblinear&apos;, tol=0.0001,
          verbose=0, warm_start=False)
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">pred2 = clf.predict(X[:,<span class="number">1</span>:])</div><div class="line">print(<span class="string">'Training set accuracy: &#123;&#125; %'</span>.format(np.mean(pred2 == y.ravel())*<span class="number">100</span>))</div></pre></td></tr></table></figure>
<pre><code>Training set accuracy: 96.5 %
</code></pre><h1 id="Neural-Networks"><a href="#Neural-Networks" class="headerlink" title="Neural Networks"></a>Neural Networks</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">predict</span><span class="params">(theta_1, theta_2, features)</span>:</span></div><div class="line">    z2 = theta_1.dot(features.T)</div><div class="line">    a2 = np.c_[np.ones((data[<span class="string">'X'</span>].shape[<span class="number">0</span>],<span class="number">1</span>)), sigmoid(z2).T]</div><div class="line">    </div><div class="line">    z3 = a2.dot(theta_2.T)</div><div class="line">    a3 = sigmoid(z3)</div><div class="line">        </div><div class="line">    <span class="keyword">return</span>(np.argmax(a3, axis=<span class="number">1</span>)+<span class="number">1</span>)</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">pred = predict(theta1, theta2, X)</div><div class="line">print(<span class="string">'Training set accuracy: &#123;&#125; %'</span>.format(np.mean(pred == y.ravel())*<span class="number">100</span>))</div></pre></td></tr></table></figure>
<pre><code>Training set accuracy: 97.52 %
</code></pre><h1 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h1><h2 id="展示图片"><a href="#展示图片" class="headerlink" title="展示图片"></a>展示图片</h2><p>因为给的数据是矩阵的形式，所以需要分为单个向量，重新设置形状。然后展示出来，跟<a href="http://feiyang.li/2017/03/17/python-mnist/index.html">手写字体识别</a>是很像。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">%matplotlib inline</div><div class="line"><span class="keyword">import</span> scipy.io <span class="keyword">as</span> sio </div><div class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</div><div class="line">matfn=<span class="string">'C:/Users/wing/Documents/MATLAB/ex3/ex3data1.mat'</span>  </div><div class="line">data=sio.loadmat(matfn)  </div><div class="line">im = data[<span class="string">'X'</span>][<span class="number">0</span>]</div><div class="line">im = im.reshape(<span class="number">20</span>,<span class="number">20</span>)</div><div class="line">plt.imshow(im , cmap=<span class="string">'gray'</span>)</div></pre></td></tr></table></figure>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170416/135847233.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="mark" title="">
                </div>
                <div class="image-caption">mark</div>
            </figure>
<p>如果想要一次展示多个图像呢，写个循环就可以了。不过太多的话，可能就看不清了。。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">im = []</div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">500</span>):</div><div class="line">    plt.subplot(<span class="number">10</span>, <span class="number">50</span>, i + <span class="number">1</span>)</div><div class="line">    temp = data[<span class="string">'X'</span>][i]</div><div class="line">    im.append(temp.reshape(<span class="number">20</span>,<span class="number">20</span>))</div><div class="line">    plt.imshow(im[i], cmap=<span class="string">'gray'</span>)</div><div class="line">plt.show()</div></pre></td></tr></table></figure></p>
<h2 id="reshape内-1的用法"><a href="#reshape内-1的用法" class="headerlink" title="reshape内-1的用法"></a><strong>reshape</strong>内-1的用法</h2><p>官方文档：numpy.reshape - NumPy v1.11 Manual</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>a = np.array([[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>], [<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>]])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>np.reshape(a, (<span class="number">3</span>,<span class="number">-1</span>))  <span class="comment"># the unspecified value is inferred to be 2</span></div><div class="line">array([[<span class="number">1</span>, <span class="number">2</span>],</div><div class="line">       [<span class="number">3</span>, <span class="number">4</span>],</div><div class="line">       [<span class="number">5</span>, <span class="number">6</span>]])</div></pre></td></tr></table></figure>
<p>-1表示我懒得计算该填什么数字，由python通过a和其他的值推测出来。</p>
<h2 id="LogisticRegression"><a href="#LogisticRegression" class="headerlink" title="LogisticRegression"></a>LogisticRegression</h2><p><code>from sklearn.linear_model import LogisticRegression</code></p>
<p><a href="http://www.cnblogs.com/xupeizhi/archive/2013/07/05/3174703.html" target="_blank" rel="external">http://www.cnblogs.com/xupeizhi/archive/2013/07/05/3174703.html</a><br><a href="http://scikit-learn.org/stable/index.html" target="_blank" rel="external">http://scikit-learn.org/stable/index.html</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;machine-learning-ex3.zip &lt;a href=&quot;http://home.ustc.edu.cn/~mmmwhy/machine-learning-ex3.zip&quot;&gt;下载链接&lt;/a&gt;，第四周的课程相对来说比较简单，大致介绍了神经网络相关内容。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
    
    </summary>
    
      <category term="Coursera ML" scheme="http://feiyang.li/categories/Coursera-ML/"/>
    
    
      <category term="Python" scheme="http://feiyang.li/tags/Python/"/>
    
      <category term="Machine Learning" scheme="http://feiyang.li/tags/Machine-Learning/"/>
    
      <category term="读书笔记" scheme="http://feiyang.li/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>Coursera ML(6)-Neural Networks Representation</title>
    <link href="http://feiyang.li/2017/04/15/Coursera-ML-6-Neural-Networks-Representation/index.html"/>
    <id>http://feiyang.li/2017/04/15/Coursera-ML-6-Neural-Networks-Representation/index.html</id>
    <published>2017-04-15T13:42:33.000Z</published>
    <updated>2017-04-15T13:47:22.229Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><script src="/assets/js/DPlayer.min.js"> </script><blockquote>
<p>神经网络模型</p>
</blockquote>
<hr>
<a id="more"></a>
<h1 id="Neural-Networks-Model"><a href="#Neural-Networks-Model" class="headerlink" title="Neural Networks Model"></a>Neural Networks Model</h1><h2 id="A-single-neuron-model-logistic-unit"><a href="#A-single-neuron-model-logistic-unit" class="headerlink" title="A single neuron model: logistic unit"></a>A single neuron model: logistic unit</h2> $$\begin{bmatrix}x_0 \newline x_1 \newline x_2 \newline \end{bmatrix}\rightarrow\begin{bmatrix}\ \ \ \newline \end{bmatrix}\rightarrow h_\theta(x)$$ 
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170415/171348080.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<ul>
<li>Takes 3+1 inputs(the extra input called bias is just like $θ_0$ in logistic regression, not shown in picture).</li>
<li>Both input and output could be represented as vectors, in which each unit has its own parameters $θ$</li>
<li>All the units in the same layer take the same input $x$, as the pic shows.</li>
<li>Each unit has only one output: $sigmoid(θ^Tx)$. Of course there’re other choices for sigmoid function.</li>
</ul>
<h2 id="Neural-Networks"><a href="#Neural-Networks" class="headerlink" title="Neural Networks"></a>Neural Networks</h2> $$\begin{bmatrix}x_0 \newline x_1 \newline x_2 \newline x_3\end{bmatrix}\rightarrow\begin{bmatrix}a_1^{(2)} \newline a_2^{(2)} \newline a_3^{(2)} \newline \end{bmatrix}\rightarrow h_\theta(x)$$ 
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170415/202821288.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<p>其中<br> $$\begin{align*}& a_i^{(j)} = \text{"activation" of unit $i$ in layer $j$} \newline& \Theta^{(j)} = \text{matrix of weights controlling function mapping from layer $j$ to layer $j+1$}\end{align*}$$ </p>
<h1 id="Calculation-from-one-layer-to-the-next"><a href="#Calculation-from-one-layer-to-the-next" class="headerlink" title="Calculation from one layer to the next"></a>Calculation from one layer to the next</h1><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170415/212357016.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<p>In the picture above, we have the networks from layer j to layer j+1, in which layer j has 3(+1) units while layer j+1 has 3 layers. Let $s_j=3$, $s_j+1=3$</p>
<ul>
<li>$α^{(j)}$ : Output of the $j_{th}$ layer. $s_j+1$ dimension vector.</li>
<li> $θ_i^{(j)}$  : Parameters in the $i<em>{th}$ unit of $(j+1)</em>{th}$ layer. $s_j+1$ dimension vector.</li>
<li> ${\theta^{(j)}} = \begin{bmatrix} \theta_1^{(j)} & \theta_2^{(j)} & \cdots & \theta_{s_(j + 1)}^{(j)} \end{bmatrix}^T$  : All the network parameters from $j<em>{th}$ layer to ${(j+1)}</em>{th}$ layer.</li>
<li>We have: $\alpha^{(j+1)} = sigmoid(\mathbf{\theta^{(j)}}\alpha^{(j)})$ add $\alpha_0^{(j+1)}$</li>
</ul>
<h1 id="Multiclass-Classification"><a href="#Multiclass-Classification" class="headerlink" title="Multiclass Classification"></a>Multiclass Classification</h1> <figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170415/212115423.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="分类器" title="">
                </div>
                <div class="image-caption">分类器</div>
            </figure>
<p>Each $y^{(i)}$ represents a different image corresponding to either a car, pedestrian, truck, or motorcycle. The inner layers, each provide us with some new information which leads to our final hypothesis function. The setup looks like:<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170415/212141965.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure></p>
<h1 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h1><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170415/203254413.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<p>Example: layer 1 has 2 input nodes and layer 2 has 4 activation nodes. Dimension of  $\Theta^{(1)}$ is going to be 4×3 where $s_j = 2$ and $s_{j+1} = 4$, so $s_{j+1} \times (s_j + 1) = 4 \times 3$$ </p>
<hr>
<p>今天苏州的天气真是闷热，实在是看不下去了。因此本小节笔记，有大段参考自 <a href="https://github.com/shawnau/shawnau.github.io/blob/master/2016-02-11-Neural-Networks-Representation.html" target="_blank" rel="external">shawnau.github.io</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;神经网络模型&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
    
    </summary>
    
      <category term="Coursera ML" scheme="http://feiyang.li/categories/Coursera-ML/"/>
    
    
      <category term="Python" scheme="http://feiyang.li/tags/Python/"/>
    
      <category term="Machine Learning" scheme="http://feiyang.li/tags/Machine-Learning/"/>
    
      <category term="读书笔记" scheme="http://feiyang.li/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>Coursera ML(5)-Logistic Regression and Regularization with Python</title>
    <link href="http://feiyang.li/2017/03/30/Coursera-ML-5-Programming-Exercise-2/index.html"/>
    <id>http://feiyang.li/2017/03/30/Coursera-ML-5-Programming-Exercise-2/index.html</id>
    <published>2017-03-30T04:46:00.000Z</published>
    <updated>2017-04-15T12:16:09.671Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><script src="/assets/js/DPlayer.min.js"> </script><blockquote>
<p><a href="http://feiyang.li/2017/03/26/Coursera-ML-3-Multivariate-Linear-Regression-python/index.html">线性回归算法</a>，可用于房屋价格的估计及股票市场分析。 <a href="https://www.coursera.org/learn/machine-learning/programming/ixFof/logistic-regression" target="_blank" rel="external">Logistic Regression</a> （逻辑回归）是当前业界比较常用的机器学习方法，用于估计某种事物的可能性。比如某用户购买某商品的可能性，某病人患有某种疾病的可能性，以及某广告被用户点击的可能性等。相关公式推导在<a href="http://feiyang.li/2017/03/27/Coursera-ML-4-Logistic-Regression/index.html">这里</a></p>
</blockquote>
<hr>
<a id="more"></a>
<p>Stanford coursera Andrew Ng 机器学习课程编程作业（Exercise 2），作业下载链接貌似被墙了，下载链接放这。<a href="http://home.ustc.edu.cn/~mmmwhy/machine-learning-ex2.zip" target="_blank" rel="external">http://home.ustc.edu.cn/~mmmwhy/machine-learning-ex2.zip</a></p>
<h1 id="预备知识"><a href="#预备知识" class="headerlink" title="预备知识"></a><a href="http://feiyang.li/2017/03/27/Coursera-ML-4-Logistic-Regression/">预备知识</a></h1><p>这里应该分为 正常、过拟合和欠拟合，三种情况。</p>
<ul>
<li>Cost Function $$J(\theta) = - \frac{1}{m} \sum_{i=1}^m \large[ y^{(i)}\ \log (h_\theta (x^{(i)})) + (1 - y^{(i)})\ \log (1 - h_\theta(x^{(i)}))\large] + \frac{\lambda}{2m}\sum_{j=1}^n \theta_j^2$$ </li>
<li><p>Gradient Descent</p>
 $$\begin{align*} & \text{Repeat}\ \lbrace \newline & \ \ \ \ \theta_0 := \theta_0 - \alpha\ \frac{1}{m}\ \sum_{i=1}^m (h_\theta(x^{(i)}) - y^{(i)})x_0^{(i)} \newline & \ \ \ \ \theta_j := \theta_j - \alpha\ \left[ \left( \frac{1}{m}\ \sum_{i=1}^m (h_\theta(x^{(i)}) - y^{(i)})x_j^{(i)} \right) + \frac{\lambda}{m}\theta_j \right] &\ \ \ \ \ \ \ \ \ \ j \in \lbrace 1,2...n\rbrace\newline & \rbrace \end{align*}$$ 
</li>
<li><p>Grad</p>
 $$Grad =  \frac{1}{m}\ \sum_{i=1}^m (h_\theta(x^{(i)}) - y^{(i)})x_j^{(i)}+ \frac{\lambda}{m}\theta_j$$ 
</li>
</ul>
<p>后边有一个$\frac{\lambda}{2m}\sum_{j=1}^n \theta_j^2$和$\frac{\lambda}{m}\theta_j$小尾巴，作用就是进行 Regularization，防止拟合过度。</p>
<h1 id="Logistic-Regression"><a href="#Logistic-Regression" class="headerlink" title="Logistic Regression"></a>Logistic Regression</h1><h2 id="题目介绍"><a href="#题目介绍" class="headerlink" title="题目介绍"></a>题目介绍</h2><ul>
<li>you will build a logistic regression model to predict whether a student gets admitted into a university.（根据各科目分数预测该学生是否能录取）</li>
<li>For each training example, you have the applicant’s scores on two exams and the admissions decision.</li>
<li>Your task is to build a <strong>classication model</strong> that estimates an <strong>applicant’s probability of admission based the scores from those two exams.</strong></li>
</ul>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170327/203532750.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="dataset" title="">
                </div>
                <div class="image-caption">dataset</div>
            </figure>
<h2 id="python-code"><a href="#python-code" class="headerlink" title="python code"></a>python code</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> numpy <span class="keyword">import</span> *</div><div class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</div><div class="line"><span class="keyword">from</span> scipy <span class="keyword">import</span> optimize</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">init</span><span class="params">(path)</span>:</span></div><div class="line">    X,y = load_dataset(path) <span class="comment"># 调用底下那个东西</span></div><div class="line">    m, n = shape(X)</div><div class="line">    initial_theta = zeros(n + <span class="number">1</span>)</div><div class="line">    <span class="keyword">return</span> X,y,m,n,initial_theta</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">load_dataset</span><span class="params">(path)</span>:</span></div><div class="line">    data = loadtxt(path, delimiter=<span class="string">','</span>)</div><div class="line">    X = data[:,:<span class="number">2</span>]</div><div class="line">    y = data[:, <span class="number">2</span>]</div><div class="line">    <span class="keyword">return</span> X,y</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">plotData</span><span class="params">(X,y)</span>:</span></div><div class="line">    plt.plot(X[y==<span class="number">1</span>][:,<span class="number">0</span>],X[y==<span class="number">1</span>][:,<span class="number">1</span>],<span class="string">'k+'</span>,linewidth=<span class="number">2</span>,)</div><div class="line">    plt.plot(X[y==<span class="number">0</span>][:,<span class="number">0</span>],X[y==<span class="number">0</span>][:,<span class="number">1</span>],<span class="string">'ko'</span>,color=<span class="string">'y'</span>,linewidth=<span class="number">2</span>)</div><div class="line">    plt.xlabel(<span class="string">'科目一成绩'</span>, fontproperties=<span class="string">'SimHei'</span>)</div><div class="line">    plt.ylabel(<span class="string">'科目二成绩'</span>, fontproperties=<span class="string">'SimHei'</span>)</div><div class="line">    plt.title(<span class="string">'分数与录取的关系'</span>, fontproperties=<span class="string">'SimHei'</span>)</div><div class="line">    </div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sigmoid</span><span class="params">(X, theta)</span>:</span></div><div class="line">    <span class="keyword">return</span> <span class="number">1</span> / (<span class="number">1</span> + exp(-dot(X, theta)))</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_cost</span><span class="params">(theta, X, y)</span>:</span></div><div class="line">    J = sum((-y*log(sigmoid(X,theta)) - (<span class="number">1</span>-y)*log(<span class="number">1</span>-sigmoid(X,theta))))/len(X)</div><div class="line">    <span class="keyword">return</span> J</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_grad</span><span class="params">(theta, X, y)</span>:</span></div><div class="line">    <span class="keyword">return</span> (sigmoid(X,theta) - mat(y))*X*(<span class="number">1</span>/m)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">plotDecisionBoundary</span><span class="params">(theta, X, y)</span>:</span></div><div class="line">    plotData(X[:, <span class="number">1</span>:<span class="number">3</span>], y)</div><div class="line">    <span class="keyword">if</span> X.shape[<span class="number">1</span>] &lt;= <span class="number">3</span>:</div><div class="line">        plot_x = r_[X[:,<span class="number">2</span>].min()<span class="number">-2</span>,  X[:,<span class="number">2</span>].max()+<span class="number">2</span>]</div><div class="line">        plot_y = - (theta[<span class="number">1</span>]*plot_x + theta[<span class="number">0</span>])/theta[<span class="number">2</span>]</div><div class="line">        plt.plot(plot_x, plot_y)</div><div class="line">        plt.axis([<span class="number">30</span>,<span class="number">100</span>,<span class="number">30</span>,<span class="number">100</span>])</div><div class="line">        plt.legend([<span class="string">'Accepted'</span>, <span class="string">'Not Accepted'</span>, <span class="string">'Decision Boundary'</span>])</div><div class="line">        plt.show()</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        <span class="keyword">pass</span></div><div class="line"></div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">predict</span><span class="params">(theta, X)</span>:</span>  </div><div class="line">    prob = sigmoid([<span class="number">1</span>,<span class="number">45</span>,<span class="number">85</span>] , result[<span class="number">0</span>])</div><div class="line">    <span class="keyword">return</span> prob</div><div class="line">    </div><div class="line"><span class="keyword">if</span> __name__==<span class="string">"__main__"</span>:</div><div class="line">    path = <span class="string">'C:\\Users\\wing\\Desktop\\machine-learning-ex2\\ex2\\ex2data1.txt'</span></div><div class="line">    X,y,m,n,initial_theta = init(path)</div><div class="line">    X = column_stack((ones(m), X))</div><div class="line">    cost = get_cost(initial_theta, X, y)</div><div class="line">    grad = get_grad(initial_theta, X, y)</div><div class="line"></div><div class="line">    <span class="comment"># obtain the optimal theta</span></div><div class="line">    result = optimize.fmin_tnc(func=get_cost, x0=initial_theta, fprime=get_grad, args=(X, y))  </div><div class="line">    get_cost(result[<span class="number">0</span>], X, y)  </div><div class="line">    <span class="comment"># result = (array([-25.16131863,   0.20623159,   0.20147149]), 36, 0)</span></div><div class="line">    <span class="comment"># get_cost(result[0], X, y)  = 0.20349770158947464</span></div><div class="line">    plotDecisionBoundary(result[<span class="number">0</span>], X, y)</div><div class="line">    print(<span class="string">'For a student with scores 45 and 85, we predict an admission '</span> \</div><div class="line">         <span class="string">'probability of %f\n'</span>%predict(result[<span class="number">0</span>], X))</div><div class="line"></div><div class="line"><span class="comment"># For a student with scores 45 and 85, we predict an admission probability of 0.776291</span></div></pre></td></tr></table></figure>
<h2 id="运行结果"><a href="#运行结果" class="headerlink" title="运行结果"></a>运行结果</h2><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170330/121908473.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<p>最后进行了一个测试，如果一个学生两门考试成绩，一门45分，另外一门85分，那么他被录取的概率为77%。幸亏是在外国，在中国这分数，连大专都考不上。</p>
<h1 id="Logistic-Regression-and-Regularization"><a href="#Logistic-Regression-and-Regularization" class="headerlink" title="Logistic Regression and Regularization"></a>Logistic Regression and Regularization</h1><h2 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h2><ul>
<li>Suppose you are the product manager of the factory and you have the test results for some microchips on two dierent tests.</li>
<li>对于一批产品，有两个检测环节，通过检测结果判断产品是否合格。比如，宜家会有三十年床垫保证，那么如果确保床垫合格（用30年），我们只能通过一些检测，来推测产品是否合格。</li>
</ul>
<h2 id="python-code-1"><a href="#python-code-1" class="headerlink" title="python code"></a>python code</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> numpy <span class="keyword">import</span> *</div><div class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</div><div class="line"><span class="keyword">from</span> scipy <span class="keyword">import</span> optimize</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">init</span><span class="params">(path)</span>:</span></div><div class="line">    X,y = load_dataset(path)</div><div class="line">    dataplot(X,y)</div><div class="line">    X = map_feature(X[:,<span class="number">0</span>], X[:,<span class="number">1</span>])</div><div class="line">    initial_theta = zeros(size(X[<span class="number">1</span>]))</div><div class="line">    lam = <span class="number">1</span></div><div class="line">    <span class="keyword">return</span> X,y,initial_theta,lam</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">load_dataset</span><span class="params">(path)</span>:</span></div><div class="line">    data = loadtxt(path, delimiter=<span class="string">','</span>)</div><div class="line">    X = data[:,:<span class="number">2</span>]</div><div class="line">    y = data[:, <span class="number">2</span>]</div><div class="line">    <span class="keyword">return</span> X,y</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">dataplot</span><span class="params">(X,y)</span>:</span></div><div class="line">    plt.plot(X[y==<span class="number">1</span>][:,<span class="number">0</span>],X[y==<span class="number">1</span>][:,<span class="number">1</span>],<span class="string">'k+'</span>,linewidth=<span class="number">2</span>)</div><div class="line">    plt.plot(X[y==<span class="number">0</span>][:,<span class="number">0</span>],X[y==<span class="number">0</span>][:,<span class="number">1</span>],<span class="string">'ko'</span>,color=<span class="string">'y'</span>,linewidth=<span class="number">2</span>)</div><div class="line">    plt.legend([ <span class="string">'y = 1'</span>,<span class="string">'y = 0'</span>])</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sigmoid</span><span class="params">(X, theta)</span>:</span></div><div class="line">    <span class="keyword">return</span> <span class="number">1</span> / (<span class="number">1</span> + exp(-dot(X, theta)))</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">map_feature</span><span class="params">(x1, x2)</span>:</span></div><div class="line">    <span class="comment">#X1, X2, X1 ** 2, X2 ** 2, X1*X2, X1*X2 ** 2, etc...</span></div><div class="line"></div><div class="line">    x1.shape = (x1.size, <span class="number">1</span>)</div><div class="line">    x2.shape = (x2.size, <span class="number">1</span>)</div><div class="line">    degree = <span class="number">6</span></div><div class="line">    out = ones(shape=(x1[:, <span class="number">0</span>].size, <span class="number">1</span>))</div><div class="line">    m, n = out.shape</div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, degree + <span class="number">1</span>):</div><div class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(i + <span class="number">1</span>):</div><div class="line">            r = (x1 ** (i - j)) * (x2 ** j)</div><div class="line">            out = append(out, r, axis=<span class="number">1</span>)</div><div class="line">    <span class="keyword">return</span> out</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_cost</span><span class="params">(theta, X, y,lam)</span>:</span></div><div class="line">    hx = sigmoid(X,theta)</div><div class="line">    thetaR = theta[<span class="number">1</span>:]</div><div class="line">    J = sum((-y*log(hx) - (<span class="number">1</span>-y)*log(<span class="number">1</span>-hx)))/len(X) \</div><div class="line">        + (lam / (<span class="number">2.0</span> * len(X))) * (thetaR.T.dot(thetaR))</div><div class="line">    <span class="keyword">return</span> J</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_grad</span><span class="params">(theta, X, y,lam)</span>:</span></div><div class="line">    reg = (lam/len(y))*theta</div><div class="line">    reg[<span class="number">0</span>] = <span class="number">0</span></div><div class="line">    grad = X.T.dot(sigmoid(X,theta)-y)/len(y)+reg</div><div class="line">    <span class="keyword">return</span> grad</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">plotDecisionBoundary</span><span class="params">(theta,lam)</span>:</span></div><div class="line">    u = linspace(<span class="number">-1</span>, <span class="number">1.5</span>, <span class="number">50</span>)</div><div class="line">    v = linspace(<span class="number">-1</span>, <span class="number">1.5</span>, <span class="number">50</span>)</div><div class="line">    z = zeros(shape=(len(u), len(v)))</div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(u)):</div><div class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(len(v)):</div><div class="line">            z[i, j] = (map_feature(array(u[i]), array(v[j])).dot(array(theta)))</div><div class="line">    z = z.T</div><div class="line">    plt.contour(u, v, z)</div><div class="line">    plt.title(<span class="string">'lambda = %f'</span> % lam)</div><div class="line">    plt.xlabel(<span class="string">'Microchip Test 1'</span>)</div><div class="line">    plt.ylabel(<span class="string">'Microchip Test 2'</span>)</div><div class="line">    plt.axis([<span class="number">-0.85</span>,<span class="number">1.1</span>,<span class="number">-0.85</span>,<span class="number">1.1</span>])</div><div class="line">    plt.legend([<span class="string">'y = 1'</span>, <span class="string">'y = 0'</span>, <span class="string">'Decision boundary'</span>])</div><div class="line">    plt.show()</div><div class="line">    </div><div class="line"><span class="keyword">if</span> __name__==<span class="string">"__main__"</span>:</div><div class="line">    path = <span class="string">'C:\\Users\\wing\\Desktop\\machine-learning-ex2\\ex2\\ex2data2.txt'</span></div><div class="line">    X,y,initial_theta,lam = init(path)</div><div class="line">    result = optimize.fmin_tnc(func=get_cost, x0=initial_theta, fprime=get_grad, args=(X, y,lam))  </div><div class="line">    plotDecisionBoundary(result[<span class="number">0</span>],lam)</div></pre></td></tr></table></figure>
<h2 id="运算结果"><a href="#运算结果" class="headerlink" title="运算结果"></a>运算结果</h2><ul>
<li>过拟合<br>lambda=0。不考虑 $\frac{\lambda}{2m}\sum_{j=1}^n \theta_j^2$和$\frac{\lambda}{m}\theta_j$ ，我们可以看到图像已经被拟合过度。这样的答案没有通用性<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170330/122914544.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure></li>
<li>欠拟合<br>lambda=10，欠拟合会导致数据的很多细节被抛弃。<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170330/123134133.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure></li>
<li>拟合较好<br>lambda=1，准确性到91%左右，这个准确率算低的了吧，还有很大上升空间。<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170330/123236964.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
</li>
</ul>
<h1 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h1><p><a href="http://news.ustc.edu.cn/xwbl/201412/t20141205_206292.html" target="_blank" rel="external">熊辉</a>上课的时候，说机器学习需要调参数，参数很不好调，需要使用者对数据有极高的敏感度。</p>
<p>参数lambda就是这种感觉，感觉真的是乱调一通，然后就发现，诶哟，好像还不错。</p>
<p>参考链接：<br><a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize.html" target="_blank" rel="external">scipy.optimize.minimize</a><br><a href="https://en.wikipedia.org/wiki/Logistic_regression" target="_blank" rel="external">Logistic regression</a><br><a href="http://www.johnwittenauer.net/machine-learning-exercises-in-python-part-3/" target="_blank" rel="external">Machine Learning Exercises In Python, Part 3</a><br><a href="http://aimotion.blogspot.com/2011/11/machine-learning-with-python-logistic.html" target="_blank" rel="external">machine-learning-with-python-logistic</a></p>
<hr>
<p>以上</p>
<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=421091970&auto=0&height=66"></iframe>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;http://feiyang.li/2017/03/26/Coursera-ML-3-Multivariate-Linear-Regression-python/index.html&quot;&gt;线性回归算法&lt;/a&gt;，可用于房屋价格的估计及股票市场分析。 &lt;a href=&quot;https://www.coursera.org/learn/machine-learning/programming/ixFof/logistic-regression&quot;&gt;Logistic Regression&lt;/a&gt; （逻辑回归）是当前业界比较常用的机器学习方法，用于估计某种事物的可能性。比如某用户购买某商品的可能性，某病人患有某种疾病的可能性，以及某广告被用户点击的可能性等。相关公式推导在&lt;a href=&quot;http://feiyang.li/2017/03/27/Coursera-ML-4-Logistic-Regression/index.html&quot;&gt;这里&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
    
    </summary>
    
      <category term="Coursera ML" scheme="http://feiyang.li/categories/Coursera-ML/"/>
    
    
      <category term="Python" scheme="http://feiyang.li/tags/Python/"/>
    
      <category term="Machine Learning" scheme="http://feiyang.li/tags/Machine-Learning/"/>
    
      <category term="读书笔记" scheme="http://feiyang.li/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>Coursera ML(4)-Logistic Regression</title>
    <link href="http://feiyang.li/2017/03/27/Coursera-ML-4-Logistic-Regression/index.html"/>
    <id>http://feiyang.li/2017/03/27/Coursera-ML-4-Logistic-Regression/index.html</id>
    <published>2017-03-27T11:13:38.000Z</published>
    <updated>2017-03-28T07:49:36.625Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><script src="/assets/js/DPlayer.min.js"> </script><blockquote>
<p>本节笔记对应<a href="https://www.coursera.org/learn/machine-learning/home/week/3" target="_blank" rel="external">第三周Coursera课程</a>  <strong>binary classification problem</strong></p>
</blockquote>
<hr>
<a id="more"></a>
<p><strong>Classification is not actually a linear function.</strong></p>
<h1 id="Classification-and-Representation"><a href="#Classification-and-Representation" class="headerlink" title="Classification and Representation"></a>Classification and Representation</h1><h2 id="Hypothesis-Representation"><a href="#Hypothesis-Representation" class="headerlink" title="Hypothesis Representation"></a>Hypothesis Representation</h2><ul>
<li>Sigmoid Function(or we called Logistic Function) $$\begin{align*}& h_\theta (x) = g ( \theta^T x ) \newline \newline& z = \theta^T x \newline& g(z) = \dfrac{1}{1 + e^{-z}}\end{align*}$$ 
Sigmoid Function 可以使输出值范围在$(0,1)$之间。$g(z)$对应的图为：<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170327/112711489.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
</li>
</ul>
<ul>
<li>$h_\theta(x)$ will give us the <strong>probability</strong> that our output is 1.</li>
<li>Some basic knowledge of discrete $$\begin{align*}& h_\theta(x) = P(y=1 | x ; \theta) = 1 - P(y=0 | x ; \theta) \newline& P(y = 0 | x;\theta) + P(y = 1 | x ; \theta) = 1\end{align*}$$ 
</li>
</ul>
<h2 id="Decision-Boundary"><a href="#Decision-Boundary" class="headerlink" title="Decision Boundary"></a>Decision Boundary</h2><ul>
<li>translate the output of the hypothesis function as follows: $$\begin{align*}& h_\theta(x) \geq 0.5 \rightarrow y = 1 \newline& h_\theta(x) < 0.5 \rightarrow y = 0 \newline\end{align*}$$ </li>
<li>From these statements we can now say: $$\begin{align*}& \theta^T x \geq 0 \Rightarrow y = 1 \newline& \theta^T x < 0 \Rightarrow y = 0 \newline\end{align*}$$ 
</li>
</ul>
<h1 id="Logistic-Regression-Model"><a href="#Logistic-Regression-Model" class="headerlink" title="Logistic Regression Model"></a>Logistic Regression Model</h1><h2 id="Cost-function-for-one-variable-hypothesis"><a href="#Cost-function-for-one-variable-hypothesis" class="headerlink" title="Cost function for one variable hypothesis"></a>Cost function for one variable hypothesis</h2><ul>
<li>To let the cost function be convex for gradient descent, it should be like this: $$J(\theta) = \dfrac{1}{m} \sum_{i=1}^m \mathrm{Cost}(h_\theta(x^{(i)}),y^{(i)})$$ 
</li>
</ul>
 $$Cost(h_\theta (x), y) =\begin{cases}-log(h_\theta (x)),  (y = 1) \\-log(1 - h_\theta (x)), (y = 0) \\\end{cases}$$ 
<ul>
<li>example $$\begin{align*}& \mathrm{Cost}(h_\theta(x),y) = 0 \text{ if } h_\theta(x) = y \newline & \mathrm{Cost}(h_\theta(x),y) \rightarrow \infty \text{ if } y = 0 \; \mathrm{and} \; h_\theta(x) \rightarrow 1 \newline & \mathrm{Cost}(h_\theta(x),y) \rightarrow \infty \text{ if } y = 1 \; \mathrm{and} \; h_\theta(x) \rightarrow 0 \newline \end{align*}$$ 
</li>
</ul>
<h2 id="Simplified-Cost-Function-and-Gradient-Descent"><a href="#Simplified-Cost-Function-and-Gradient-Descent" class="headerlink" title="Simplified Cost Function and Gradient Descent"></a>Simplified Cost Function and Gradient Descent</h2><ul>
<li><p>compress our cost function’s two conditional cases into one case:</p>
 $$\mathrm{Cost}(h_\theta(x),y) = - y \; \log(h_\theta(x)) - (1 - y) \log(1 - h_\theta(x))$$ 
</li>
<li><p>entire cost function</p>
 $$J(\theta) = - \frac{1}{m} \displaystyle \sum_{i=1}^m [y^{(i)}\log (h_\theta (x^{(i)})) + (1 - y^{(i)})\log (1 - h_\theta(x^{(i)}))]$$ 
</li>
</ul>
<h2 id="Gradient-Descent"><a href="#Gradient-Descent" class="headerlink" title="Gradient Descent"></a>Gradient Descent</h2><ul>
<li><p>the general form of gradient descent ，求偏导的得到$J(\theta)$的极值</p>
 $$\begin{align*}& Repeat \; \lbrace \newline & \; \theta_j := \theta_j - \alpha \dfrac{\partial}{\partial \theta_j}J(\theta) \newline & \rbrace\end{align*}$$ 
</li>
<li><p>using calculus </p>
 $$\frac{\partial}{\partial \theta_j} J(\theta) = \frac{1}{m}\sum\limits_{i=1}^{m}[(h_\theta (x^{(i)}) - y^{(i)})x_j^{(i)}]$$ 
</li>
<li><p>get</p>
 $$\begin{align*} & Repeat \; \lbrace \newline & \; \theta_j := \theta_j - \frac{\alpha}{m} \sum_{i=1}^m (h_\theta(x^{(i)}) - y^{(i)}) x_j^{(i)} \newline & \rbrace \end{align*}$$  
</li>
</ul>
<h2 id="Multiclass-Classification-One-vs-all"><a href="#Multiclass-Classification-One-vs-all" class="headerlink" title="Multiclass Classification: One-vs-all"></a>Multiclass Classification: One-vs-all</h2><ul>
<li>For more than 2 features of y, do logisitc regression for each feature separately</li>
<li>Train a logistic regression classifier $h_\theta(x)$ for each class￼ to predict the probability that ￼ ￼y = i￼ ￼. </li>
<li>To make a prediction on a new x, pick the class ￼that maximizes $ h_\theta (x) $<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170327/182954425.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
</li>
</ul>
<h1 id="Solving-the-Problem-of-Overfitting"><a href="#Solving-the-Problem-of-Overfitting" class="headerlink" title="Solving the Problem of Overfitting"></a>Solving the Problem of Overfitting</h1><h2 id="The-Problem-of-Overfitting"><a href="#The-Problem-of-Overfitting" class="headerlink" title="The Problem of Overfitting"></a>The Problem of Overfitting</h2><p><img src="http://cdn.mmmxcc.cn/blog/20170327/183239547.png" alt="mark"></p>
<h2 id="address-the-issue-of-overfitting"><a href="#address-the-issue-of-overfitting" class="headerlink" title="address the issue of overfitting"></a>address the issue of overfitting</h2><ul>
<li>Reduce the number of features:<ul>
<li>Manually select which features to keep.</li>
<li>Use a model selection algorithm (studied later in the course).</li>
</ul>
</li>
<li>Regularization:<ul>
<li>Keep all the features, but reduce the magnitude of parameters $θ_j$. </li>
<li>Regularization works well when we have a lot of slightly useful features.</li>
</ul>
</li>
</ul>
<h2 id="Cost-Function"><a href="#Cost-Function" class="headerlink" title="Cost Function"></a>Cost Function</h2><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170327/184128038.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<ul>
<li>in a single summation $$min_\theta\ \dfrac{1}{2m}\  \sum_{i=1}^m (h_\theta(x^{(i)}) - y^{(i)})^2 + \lambda\ \sum_{j=1}^n \theta_j^2$$ 
</li>
</ul>
<p>The λ, or lambda, is the regularization parameter. It determines how much the costs of our theta parameters are inflated.</p>
<h2 id="Regularized-Linear-Regression"><a href="#Regularized-Linear-Regression" class="headerlink" title="Regularized Linear Regression"></a>Regularized Linear Regression</h2><ul>
<li><p>Gradient Descent</p>
 $$\begin{align*} & \text{Repeat}\ \lbrace \newline & \ \ \ \ \theta_0 := \theta_0 - \alpha\ \frac{1}{m}\ \sum_{i=1}^m (h_\theta(x^{(i)}) - y^{(i)})x_0^{(i)} \newline & \ \ \ \ \theta_j := \theta_j - \alpha\ \left[ \left( \frac{1}{m}\ \sum_{i=1}^m (h_\theta(x^{(i)}) - y^{(i)})x_j^{(i)} \right) + \frac{\lambda}{m}\theta_j \right] &\ \ \ \ \ \ \ \ \ \ j \in \lbrace 1,2...n\rbrace\newline & \rbrace \end{align*}$$ 
</li>
<li><p>Normal Equation</p>
 $$\begin{align*}& \theta = \left( X^TX + \lambda \cdot L \right)^{-1} X^Ty \newline& \text{where}\ \ L = \begin{bmatrix} 0 & & & & \newline & 1 & & & \newline & & 1 & & \newline & & & \ddots & \newline & & & & 1 \newline\end{bmatrix}\end{align*}$$ 
<ul>
<li>L is a matrix with 0 at the top left and 1’s down the diagonal, with 0’s everywhere else. It should have dimension (n+1)×(n+1)</li>
<li>Recall that if m ≤ n, then $X^TX$ is non-invertible. However, when we add the term λ⋅L, then $X^TX + λ⋅L $becomes invertible.</li>
</ul>
</li>
</ul>
<h1 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h1><p>我在这里整理一下上述两个方法，补全课程上的相关推导。</p>
<h2 id="Logistic-Regression-Model-1"><a href="#Logistic-Regression-Model-1" class="headerlink" title="Logistic Regression Model"></a>Logistic Regression Model</h2><h3 id="h-theta-x-是假设函数"><a href="#h-theta-x-是假设函数" class="headerlink" title="$h_\theta(x)$是假设函数"></a>$h_\theta(x)$是假设函数</h3> $$h_\theta (x) = g ( \theta^T x ) = \dfrac{1}{1 + e^{- \theta^T x}} $$ 
<p>注意假设函数和真实数据之间的区别</p>
<h3 id="Cost-Function-1"><a href="#Cost-Function-1" class="headerlink" title="Cost Function"></a>Cost Function</h3> $$J(\theta) = - \frac{1}{m} \sum_{i=1}^m \large[ y^{(i)}\ \log (h_\theta (x^{(i)})) + (1 - y^{(i)})\ \log (1 - h_\theta(x^{(i)}))\large]$$ 
<p>回头看看上边的那个$h_\theta (x)$ ，cost function定义了训练集给出的结果 和 当前计算结果之间的差距。当然，该差距越小越好，那么需要求导一下。</p>
<h3 id="Gradient-Descent-1"><a href="#Gradient-Descent-1" class="headerlink" title="Gradient Descent"></a>Gradient Descent</h3><ul>
<li>原始公式 $$\theta_j := \theta_j - \alpha \dfrac{\partial}{\partial \theta_j}J(\theta)$$ </li>
<li>求导计算 $$\frac{\partial}{\partial \theta_j} J(\theta) = \frac{1}{m}\sum\limits_{i=1}^{m}[(h_\theta (x^{(i)}) - y^{(i)})x_j^{(i)}]$$ </li>
<li>计算结果 $$\theta_j := \theta_j - \frac{\alpha}{m} \sum_{i=1}^m (h_\theta(x^{(i)}) - y^{(i)}) x_j^{(i)} $$ 
</li>
</ul>
<p>这里推导一下$\frac{\partial}{\partial \theta_j} J(\theta)$：</p>
<ul>
<li><p>计算$h_\theta’(x)$导数</p>
 $$\begin{align*} &h_\theta'(x) = ( \frac1{1+e^{- \theta x}})'\newline &\ \ \ \ \ \ \ \  =   \frac{e^{- \theta x}x}{1+e^{- \theta x}}\newline &\ \ \ \ \ \ \ \  =   \frac{1+e^{- \theta x}-1}{(1+e^{- \theta x})^2}x\newline &\ \ \ \ \ \ \ \  =  \large[\frac{1}{1+e^{- \theta x}}-\frac{1}{(1+e^{- \theta x})^2}\large]x\newline &\ \ \ \ \ \ \ \  = h_\theta(x)(1-h_\theta(x))x  \end{align*}$$ 
</li>
<li><p>推导$\frac{\partial}{\partial \theta_j} J(\theta)$</p>
</li>
</ul>
 $$\begin{align*} &\frac{\partial}{\partial \theta_j} J(\theta) = \frac{\partial}{\partial \theta_j}   \frac{1}{m} \sum_{i=1}^m \large[ -y^{(i)}\ \log (h_\theta (x^{(i)})) - (1 - y^{(i)})\ \log (1 - h_\theta(x^{(i)}))\large] \newline &\ \ \ \ \ \ \ \ \ \ \ \ \ \  =   \frac{1}{m} \sum_{i=1}^m \large[ -y^{(i)}\ \frac1{h_\theta(x^{(i)})}h_\theta'(x^{(i)}) - (1 - y^{(i)}) \frac{-1}{1-h_\theta(x^{(i)})}h_\theta'(x^{(i)})\large] \newline &\ \ \ \ \ \ \ \ \ \ \ \ \ \  =   \frac{1}{m} \sum_{i=1}^m \large[ -y^{(i)}\ \frac1{h_\theta(x^{(i)})}h_\theta(x^{(i)})(1-h_\theta(x^{(i)}))x^{(i)}  \newline &\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ - (1 - y^{(i)}) \frac{-1}{1-h_\theta(x^{(i)})}h_\theta(x^{(i)})(1-h_\theta(x^{(i)}))x^{(i)}\large] \newline &\ \ \ \ \ \ \ \ \ \ \ \ \ \  =   \frac{1}{m} \sum_{i=1}^m \large[ -y^{(i)}(1-h_\theta(x^{(i)}) x^{(i)})+(1- y)h_\theta(x^{(i)}) x^{(i)})\large]  \newline &\ \ \ \ \ \ \ \ \ \ \ \ \ \  =   \frac{1}{m} \sum_{i=1}^m \large[ -x^{(i)}y^{(i)}+x^{(i)}y^{(i)}h_\theta(x^{(i)}) \newline &\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +x^{(i)}h_\theta(x^{(i)}) - x^{(i)}y^{(i)}h_\theta(x^{(i)}) \large] \newline &\ \ \ \ \ \ \ \ \ \ \ \ \ \  = \frac{1}{m}\sum\limits_{i=1}^{m}[(h_\theta (x^{(i)}) - y^{(i)})x_j^{(i)}] \end{align*}$$ 
<p>即：<br> $$\begin{align*} &\frac{\partial}{\partial \theta_j} J(\theta) = \frac{1}{m}\sum\limits_{i=1}^{m}[(h_\theta (x^{(i)}) - y^{(i)})x_j^{(i)}] \end{align*}$$ </p>
<h2 id="Solving-the-Problem-of-Overfitting-1"><a href="#Solving-the-Problem-of-Overfitting-1" class="headerlink" title="Solving the Problem of Overfitting"></a>Solving the Problem of Overfitting</h2><p>其他地方都一样，稍作修改</p>
<h3 id="Cost-Function-2"><a href="#Cost-Function-2" class="headerlink" title="Cost Function"></a>Cost Function</h3> $$J(\theta) = - \frac{1}{m} \sum_{i=1}^m \large[ y^{(i)}\ \log (h_\theta (x^{(i)})) + (1 - y^{(i)})\ \log (1 - h_\theta(x^{(i)}))\large] + \frac{\lambda}{2m}\sum_{j=1}^n \theta_j^2$$ 
<h3 id="Gradient-Descent-2"><a href="#Gradient-Descent-2" class="headerlink" title="Gradient Descent"></a>Gradient Descent</h3> $$\begin{align*} & \text{Repeat}\ \lbrace \newline & \ \ \ \ \theta_0 := \theta_0 - \alpha\ \frac{1}{m}\ \sum_{i=1}^m (h_\theta(x^{(i)}) - y^{(i)})x_0^{(i)} \newline & \ \ \ \ \theta_j := \theta_j - \alpha\ \left[ \left( \frac{1}{m}\ \sum_{i=1}^m (h_\theta(x^{(i)}) - y^{(i)})x_j^{(i)} \right) + \frac{\lambda}{m}\theta_j \right] &\ \ \ \ \ \ \ \ \ \ j \in \lbrace 1,2...n\rbrace\newline & \rbrace \end{align*}$$ 
<hr>
<p>以上</p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;本节笔记对应&lt;a href=&quot;https://www.coursera.org/learn/machine-learning/home/week/3&quot;&gt;第三周Coursera课程&lt;/a&gt;  &lt;strong&gt;binary classification problem&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
    
    </summary>
    
      <category term="Coursera ML" scheme="http://feiyang.li/categories/Coursera-ML/"/>
    
    
      <category term="Python" scheme="http://feiyang.li/tags/Python/"/>
    
      <category term="Machine Learning" scheme="http://feiyang.li/tags/Machine-Learning/"/>
    
      <category term="读书笔记" scheme="http://feiyang.li/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>Coursera ML(3)-Multivariate Linear Regression python实现</title>
    <link href="http://feiyang.li/2017/03/26/Coursera-ML-3-Multivariate-Linear-Regression-python/index.html"/>
    <id>http://feiyang.li/2017/03/26/Coursera-ML-3-Multivariate-Linear-Regression-python/index.html</id>
    <published>2017-03-26T11:00:29.000Z</published>
    <updated>2017-03-27T11:32:14.121Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><script src="/assets/js/DPlayer.min.js"> </script><blockquote>
<p>Multivariate Linear Regression and Programming Exercise 1</p>
</blockquote>
<hr>
<a id="more"></a>
<h1 id="Gradient-Descent-for-Multiple-Variables"><a href="#Gradient-Descent-for-Multiple-Variables" class="headerlink" title="Gradient Descent for Multiple Variables"></a>Gradient Descent for Multiple Variables</h1><ul>
<li>Suppose we have n variables, set hypothesis to be:</li>
</ul>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170325/192353908.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<ul>
<li><p>Cost Function</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170325/192415558.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
</li>
<li><p>Gradient Descent  Algorithm</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170325/192709947.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<p>Get every feature into approximately [-1, 1]. Just normalize all the parameters :)</p>
</li>
<li><p>Learning Rate:Not too big(fail to converge), not too small(too slow)</p>
</li>
<li>Polynormal Regression:Use feature scalling. (Somewhat like normalizing dimension)</li>
</ul>
<h1 id="Programming-Exercise-1"><a href="#Programming-Exercise-1" class="headerlink" title="Programming Exercise 1"></a>Programming Exercise 1</h1><h2 id="下载程序及相关数据"><a href="#下载程序及相关数据" class="headerlink" title="下载程序及相关数据"></a>下载程序及相关数据</h2><p>Stanford coursera Andrew Ng 机器学习课程编程作业（Exercise 1），作业下载链接貌似被墙了，下载链接放这。<br><a href="http://home.ustc.edu.cn/~mmmwhy/machine-learning-ex1.zip" target="_blank" rel="external">http://home.ustc.edu.cn/~mmmwhy/machine-learning-ex1.zip</a></p>
<h2 id="重新推导一下："><a href="#重新推导一下：" class="headerlink" title="重新推导一下："></a>重新推导一下：</h2><p>其实这里一共就两个式子：</p>
<ul>
<li><p>computeCost</p>
 
$$h_\theta (x) = \theta_0 + \theta_1 x_1 + \theta_2 x_2 + \theta_3 x_3 + \cdots + \theta_n x_n$$
$$J(\theta_0,\theta_1 )=\frac1{wm} \sum_{i=1}^{m}(h_{\theta}(x^{(i)})-y^{(i)})^w$$
 
</li>
<li><p>gradientDescent</p>
 
 $$\begin{align*} \text{repeat until convergence: } \lbrace & \newline \theta_0 := & \theta_0 - \alpha \frac{1}{m} \sum\limits_{i=1}^{m}(h_\theta(x_{i}) - y_{i}) \newline \theta_1 := & \theta_1 - \alpha \frac1m \sum\limits_{i=1}^m\left((h_\theta(x_i) - y_i) x_i\right) \newline \rbrace& \end{align*}$$
 
</li>
</ul>
<h2 id="python拟合实现代码"><a href="#python拟合实现代码" class="headerlink" title="python拟合实现代码"></a>python拟合实现代码</h2><p>原本用的是matlab代码，我用python实现了一下，结果是一样的：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</div><div class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">readfile</span><span class="params">(path)</span>:</span></div><div class="line">    X=[]</div><div class="line">    y=[]</div><div class="line">    <span class="keyword">with</span> open(path,<span class="string">'r'</span>) <span class="keyword">as</span> f:</div><div class="line">        <span class="keyword">for</span> line <span class="keyword">in</span> f:</div><div class="line">            X.append([<span class="number">1</span>,float(line.split(<span class="string">','</span>)[<span class="number">0</span>])])</div><div class="line">            y.append(float(line.split(<span class="string">','</span>)[<span class="number">1</span>]))</div><div class="line">    <span class="keyword">return</span> X,y</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">dataplot</span><span class="params">(x,theta,y)</span>:</span></div><div class="line">    plt.plot(x, y, <span class="string">'rx'</span>, markersize=<span class="number">10</span>)</div><div class="line">    plt.ylabel(<span class="string">'Profit in $10,000s'</span>)</div><div class="line">    plt.xlabel(<span class="string">'Population of City in 10,000s'</span>)</div><div class="line">    plt.plot(X[:,<span class="number">1</span>],X*theta,<span class="string">'-'</span>)</div><div class="line">    plt.show()</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">computeCost</span><span class="params">(X,y,theta)</span>:</span></div><div class="line">    m = len(y)</div><div class="line">    J = <span class="number">0</span></div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(m):</div><div class="line">        J = J + float((X[i]*theta-y[i])**<span class="number">2</span>)</div><div class="line">    <span class="keyword">return</span> J/(<span class="number">2</span>*m)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">gradientDescent</span><span class="params">(X, y, theta, alpha, num_iters)</span>:</span></div><div class="line">    m = len(y)</div><div class="line">    num_iters = <span class="number">1500</span></div><div class="line">    J_history = np.zeros(num_iters)</div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(num_iters):</div><div class="line">        S =X.T * (X * theta - np.mat(y).T) / m</div><div class="line">        theta = theta - alpha * S;</div><div class="line">        J_history[i] = computeCost(X,y,theta)</div><div class="line">    <span class="keyword">return</span> theta</div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__==<span class="string">"__main__"</span>:</div><div class="line">    theta = np.mat([[<span class="number">0</span>],[<span class="number">0</span>]])</div><div class="line">    iterations = <span class="number">1500</span></div><div class="line">    alpha = <span class="number">0.01</span></div><div class="line">    iterations = <span class="number">1500</span></div><div class="line">    path = <span class="string">"C:\Users\wing\Documents\MATLAB\ex1\ex1data1.txt"</span></div><div class="line">    </div><div class="line">    x,y = readfile(path)<span class="comment"># 小写的X不是矩阵，是list，大写的X是矩阵。</span></div><div class="line">    X = np.mat(x)</div><div class="line">    J = computeCost(X, y, theta)</div><div class="line">    theta = gradientDescent(X, y, theta, alpha, iterations)</div><div class="line">    dataplot(X[:,<span class="number">1</span>],theta,y)</div></pre></td></tr></table></figure>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://cdn.mmmxcc.cn/blog/20170326/171141428.png?imageView2/0/format/webp/interlace/1/q/75|watermark/2/text/ZmVpeWFuZy5saQ==/font/Y29taWMgc2FucyBtcw==/fontsize/500/fill/IzAzQTlGNA==/dissolve/35/gravity/SouthEast/dx/10/dy/10|imageslim
" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure> 
<p>输出的图有点小，就这样吧。</p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;Multivariate Linear Regression and Programming Exercise 1&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
    
    </summary>
    
      <category term="Coursera ML" scheme="http://feiyang.li/categories/Coursera-ML/"/>
    
    
      <category term="Python" scheme="http://feiyang.li/tags/Python/"/>
    
      <category term="Machine Learning" scheme="http://feiyang.li/tags/Machine-Learning/"/>
    
      <category term="读书笔记" scheme="http://feiyang.li/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
</feed>
